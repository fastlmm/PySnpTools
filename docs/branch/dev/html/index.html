
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <title>pysnptools Documentation &#8212; pysnptools 0.0.2 documentation</title>
    <link rel="stylesheet" href="_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="#">pysnptools 0.0.2 documentation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="pysnptools-documentation">
<h1><a class="reference internal" href="#module-pysnptools" title="pysnptools"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pysnptools</span></code></a> Documentation<a class="headerlink" href="#pysnptools-documentation" title="Permalink to this headline">¶</a></h1>
<p>PySnpTools: A library for reading and manipulating genetic data.</p>
<p>See <a class="reference external" href="https://github.com/fastlmm/PySnpTools/blob/master/README.md">PySnpTools’s README.md</a> for installation instructions, documentation, and code.</p>
<dl class="field-list simple">
<dt class="field-odd">Synopsis</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<ul>
<li><p><a class="reference internal" href="#module-pysnptools.snpreader" title="pysnptools.snpreader"><code class="xref py py-mod docutils literal notranslate"><span class="pre">snpreader</span></code></a>: Efficiently read genetic PLINK formats including *.bed/bim/fam and phenotype files. Also, efficiently read <em>parts</em> of files and standardize data.</p>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">new</dt>
<dd class="field-odd"><p><a class="reference internal" href="#pysnptools.snpreader.SnpGen" title="pysnptools.snpreader.SnpGen"><code class="xref py py-class docutils literal notranslate"><span class="pre">snpreader.SnpGen</span></code></a>: Generate synthetic SNP data on the fly.</p>
</dd>
<dt class="field-even">new</dt>
<dd class="field-even"><p><a class="reference internal" href="#pysnptools.snpreader.SnpMemMap" title="pysnptools.snpreader.SnpMemMap"><code class="xref py py-class docutils literal notranslate"><span class="pre">snpreader.SnpMemMap</span></code></a>: Support larger in-memory data via on-disk memory mapping.</p>
</dd>
<dt class="field-odd">new</dt>
<dd class="field-odd"><p><a class="reference internal" href="#pysnptools.snpreader.DistributedBed" title="pysnptools.snpreader.DistributedBed"><code class="xref py py-class docutils literal notranslate"><span class="pre">snpreader.DistributedBed</span></code></a>: Split <a class="reference internal" href="#pysnptools.snpreader.Bed" title="pysnptools.snpreader.Bed"><code class="xref py py-class docutils literal notranslate"><span class="pre">Bed</span></code></a>-like data into multiple files for more efficient cluster use.</p>
</dd>
</dl>
</div></blockquote>
</li>
<li><p><a class="reference internal" href="#module-pysnptools.kernelreader" title="pysnptools.kernelreader"><code class="xref py py-mod docutils literal notranslate"><span class="pre">kernelreader</span></code></a>: Efficiently create, read, and manipulate kernel data.</p></li>
<li><p><a class="reference internal" href="#module-pysnptools.standardizer" title="pysnptools.standardizer"><code class="xref py py-mod docutils literal notranslate"><span class="pre">standardizer</span></code></a>: Specify standardizers for <a class="reference internal" href="#module-pysnptools.snpreader" title="pysnptools.snpreader"><code class="xref py py-mod docutils literal notranslate"><span class="pre">snpreader</span></code></a>.</p></li>
<li><p><code class="xref py py-mod docutils literal notranslate"><span class="pre">kernelstandardizer</span></code>: Specify standardizers for <a class="reference internal" href="#module-pysnptools.kernelreader" title="pysnptools.kernelreader"><code class="xref py py-mod docutils literal notranslate"><span class="pre">kernelreader</span></code></a>.</p></li>
<li><p><a class="reference internal" href="#module-pysnptools.pstreader" title="pysnptools.pstreader"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pstreader</span></code></a>: Generalizes <a class="reference internal" href="#module-pysnptools.snpreader" title="pysnptools.snpreader"><code class="xref py py-mod docutils literal notranslate"><span class="pre">snpreader</span></code></a> and <a class="reference internal" href="#module-pysnptools.kernelreader" title="pysnptools.kernelreader"><code class="xref py py-mod docutils literal notranslate"><span class="pre">kernelreader</span></code></a> (provides the efficiency of numpy arrays with some of the flexibility of pandas)</p></li>
<li><p><a class="reference internal" href="#module-pysnptools.util" title="pysnptools.util"><code class="xref py py-mod docutils literal notranslate"><span class="pre">util</span></code></a>: In one line, intersect and re-order IIDs from <a class="reference internal" href="#module-pysnptools.snpreader" title="pysnptools.snpreader"><code class="xref py py-mod docutils literal notranslate"><span class="pre">snpreader</span></code></a>, <a class="reference internal" href="#module-pysnptools.kernelreader" title="pysnptools.kernelreader"><code class="xref py py-mod docutils literal notranslate"><span class="pre">kernelreader</span></code></a> and other sources. Also, efficiently extract a submatrix from an ndarray.</p></li>
<li><p><a class="reference internal" href="#pysnptools.util.IntRangeSet" title="pysnptools.util.IntRangeSet"><code class="xref py py-class docutils literal notranslate"><span class="pre">util.IntRangeSet</span></code></a>: Efficiently manipulate ranges of integers – for example, genetic position – with set operators including
union, intersection, and set difference.</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">new</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<ul class="simple">
<li><p><a class="reference internal" href="#module-pysnptools.util.mapreduce1" title="pysnptools.util.mapreduce1"><code class="xref py py-mod docutils literal notranslate"><span class="pre">util.mapreduce1</span></code></a>: Run loops in parallel on multiple processes, threads, or clusters.</p></li>
<li><p><a class="reference internal" href="#module-pysnptools.util.filecache" title="pysnptools.util.filecache"><code class="xref py py-mod docutils literal notranslate"><span class="pre">util.filecache</span></code></a>: Automatically copy files to and from any remote storage.</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Tutorial</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<ul class="simple">
<li><p><a class="reference external" href="https://www.biorxiv.org/search/PySnpTools">Short Overview Paper</a></p></li>
</ul>
<p><em>From PyData Conference, Seattle</em></p>
<ul class="simple">
<li><p><a class="reference external" href="https://1drv.ms/p/s!AkoPP4cC5J64jOc15JXgDsXmD9EEaw">Slides</a></p></li>
<li><p><a class="reference external" href="https://www.youtube.com/watch?v=KPI6479ctAQ">Video</a></p></li>
<li><p><a class="reference external" href="https://nbviewer.jupyter.org/github/fastlmm/PySnpTools/blob/master/doc/ipynb/tutorial.ipynb">IPython Notebook</a></p></li>
<li><p><a class="reference external" href="https://1drv.ms/u/s!AkoPP4cC5J64qrkHOEE77OWHJm1W4g?e=FHiLzf">Data file</a></p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Code</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<ul class="simple">
<li><p><a class="reference external" href="https://pypi.org/project/pysnptools/">PyPi</a></p></li>
<li><p><a class="reference external" href="https://github.com/fastlmm/PySnpTools">GitHub</a></p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Contacts</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<ul class="simple">
<li><p>Email the developers at <a class="reference external" href="mailto:fastlmm-dev&#37;&#52;&#48;python&#46;org">fastlmm-dev<span>&#64;</span>python<span>&#46;</span>org</a>.</p></li>
<li><p><a class="reference external" href="mailto:fastlmm-user-join&#37;&#52;&#48;python&#46;org?subject=Subscribe">Join</a> the user discussion
and announcements list (or use <a class="reference external" href="https://mail.python.org/mailman3/lists/fastlmm-user.python.org">web sign up</a>).</p></li>
<li><p><a class="reference external" href="https://github.com/fastlmm/PySnpTools/issues">Open an issue</a> on GitHub.</p></li>
<li><p><a class="reference external" href="https://fastlmm.github.io/">Project Home</a>.</p></li>
</ul>
<span class="target" id="module-pysnptools"></span><div class="section" id="module-pysnptools.snpreader">
<span id="snpreader-module"></span><h2><code class="xref py py-mod docutils literal notranslate"><span class="pre">snpreader</span></code> Module<a class="headerlink" href="#module-pysnptools.snpreader" title="Permalink to this headline">¶</a></h2>
<p>Tools for reading and manipulating SNP data.</p>
<div class="section" id="snpreader-snpreader">
<h3><code class="xref py py-class docutils literal notranslate"><span class="pre">snpreader.SnpReader</span></code><a class="headerlink" href="#snpreader-snpreader" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt id="pysnptools.snpreader.SnpReader">
<em class="property">class </em><code class="sig-prename descclassname">pysnptools.snpreader.</code><code class="sig-name descname">SnpReader</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.snpreader.SnpReader" title="Permalink to this definition">¶</a></dt>
<dd><p>A SnpReader is one of three things:</p>
<blockquote>
<div><ul>
<li><p>A class such as <a class="reference internal" href="#pysnptools.snpreader.Bed" title="pysnptools.snpreader.Bed"><code class="xref py py-class docutils literal notranslate"><span class="pre">Bed</span></code></a> for you to specify a file with data. For example,</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">print_function</span> <span class="c1">#Python 2 &amp; 3 compatibility</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.snpreader</span> <span class="k">import</span> <span class="n">Bed</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.util</span> <span class="k">import</span> <span class="n">example_file</span> <span class="c1"># Download and return local file name</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bedfile</span> <span class="o">=</span> <span class="n">example_file</span><span class="p">(</span><span class="s2">&quot;tests/datasets/all_chr.maf0.001.N300.*&quot;</span><span class="p">,</span><span class="s2">&quot;*.bed&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snp_on_disk</span> <span class="o">=</span> <span class="n">Bed</span><span class="p">(</span><span class="n">bedfile</span><span class="p">,</span><span class="n">count_A1</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">snp_on_disk</span><span class="p">)</span> <span class="c1"># prints the name of the file reader</span>
<span class="go">Bed(...tests/datasets/all_chr.maf0.001.N300.bed&#39;,count_A1=False)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snp_on_disk</span><span class="o">.</span><span class="n">sid_count</span> <span class="c1"># prints the number of SNPS (but doesn&#39;t read any SNP values)</span>
<span class="go">1015</span>
</pre></div>
</div>
</li>
<li><p>A <a class="reference internal" href="#pysnptools.snpreader.SnpData" title="pysnptools.snpreader.SnpData"><code class="xref py py-class docutils literal notranslate"><span class="pre">SnpData</span></code></a> class that holds SNP data in memory, typically after reading it from disk:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">snp_on_disk</span> <span class="o">=</span> <span class="n">Bed</span><span class="p">(</span><span class="n">bedfile</span><span class="p">,</span><span class="n">count_A1</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snpdata1</span> <span class="o">=</span> <span class="n">snp_on_disk</span><span class="o">.</span><span class="n">read</span><span class="p">()</span> <span class="c1">#reads the SNP values</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">type</span><span class="p">(</span><span class="n">snpdata1</span><span class="o">.</span><span class="n">val</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span> <span class="c1"># The val property is an ndarray of SNP values</span>
<span class="go">&#39;ndarray&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">snpdata1</span><span class="p">)</span> <span class="c1"># prints the name of the file reader</span>
<span class="go">SnpData(Bed(...tests/datasets/all_chr.maf0.001.N300.bed&#39;,count_A1=False))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snpdata1</span><span class="o">.</span><span class="n">iid_count</span> <span class="c1">#prints the number of iids (number of individuals) in this in-memory data</span>
<span class="go">300</span>
</pre></div>
</div>
</li>
<li><p>A subset of any SnpReader, specified with “[ <em>iid_index</em> , <em>sid_index</em> ]”, to read only some SNP values. It can
also be used to re-order the values.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">snp_on_disk</span> <span class="o">=</span> <span class="n">Bed</span><span class="p">(</span><span class="n">bedfile</span><span class="p">,</span><span class="n">count_A1</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">subset_on_disk</span> <span class="o">=</span> <span class="n">snp_on_disk</span><span class="p">[[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],::</span><span class="mi">2</span><span class="p">]</span> <span class="c1"># specification for a subset of the data on disk. No SNP values are read yet.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">subset_on_disk</span><span class="o">.</span><span class="n">sid_count</span><span class="p">)</span> <span class="c1"># prints the number of sids in this subset (but still doesn&#39;t read any SNP values)</span>
<span class="go">508</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">subset_on_disk</span><span class="p">)</span> <span class="c1">#prints a specification of &#39;subset_on_disk&#39;</span>
<span class="go">Bed(...tests/datasets/all_chr.maf0.001.N300.bed&#39;,count_A1=False)[[3,4],::2]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snpdata_subset</span> <span class="o">=</span> <span class="n">subset_on_disk</span><span class="o">.</span><span class="n">read</span><span class="p">()</span> <span class="c1"># efficiently reads the specified subset of values from the disk</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">snpdata_subset</span><span class="p">)</span> <span class="c1"># prints the name of the file reader</span>
<span class="go">SnpData(Bed(...tests/datasets/all_chr.maf0.001.N300.bed&#39;,count_A1=False)[[3,4],::2])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">((</span><span class="nb">int</span><span class="p">(</span><span class="n">snpdata_subset</span><span class="o">.</span><span class="n">val</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">snpdata_subset</span><span class="o">.</span><span class="n">val</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])))</span> <span class="c1"># The dimensions of the ndarray of SNP values</span>
<span class="go">(2, 508)</span>
</pre></div>
</div>
</li>
</ul>
<p>The SnpReaders Classes</p>
<blockquote>
<div><table class="docutils align-default">
<colgroup>
<col style="width: 24%" />
<col style="width: 18%" />
<col style="width: 21%" />
<col style="width: 17%" />
<col style="width: 21%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><em>Class</em></p></td>
<td><p><em>Format</em></p></td>
<td><p><em>Random Access</em></p></td>
<td><p><em>Suffixes</em></p></td>
<td><p><em>Write</em> method?</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pysnptools.snpreader.SnpData" title="pysnptools.snpreader.SnpData"><code class="xref py py-class docutils literal notranslate"><span class="pre">SnpData</span></code></a></p></td>
<td><p>in-memory floats</p></td>
<td><p>Yes</p></td>
<td><p><em>n/a</em></p></td>
<td><p><em>n/a</em></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pysnptools.snpreader.Bed" title="pysnptools.snpreader.Bed"><code class="xref py py-class docutils literal notranslate"><span class="pre">Bed</span></code></a></p></td>
<td><p>binary, 0,1,2</p></td>
<td><p>Yes (by sid)</p></td>
<td><p>.bed/.bim/.fam</p></td>
<td><p>Yes</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pysnptools.snpreader.Pheno" title="pysnptools.snpreader.Pheno"><code class="xref py py-class docutils literal notranslate"><span class="pre">Pheno</span></code></a></p></td>
<td><p>text, floats</p></td>
<td><p>No</p></td>
<td><p>.txt,.phe</p></td>
<td><p>Yes</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pysnptools.snpreader.Dat" title="pysnptools.snpreader.Dat"><code class="xref py py-class docutils literal notranslate"><span class="pre">Dat</span></code></a></p></td>
<td><p>text, floats</p></td>
<td><p>No</p></td>
<td><p>.dat/.map/.fam</p></td>
<td><p>Yes</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pysnptools.snpreader.Ped" title="pysnptools.snpreader.Ped"><code class="xref py py-class docutils literal notranslate"><span class="pre">Ped</span></code></a></p></td>
<td><p>text, 0,1,2</p></td>
<td><p>No</p></td>
<td><p>.ped/.map</p></td>
<td><p>Yes</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pysnptools.snpreader.Dense" title="pysnptools.snpreader.Dense"><code class="xref py py-class docutils literal notranslate"><span class="pre">Dense</span></code></a></p></td>
<td><p>text, 0,1,2</p></td>
<td><p>No</p></td>
<td><p>.dense.txt</p></td>
<td><p>Yes</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pysnptools.snpreader.SnpNpz" title="pysnptools.snpreader.SnpNpz"><code class="xref py py-class docutils literal notranslate"><span class="pre">SnpNpz</span></code></a></p></td>
<td><p>binary, floats</p></td>
<td><p>No</p></td>
<td><p>.snp.npz</p></td>
<td><p>Yes</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pysnptools.snpreader.SnpHdf5" title="pysnptools.snpreader.SnpHdf5"><code class="xref py py-class docutils literal notranslate"><span class="pre">SnpHdf5</span></code></a></p></td>
<td><p>binary, floats</p></td>
<td><p>Yes (by sid or iid)</p></td>
<td><p>.snp.hdf5</p></td>
<td><p>Yes</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pysnptools.snpreader.SnpMemMap" title="pysnptools.snpreader.SnpMemMap"><code class="xref py py-class docutils literal notranslate"><span class="pre">SnpMemMap</span></code></a></p></td>
<td><p>mem-mapped floats</p></td>
<td><p>Yes</p></td>
<td><p>.snp.memmap</p></td>
<td><p>Yes</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pysnptools.snpreader.SnpGen" title="pysnptools.snpreader.SnpGen"><code class="xref py py-class docutils literal notranslate"><span class="pre">SnpGen</span></code></a></p></td>
<td><p>generated values</p></td>
<td><p>Yes (by sid)</p></td>
<td><p><em>n/a</em></p></td>
<td><p><em>n/a</em></p></td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>Methods &amp; Properties:</p>
<blockquote>
<div><p>Every SnpReader, such as <a class="reference internal" href="#pysnptools.snpreader.Bed" title="pysnptools.snpreader.Bed"><code class="xref py py-class docutils literal notranslate"><span class="pre">Bed</span></code></a> and <a class="reference internal" href="#pysnptools.snpreader.SnpData" title="pysnptools.snpreader.SnpData"><code class="xref py py-class docutils literal notranslate"><span class="pre">SnpData</span></code></a>, has these properties: <a class="reference internal" href="#pysnptools.snpreader.SnpReader.iid" title="pysnptools.snpreader.SnpReader.iid"><code class="xref py py-attr docutils literal notranslate"><span class="pre">iid</span></code></a>, <a class="reference internal" href="#pysnptools.snpreader.SnpReader.iid_count" title="pysnptools.snpreader.SnpReader.iid_count"><code class="xref py py-attr docutils literal notranslate"><span class="pre">iid_count</span></code></a>, <a class="reference internal" href="#pysnptools.snpreader.SnpReader.sid" title="pysnptools.snpreader.SnpReader.sid"><code class="xref py py-attr docutils literal notranslate"><span class="pre">sid</span></code></a>, <a class="reference internal" href="#pysnptools.snpreader.SnpReader.sid_count" title="pysnptools.snpreader.SnpReader.sid_count"><code class="xref py py-attr docutils literal notranslate"><span class="pre">sid_count</span></code></a>,
<a class="reference internal" href="#pysnptools.snpreader.SnpReader.pos" title="pysnptools.snpreader.SnpReader.pos"><code class="xref py py-attr docutils literal notranslate"><span class="pre">pos</span></code></a> and these methods: <a class="reference internal" href="#pysnptools.snpreader.SnpReader.read" title="pysnptools.snpreader.SnpReader.read"><code class="xref py py-meth docutils literal notranslate"><span class="pre">read()</span></code></a>, <a class="reference internal" href="#pysnptools.snpreader.SnpReader.iid_to_index" title="pysnptools.snpreader.SnpReader.iid_to_index"><code class="xref py py-meth docutils literal notranslate"><span class="pre">iid_to_index()</span></code></a>, <a class="reference internal" href="#pysnptools.snpreader.SnpReader.sid_to_index" title="pysnptools.snpreader.SnpReader.sid_to_index"><code class="xref py py-meth docutils literal notranslate"><span class="pre">sid_to_index()</span></code></a>, <a class="reference internal" href="#pysnptools.snpreader.SnpReader.read_kernel" title="pysnptools.snpreader.SnpReader.read_kernel"><code class="xref py py-meth docutils literal notranslate"><span class="pre">read_kernel()</span></code></a>. See below for details.</p>
<p><a class="reference internal" href="#pysnptools.snpreader.SnpData" title="pysnptools.snpreader.SnpData"><code class="xref py py-class docutils literal notranslate"><span class="pre">SnpData</span></code></a> is a SnpReader so it supports the above properties and methods. In addition, it supports property <a class="reference internal" href="#pysnptools.snpreader.SnpData.val" title="pysnptools.snpreader.SnpData.val"><code class="xref py py-attr docutils literal notranslate"><span class="pre">SnpData.val</span></code></a>, method <a class="reference internal" href="#pysnptools.snpreader.SnpData.standardize" title="pysnptools.snpreader.SnpData.standardize"><code class="xref py py-meth docutils literal notranslate"><span class="pre">SnpData.standardize()</span></code></a>, and equality testing.
See below for details.</p>
<p>Many of the classes, such as <a class="reference internal" href="#pysnptools.snpreader.Bed" title="pysnptools.snpreader.Bed"><code class="xref py py-class docutils literal notranslate"><span class="pre">Bed</span></code></a>, also provide a static <a class="reference internal" href="#pysnptools.snpreader.Bed.write" title="pysnptools.snpreader.Bed.write"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Bed.write()</span></code></a> method for writing <a class="reference internal" href="#pysnptools.snpreader.SnpData" title="pysnptools.snpreader.SnpData"><code class="xref py py-class docutils literal notranslate"><span class="pre">SnpData</span></code></a> to disk.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># read from Pheno, write to Bed</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.snpreader</span> <span class="k">import</span> <span class="n">Pheno</span><span class="p">,</span> <span class="n">Bed</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pysnptools.util</span> <span class="k">as</span> <span class="nn">pstutil</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">snpdata</span> <span class="o">=</span> <span class="n">Pheno</span><span class="p">(</span><span class="s1">&#39;../examples/toydata.phe&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span> <span class="c1"># Read data from Pheno format</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pstutil</span><span class="o">.</span><span class="n">create_directory_if_necessary</span><span class="p">(</span><span class="s2">&quot;tempdir/toydata.bed&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Bed</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;tempdir/toydata.bed&quot;</span><span class="p">,</span><span class="n">snpdata</span><span class="p">,</span><span class="n">count_A1</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>   <span class="c1"># Write data in Bed format</span>
<span class="go">Bed(&#39;tempdir/toydata.bed&#39;,count_A1=False)</span>
</pre></div>
</div>
</div></blockquote>
<p>iids and sids:</p>
<blockquote>
<div><p>Individuals are identified with an iid, which is a ndarray of two strings: a family ID and a individual ID.
SNP locations are identified with an sid string in a ndarray. For example:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">snp_on_disk</span> <span class="o">=</span> <span class="n">Bed</span><span class="p">(</span><span class="n">bedfile</span><span class="p">,</span><span class="n">count_A1</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">snp_on_disk</span><span class="o">.</span><span class="n">iid</span><span class="p">[:</span><span class="mi">3</span><span class="p">])</span> <span class="c1"># print the first three iids</span>
<span class="go">[[&#39;POP1&#39; &#39;0&#39;]</span>
<span class="go"> [&#39;POP1&#39; &#39;12&#39;]</span>
<span class="go"> [&#39;POP1&#39; &#39;44&#39;]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">snp_on_disk</span><span class="o">.</span><span class="n">sid</span><span class="p">[:</span><span class="mi">9</span><span class="p">])</span> <span class="c1"># print the first nine sids</span>
<span class="go">[&#39;1_12&#39; &#39;1_34&#39; &#39;1_10&#39; &#39;1_35&#39; &#39;1_28&#39; &#39;1_25&#39; &#39;1_36&#39; &#39;1_39&#39; &#39;1_4&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">snp_on_disk</span><span class="o">.</span><span class="n">iid_to_index</span><span class="p">([[</span><span class="s1">&#39;POP1&#39;</span><span class="p">,</span><span class="s1">&#39;44&#39;</span><span class="p">],[</span><span class="s1">&#39;POP1&#39;</span><span class="p">,</span><span class="s1">&#39;12&#39;</span><span class="p">]]))</span> <span class="c1">#Find the indexes for two iids.</span>
<span class="go">[2 1]</span>
</pre></div>
</div>
</div></blockquote>
<p>Selecting and Reordering Individuals and SNPs</p>
<blockquote>
<div><p>You often don’t want to read the SNP values for all iids and sids. You can use indexing to create a subsetting SnpReader that
will read only the SNP values of interest.</p>
<p>SnpReaders support the indexing formats supported by ndarray plus two generalizations. Here are examples of indexing with an array
of indexes, with slicing, and with an array of Booleans.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">snp_on_disk</span> <span class="o">=</span> <span class="n">Bed</span><span class="p">(</span><span class="n">bedfile</span><span class="p">,</span><span class="n">count_A1</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="c1"># Specify some data on disk in Bed format</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">subset_snpreader_1</span> <span class="o">=</span> <span class="n">snp_on_disk</span><span class="p">[[</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">],:]</span> <span class="c1">#index with an array of indexes. Negatives count from end.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">((</span><span class="n">subset_snpreader_1</span><span class="o">.</span><span class="n">iid_count</span><span class="p">,</span> <span class="n">subset_snpreader_1</span><span class="o">.</span><span class="n">sid_count</span><span class="p">))</span>
<span class="go">(2, 1015)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snpdata1</span> <span class="o">=</span> <span class="n">subset_snpreader_1</span><span class="o">.</span><span class="n">read</span><span class="p">()</span> <span class="c1"># read just the two rows of interest from the disk</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">subset_snpreader_2</span> <span class="o">=</span> <span class="n">snp_on_disk</span><span class="p">[:,:</span><span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="c1">#index with a slice</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">((</span><span class="n">subset_snpreader_2</span><span class="o">.</span><span class="n">iid_count</span><span class="p">,</span> <span class="n">subset_snpreader_2</span><span class="o">.</span><span class="n">sid_count</span><span class="p">))</span>
<span class="go">(300, 507)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">boolindexes</span> <span class="o">=</span> <span class="p">[</span><span class="n">s</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;23_&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">snp_on_disk</span><span class="o">.</span><span class="n">sid</span><span class="p">]</span> <span class="c1"># create a Boolean index of sids that start &#39;23_&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">subset_snpreader_3</span> <span class="o">=</span> <span class="n">snp_on_disk</span><span class="p">[:,</span><span class="n">boolindexes</span><span class="p">]</span> <span class="c1">#index with array of Booleans</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">((</span><span class="n">subset_snpreader_3</span><span class="o">.</span><span class="n">iid_count</span><span class="p">,</span> <span class="n">subset_snpreader_3</span><span class="o">.</span><span class="n">sid_count</span><span class="p">))</span>
<span class="go">(300, 24)</span>
</pre></div>
</div>
<p>The first generalization over what ndarray offers is full indexing on both the iid dimension and the sid dimension, in other words,
full multidimensional indexing. For example,</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">snp_on_disk</span> <span class="o">=</span> <span class="n">Bed</span><span class="p">(</span><span class="n">bedfile</span><span class="p">,</span><span class="n">count_A1</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="c1"># Specify some data on disk in Bed format</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">subset_snpreader_4</span> <span class="o">=</span> <span class="n">snp_on_disk</span><span class="p">[[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],:</span><span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="c1"># index on two dimensions at once</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">((</span><span class="n">subset_snpreader_4</span><span class="o">.</span><span class="n">iid_count</span><span class="p">,</span> <span class="n">subset_snpreader_4</span><span class="o">.</span><span class="n">sid_count</span><span class="p">))</span>
<span class="go">(2, 507)</span>
</pre></div>
</div>
<p>The second generalization is indexing on a single integer index.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">snp_on_disk</span> <span class="o">=</span> <span class="n">Bed</span><span class="p">(</span><span class="n">bedfile</span><span class="p">,</span><span class="n">count_A1</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="c1"># Specify some data on disk in Bed format</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">subset_snpreader_5</span> <span class="o">=</span> <span class="n">snp_on_disk</span><span class="p">[</span><span class="mi">5</span><span class="p">,:]</span> <span class="c1">#index with single integer</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">((</span><span class="n">subset_snpreader_5</span><span class="o">.</span><span class="n">iid_count</span><span class="p">,</span> <span class="n">subset_snpreader_5</span><span class="o">.</span><span class="n">sid_count</span><span class="p">))</span>
<span class="go">(1, 1015)</span>
</pre></div>
</div>
<p>Indexing is also useful when you have SNP values in memory via a <a class="reference internal" href="#pysnptools.snpreader.SnpData" title="pysnptools.snpreader.SnpData"><code class="xref py py-class docutils literal notranslate"><span class="pre">SnpData</span></code></a> index and want to copy a subset of those values.
While you could instead index directly on the <a class="reference internal" href="#pysnptools.snpreader.SnpData.val" title="pysnptools.snpreader.SnpData.val"><code class="xref py py-attr docutils literal notranslate"><span class="pre">SnpData.val</span></code></a> ndarray, by indexing on the <a class="reference internal" href="#pysnptools.snpreader.SnpData" title="pysnptools.snpreader.SnpData"><code class="xref py py-class docutils literal notranslate"><span class="pre">SnpData</span></code></a> instance you
also get iid and cid information.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">snp_on_disk</span> <span class="o">=</span> <span class="n">Bed</span><span class="p">(</span><span class="n">bedfile</span><span class="p">,</span><span class="n">count_A1</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="c1"># Specify some data on disk in Bed format</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snpdata1</span> <span class="o">=</span> <span class="n">snp_on_disk</span><span class="o">.</span><span class="n">read</span><span class="p">()</span> <span class="c1"># read all SNP values into memory</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">snpdata1</span><span class="o">.</span><span class="n">sid</span><span class="p">[:</span><span class="mi">9</span><span class="p">])</span> <span class="c1"># print the first 9 sids</span>
<span class="go">[&#39;1_12&#39; &#39;1_34&#39; &#39;1_10&#39; &#39;1_35&#39; &#39;1_28&#39; &#39;1_25&#39; &#39;1_36&#39; &#39;1_39&#39; &#39;1_4&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snpdata_subset</span> <span class="o">=</span> <span class="n">snpdata1</span><span class="p">[:,::</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">view_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">order</span><span class="o">=</span><span class="s1">&#39;A&#39;</span><span class="p">)</span> <span class="c1"># create a copy or view with every other sid</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">snpdata_subset</span><span class="o">.</span><span class="n">sid</span><span class="p">[:</span><span class="mi">9</span><span class="p">])</span><span class="c1"># print the first 9 sids in the subset</span>
<span class="go">[&#39;1_12&#39; &#39;1_10&#39; &#39;1_28&#39; &#39;1_36&#39; &#39;1_4&#39; &#39;1_11&#39; &#39;1_32&#39; &#39;1_9&#39; &#39;1_17&#39;]</span>
</pre></div>
</div>
<p>You can apply indexing on top of indexing to specify subsets of subsets of data to read. In this example, 
only the SNP values for every 16th sid is actually read from the disk.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># These are just SnpReaders, nothing is read from disk yet</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snp_on_disk</span> <span class="o">=</span> <span class="n">Bed</span><span class="p">(</span><span class="n">bedfile</span><span class="p">,</span><span class="n">count_A1</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="c1"># Specify some data on disk in Bed format</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">half_snpreader</span> <span class="o">=</span> <span class="n">snp_on_disk</span><span class="p">[:,::</span><span class="mi">2</span><span class="p">]</span> <span class="c1"># a reader for half the sids</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">quarter_snpreader</span> <span class="o">=</span> <span class="n">half_snpreader</span><span class="p">[:,::</span><span class="mi">2</span><span class="p">]</span> <span class="c1"># a reader for half of half the sids</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sixteenth_snpreader</span> <span class="o">=</span> <span class="n">quarter_snpreader</span><span class="p">[:,::</span><span class="mi">2</span><span class="p">][:,::</span><span class="mi">2</span><span class="p">]</span> <span class="c1"># a reader for half of half of half of half the sids</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">sixteenth_snpreader</span><span class="p">)</span> <span class="c1">#Print the specification of this reader</span>
<span class="go">Bed(...tests/datasets/all_chr.maf0.001.N300.bed&#39;,count_A1=False)[:,::2][:,::2][:,::2][:,::2]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Now we read from disk. Only values for one sid in every 16 will be read.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snpdata_sixteenth</span> <span class="o">=</span> <span class="n">sixteenth_snpreader</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">snpdata_sixteenth</span><span class="o">.</span><span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="go">2.0</span>
</pre></div>
</div>
</div></blockquote>
<p>When Data is Read:</p>
<blockquote>
<div><p>SNP data can be enormous so we generally avoid reading it to the degree practical. Specifically,</p>
<ul>
<li><p>Constructing and printing a SnpReader causes no file reading. For example, these commands read no data:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">snp_on_disk</span> <span class="o">=</span> <span class="n">Bed</span><span class="p">(</span><span class="n">bedfile</span><span class="p">,</span><span class="n">count_A1</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="c1"># Construct a Bed SnpReader. No data is read.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">snp_on_disk</span><span class="p">)</span> <span class="c1"># Print the Bed SnpReader specification. No data is read.</span>
<span class="go">Bed(...tests/datasets/all_chr.maf0.001.N300.bed&#39;,count_A1=False)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">subset_on_disk</span> <span class="o">=</span> <span class="n">snp_on_disk</span><span class="p">[[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],::</span><span class="mi">2</span><span class="p">]</span> <span class="c1"># Construct a subsetting SnpReader. No data is read.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">subset_on_disk</span><span class="p">)</span> <span class="c1"># print the subset SnpReader. No data is read.</span>
<span class="go">Bed(...tests/datasets/all_chr.maf0.001.N300.bed&#39;,count_A1=False)[[3,4],::2]</span>
</pre></div>
</div>
</li>
<li><p>Properties and methods related to the iids and sids (to the degree practical) read just some iid and sid data from the disk,
not SNP value data. Moreover, the iid and sid data is read from file only once. Consider these commands:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">snp_on_disk</span> <span class="o">=</span> <span class="n">Bed</span><span class="p">(</span><span class="n">bedfile</span><span class="p">,</span><span class="n">count_A1</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="c1"># Construct a Bed SnpReader. No data is read.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">snp_on_disk</span><span class="o">.</span><span class="n">sid</span><span class="p">[:</span><span class="mi">9</span><span class="p">])</span> <span class="c1"># without reading any SNP values data from disk, read the sid and iid data from disk, cache it, and then print the first nine sids.</span>
<span class="go">[&#39;1_12&#39; &#39;1_34&#39; &#39;1_10&#39; &#39;1_35&#39; &#39;1_28&#39; &#39;1_25&#39; &#39;1_36&#39; &#39;1_39&#39; &#39;1_4&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">snp_on_disk</span><span class="o">.</span><span class="n">sid_to_index</span><span class="p">([</span><span class="s1">&#39;1_10&#39;</span><span class="p">,</span><span class="s1">&#39;1_13&#39;</span><span class="p">]))</span> <span class="c1">#use the cached sid information to find the indexes of &#39;1_10&#39; and &#39;1_13&#39;. (No data is read from disk.)</span>
<span class="go">[2 9]</span>
</pre></div>
</div>
</li>
<li><p>The only methods that read SNP values from file are <a class="reference internal" href="#pysnptools.snpreader.SnpReader.read" title="pysnptools.snpreader.SnpReader.read"><code class="xref py py-meth docutils literal notranslate"><span class="pre">read()</span></code></a> and <a class="reference internal" href="#pysnptools.snpreader.SnpReader.read_kernel" title="pysnptools.snpreader.SnpReader.read_kernel"><code class="xref py py-meth docutils literal notranslate"><span class="pre">read_kernel()</span></code></a> (to the degree practical). For example:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">snp_on_disk</span> <span class="o">=</span> <span class="n">Bed</span><span class="p">(</span><span class="n">bedfile</span><span class="p">,</span><span class="n">count_A1</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="c1"># Construct a Bed SnpReader. No data is read.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snpdata1</span> <span class="o">=</span> <span class="n">snp_on_disk</span><span class="o">.</span><span class="n">read</span><span class="p">()</span> <span class="c1">#read all the SNP values from disk, creating a new SnpData instance that keeps these values in memory</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">snpdata1</span><span class="o">.</span><span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span><span class="c1"># print the SNP value for the iid with index 0 and the sid with index 2. (No data is read from disk.)</span>
<span class="go">1.0</span>
</pre></div>
</div>
</li>
<li><p>If you request the values for only a subset of the iids or sids, (to the degree practical) only that subset will be read from disk.
for example:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">subset_on_disk</span> <span class="o">=</span> <span class="n">Bed</span><span class="p">(</span><span class="n">bedfile</span><span class="p">,</span><span class="n">count_A1</span><span class="o">=</span><span class="kc">False</span><span class="p">)[[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],::</span><span class="mi">2</span><span class="p">]</span> <span class="c1"># Construct a subsetting SnpReader. No data is read.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snpdata_subset</span> <span class="o">=</span> <span class="n">subset_on_disk</span><span class="o">.</span><span class="n">read</span><span class="p">()</span> <span class="c1"># from disk, read the SNP values for the iids with index 3 and 4 AND sids with even numbered indexes.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">snpdata_subset</span><span class="o">.</span><span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span> <span class="c1"># print the SNP value with subset iid index 0 and sid index 2 (corresponding to iid index 3 and sid index 4 in the full data). No data is read from disk.</span>
<span class="go">2.0</span>
</pre></div>
</div>
</li>
</ul>
</div></blockquote>
<p>When Data is Re-Read and Copied:</p>
<blockquote>
<div><p>Every time you call a SnpReader’s <a class="reference internal" href="#pysnptools.snpreader.SnpReader.read" title="pysnptools.snpreader.SnpReader.read"><code class="xref py py-meth docutils literal notranslate"><span class="pre">read()</span></code></a> method, the SnpReader re-reads the SNP value data and returns a new in-memory <a class="reference internal" href="#pysnptools.snpreader.SnpData" title="pysnptools.snpreader.SnpData"><code class="xref py py-class docutils literal notranslate"><span class="pre">SnpData</span></code></a>
(with <a class="reference internal" href="#pysnptools.snpreader.SnpData.val" title="pysnptools.snpreader.SnpData.val"><code class="xref py py-attr docutils literal notranslate"><span class="pre">SnpData.val</span></code></a> property containing a new ndarray of the SNP values). Likewise, when you call the <a class="reference internal" href="#pysnptools.snpreader.SnpReader.kernel" title="pysnptools.snpreader.SnpReader.kernel"><code class="xref py py-meth docutils literal notranslate"><span class="pre">kernel()</span></code></a> method, the SnpReader re-reads
the data and returns a new kernel ndarray.</p>
<p>Here is an example of what not to do, because it causes all the SNP value data to be read twice.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">snp_on_disk</span> <span class="o">=</span> <span class="n">Bed</span><span class="p">(</span><span class="n">bedfile</span><span class="p">,</span><span class="n">count_A1</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="c1"># Construct a Bed SnpReader. No data is read.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># The following is not recommended because it inefficiently reads all the SNP values twice.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">snp_on_disk</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span> <span class="c1"># read all values into a new SnpData, print a SNP value</span>
<span class="go">1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">snp_on_disk</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span> <span class="c1"># read all values (again) into a second new SnpData, print a SNP value</span>
<span class="go">2.0</span>
</pre></div>
</div>
<p>Here are two efficient alternatives. First, if all SNP values can all fit in memory, read them once into a <a class="reference internal" href="#pysnptools.snpreader.SnpData" title="pysnptools.snpreader.SnpData"><code class="xref py py-class docutils literal notranslate"><span class="pre">SnpData</span></code></a> and then
access that <a class="reference internal" href="#pysnptools.snpreader.SnpData" title="pysnptools.snpreader.SnpData"><code class="xref py py-class docutils literal notranslate"><span class="pre">SnpData</span></code></a> multiple times.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">snp_on_disk</span> <span class="o">=</span> <span class="n">Bed</span><span class="p">(</span><span class="n">bedfile</span><span class="p">,</span><span class="n">count_A1</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="c1"># Construct a Bed SnpReader. No data is read.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snpdata1</span> <span class="o">=</span> <span class="n">snp_on_disk</span><span class="o">.</span><span class="n">read</span><span class="p">()</span> <span class="c1"># read all values into a new SnpData</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">snpdata1</span><span class="o">.</span><span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span> <span class="c1"># print a SNP value from snpdata1&#39;s in-memory ndarray</span>
<span class="go">1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">snpdata1</span><span class="o">.</span><span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span> <span class="c1"># print another SNP value from snpdata1&#39;s in-memory ndarray.</span>
<span class="go">2.0</span>
</pre></div>
</div>
<p>Second, if the SNP value data is too large to fit in memory, use subsetting to read only the SNP values of interest from disk.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">snp_on_disk</span> <span class="o">=</span> <span class="n">Bed</span><span class="p">(</span><span class="n">bedfile</span><span class="p">,</span><span class="n">count_A1</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="c1"># Construct a Bed SnpReader. No data is read.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">snp_on_disk</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span> <span class="c1">#Define the subset of data and read only that subset from disk.</span>
<span class="go">1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">snp_on_disk</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span> <span class="c1">#Define a second subset of data and read only that subset from disk.</span>
<span class="go">2.0</span>
</pre></div>
</div>
<p>Because the in-memory <a class="reference internal" href="#pysnptools.snpreader.SnpData" title="pysnptools.snpreader.SnpData"><code class="xref py py-class docutils literal notranslate"><span class="pre">SnpData</span></code></a> class is a kind of SnpReader, you may read from it, too.
Doing so create a new <a class="reference internal" href="#pysnptools.snpreader.SnpData" title="pysnptools.snpreader.SnpData"><code class="xref py py-class docutils literal notranslate"><span class="pre">SnpData</span></code></a> instance containing a copy of the SNP values in a new ndarray.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">snp_on_disk</span> <span class="o">=</span> <span class="n">Bed</span><span class="p">(</span><span class="n">bedfile</span><span class="p">,</span><span class="n">count_A1</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="c1"># Construct a Bed SnpReader. No data is read.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snpdata1</span> <span class="o">=</span> <span class="n">snp_on_disk</span><span class="o">.</span><span class="n">read</span><span class="p">()</span> <span class="c1"># read all SNP values from disk into a new SnpData</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">snpdata1</span><span class="o">.</span><span class="n">val</span> <span class="ow">is</span> <span class="n">snpdata1</span><span class="o">.</span><span class="n">val</span><span class="p">)</span> <span class="c1"># Do the in-memory SNP values use the same memory as themselves? Yes</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snpdata2</span> <span class="o">=</span> <span class="n">snpdata1</span><span class="o">.</span><span class="n">read</span><span class="p">()</span> <span class="c1"># copy all the SNP values into a new ndarray in a new SnpData</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">snpdata2</span><span class="o">.</span><span class="n">val</span> <span class="ow">is</span> <span class="n">snpdata1</span><span class="o">.</span><span class="n">val</span><span class="p">)</span> <span class="c1"># Do the two ndarrays of in-memory SNP values use the same memory?</span>
<span class="go">False</span>
</pre></div>
</div>
</div></blockquote>
<p>Avoiding Unwanted ndarray Allocations</p>
<blockquote>
<div><p>You may want a subset of SNPs values from an in-memory <a class="reference internal" href="#pysnptools.snpreader.SnpData" title="pysnptools.snpreader.SnpData"><code class="xref py py-class docutils literal notranslate"><span class="pre">SnpData</span></code></a> and you may know that this subset and the original <a class="reference internal" href="#pysnptools.snpreader.SnpData" title="pysnptools.snpreader.SnpData"><code class="xref py py-class docutils literal notranslate"><span class="pre">SnpData</span></code></a>
can safely share the memory of the ndarray of SNP values. For this case, the <a class="reference internal" href="#pysnptools.snpreader.SnpReader.read" title="pysnptools.snpreader.SnpReader.read"><code class="xref py py-meth docutils literal notranslate"><span class="pre">read()</span></code></a> has optional parameters called view_ok and order. If you override 
the defaults of “view_ok=False,order=’F’” with “view_ok=True,order=’A’, the <a class="reference internal" href="#pysnptools.snpreader.SnpReader.read" title="pysnptools.snpreader.SnpReader.read"><code class="xref py py-meth docutils literal notranslate"><span class="pre">read()</span></code></a> will, if practical, return a new 
<a class="reference internal" href="#pysnptools.snpreader.SnpData" title="pysnptools.snpreader.SnpData"><code class="xref py py-class docutils literal notranslate"><span class="pre">SnpData</span></code></a> with a ndarray shares memory with the original ndarray.
Use these parameters with care because any change to either ndarray (for example, via <a class="reference internal" href="#pysnptools.snpreader.SnpData.standardize" title="pysnptools.snpreader.SnpData.standardize"><code class="xref py py-meth docutils literal notranslate"><span class="pre">SnpData.standardize()</span></code></a>) will effect
the others. Also keep in mind that <a class="reference internal" href="#pysnptools.snpreader.SnpReader.read" title="pysnptools.snpreader.SnpReader.read"><code class="xref py py-meth docutils literal notranslate"><span class="pre">read()</span></code></a> relies on ndarray’s mechanisms to decide whether to actually
share memory and so it may ignore your suggestion and allocate a new ndarray anyway.</p>
</div></blockquote>
</div></blockquote>
<dl>
<dt>snp_on_disk = Bed(bedfile,count_A1=False) # Construct a Bed SnpReader. No data is read.</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">snpdata1</span> <span class="o">=</span> <span class="n">snp_on_disk</span><span class="o">.</span><span class="n">read</span><span class="p">()</span> <span class="c1"># read all data from disk into a SnpData with a new ndarray</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">column01</span> <span class="o">=</span> <span class="n">snpdata1</span><span class="p">[:,</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">view_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">order</span><span class="o">=</span><span class="s1">&#39;A&#39;</span><span class="p">)</span> <span class="c1">#create SnpData with the data from just the first two SNPs. Sharing memory is OK. The memory may be laid out in any order (that is sid-major and iid-major are both OK).</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#print np.may_share_memory(snpdata1.val, column01.val) # Do the two ndarray&#39;s share memory? They could (but currently they won&#39;t)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">column201</span> <span class="o">=</span> <span class="n">snpdata1</span><span class="p">[:,[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">view_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">order</span><span class="o">=</span><span class="s1">&#39;A&#39;</span><span class="p">)</span> <span class="c1">#create SnpData with the data from three SNPs, permuted. Sharing memory is OK.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">may_share_memory</span><span class="p">(</span><span class="n">snpdata1</span><span class="o">.</span><span class="n">val</span><span class="p">,</span> <span class="n">column201</span><span class="o">.</span><span class="n">val</span><span class="p">))</span> <span class="c1"># Do the two ndarray&#39;s share memory? No, ndarray decided that this indexing was too complex for sharing.</span>
<span class="go">False</span>
</pre></div>
</div>
<p>The <a class="reference internal" href="#pysnptools.snpreader.SnpReader.read" title="pysnptools.snpreader.SnpReader.read"><code class="xref py py-meth docutils literal notranslate"><span class="pre">read()</span></code></a> Method</p>
<blockquote>
<div><p>By default the <a class="reference internal" href="#pysnptools.snpreader.SnpReader.read" title="pysnptools.snpreader.SnpReader.read"><code class="xref py py-meth docutils literal notranslate"><span class="pre">read()</span></code></a> returns a ndarray of numpy.float64 laid out in memory in F-contiguous order (iid-index varies the fastest). You may, instead,
ask for numpy.float32 or for C-contiguous order or any order. See <a class="reference internal" href="#pysnptools.snpreader.SnpReader.read" title="pysnptools.snpreader.SnpReader.read"><code class="xref py py-meth docutils literal notranslate"><span class="pre">read()</span></code></a> for details.</p>
</div></blockquote>
<dl>
<dt>The <a class="reference internal" href="#pysnptools.snpreader.SnpData.standardize" title="pysnptools.snpreader.SnpData.standardize"><code class="xref py py-meth docutils literal notranslate"><span class="pre">SnpData.standardize()</span></code></a> Method</dt><dd><p>The <a class="reference internal" href="#pysnptools.snpreader.SnpData.standardize" title="pysnptools.snpreader.SnpData.standardize"><code class="xref py py-meth docutils literal notranslate"><span class="pre">SnpData.standardize()</span></code></a> method, available only on <a class="reference internal" href="#pysnptools.snpreader.SnpData" title="pysnptools.snpreader.SnpData"><code class="xref py py-class docutils literal notranslate"><span class="pre">SnpData</span></code></a>, does in-place standardization of the in-memory
SNP data. By default, it applies ‘Unit’ standardization, that is: the values for each SNP will have mean zero and standard deviation 1.0.
NaN values are then filled with zeros (consequently, if there are NaN values, the final standard deviation will not be zero).
Note that, for efficiently, this method works in-place, actually changing values in the ndarray. Although it works in place, for convenience
it also returns itself. See <a class="reference internal" href="#pysnptools.snpreader.SnpData.standardize" title="pysnptools.snpreader.SnpData.standardize"><code class="xref py py-meth docutils literal notranslate"><span class="pre">SnpData.standardize()</span></code></a> for options and details.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">snp_on_disk</span> <span class="o">=</span> <span class="n">Bed</span><span class="p">(</span><span class="n">bedfile</span><span class="p">,</span><span class="n">count_A1</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="c1"># Specify some data on disk in Bed format</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snpdata1</span> <span class="o">=</span> <span class="n">snp_on_disk</span><span class="o">.</span><span class="n">read</span><span class="p">()</span> <span class="c1"># read all SNP values into memory</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">snpdata1</span><span class="p">)</span> <span class="c1"># Prints the specification for this SnpData</span>
<span class="go">SnpData(Bed(...tests/datasets/all_chr.maf0.001.N300.bed&#39;,count_A1=False))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">snpdata1</span><span class="o">.</span><span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="go">2.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snpdata1</span><span class="o">.</span><span class="n">standardize</span><span class="p">()</span> <span class="c1"># standardize changes the values in snpdata1.val and changes the specification.</span>
<span class="go">SnpData(Bed(...tests/datasets/all_chr.maf0.001.N300.bed&#39;,count_A1=False),Unit())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0:.6f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">snpdata1</span><span class="o">.</span><span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]))</span>
<span class="go">0.229416</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snpdata2</span> <span class="o">=</span> <span class="n">snp_on_disk</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">standardize</span><span class="p">()</span> <span class="c1"># Read and standardize in one expression with only one ndarray allocated.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0:.6f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">snpdata2</span><span class="o">.</span><span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]))</span>
<span class="go">0.229416</span>
</pre></div>
</div>
</dd>
</dl>
<p>The <a class="reference internal" href="#pysnptools.snpreader.SnpReader.read_kernel" title="pysnptools.snpreader.SnpReader.read_kernel"><code class="xref py py-meth docutils literal notranslate"><span class="pre">read_kernel()</span></code></a> Method</p>
<blockquote>
<div><p>The <a class="reference internal" href="#pysnptools.snpreader.SnpReader.read_kernel" title="pysnptools.snpreader.SnpReader.read_kernel"><code class="xref py py-meth docutils literal notranslate"><span class="pre">read_kernel()</span></code></a> method, available on any SnpReader, returns a <code class="xref py py-class docutils literal notranslate"><span class="pre">KernelData</span></code>. The <code class="xref py py-attr docutils literal notranslate"><span class="pre">val</span></code> property of the <code class="xref py py-class docutils literal notranslate"><span class="pre">KernelData</span></code> is
an ndarray of the (possibility standardized) SNP values multiplied with their transposed selves. When applied to an read-from-disk SnpReader, such as <a class="reference internal" href="#pysnptools.snpreader.Bed" title="pysnptools.snpreader.Bed"><code class="xref py py-class docutils literal notranslate"><span class="pre">Bed</span></code></a>,
the method can save memory by reading (and standardizing) the data in blocks. See <a class="reference internal" href="#pysnptools.snpreader.SnpReader.read_kernel" title="pysnptools.snpreader.SnpReader.read_kernel"><code class="xref py py-meth docutils literal notranslate"><span class="pre">read_kernel()</span></code></a> for details.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.standardizer</span> <span class="k">import</span> <span class="n">Unit</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snp_on_disk</span> <span class="o">=</span> <span class="n">Bed</span><span class="p">(</span><span class="n">bedfile</span><span class="p">,</span><span class="n">count_A1</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="c1"># Specify some data on disk in Bed format</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kerneldata1</span> <span class="o">=</span> <span class="n">snp_on_disk</span><span class="o">.</span><span class="n">read_kernel</span><span class="p">(</span><span class="n">Unit</span><span class="p">())</span> <span class="c1">#Create an in-memory kernel from the snp data on disk.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0:.6f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">kerneldata1</span><span class="o">.</span><span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]))</span>
<span class="go">901.421836</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kerneldata2</span> <span class="o">=</span> <span class="n">snp_on_disk</span><span class="o">.</span><span class="n">read_kernel</span><span class="p">(</span><span class="n">Unit</span><span class="p">(),</span><span class="n">block_size</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span> <span class="c1">#Create an in-memory kernel from the snp data on disk, but only read 10 SNPS at a time from the disk.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0:.6f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">kerneldata2</span><span class="o">.</span><span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]))</span>
<span class="go">901.421836</span>
</pre></div>
</div>
</div></blockquote>
<p>Details of Methods &amp; Properties:</p>
</dd>
</dl>
<dl class="py method">
<dt id="pysnptools.snpreader.SnpReader.iid">
<em class="property">property </em><code class="sig-name descname">iid</code><a class="headerlink" href="#pysnptools.snpreader.SnpReader.iid" title="Permalink to this definition">¶</a></dt>
<dd><p>A ndarray of the iids. Each iid is a ndarray of two strings (a family ID and a individual ID) that identifies an individual.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray of strings with shape [<a class="reference internal" href="#pysnptools.snpreader.SnpReader.iid_count" title="pysnptools.snpreader.SnpReader.iid_count"><code class="xref py py-attr docutils literal notranslate"><span class="pre">iid_count</span></code></a>,2]</p>
</dd>
</dl>
<p>This property (to the degree practical) reads only iid and sid data from the disk, not SNP value data. Moreover, the iid and sid data is read from file only once.</p>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">print_function</span> <span class="c1">#Python 2 &amp; 3 compatibility</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.snpreader</span> <span class="k">import</span> <span class="n">Bed</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.util</span> <span class="k">import</span> <span class="n">example_file</span> <span class="c1"># Download and return local file name</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bedfile</span> <span class="o">=</span> <span class="n">example_file</span><span class="p">(</span><span class="s2">&quot;tests/datasets/all_chr.maf0.001.N300.*&quot;</span><span class="p">,</span><span class="s2">&quot;*.bed&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snp_on_disk</span> <span class="o">=</span> <span class="n">Bed</span><span class="p">(</span><span class="n">bedfile</span><span class="p">,</span><span class="n">count_A1</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">snp_on_disk</span><span class="o">.</span><span class="n">iid</span><span class="p">[:</span><span class="mi">3</span><span class="p">])</span> <span class="c1"># print the first three iids</span>
<span class="go">[[&#39;POP1&#39; &#39;0&#39;]</span>
<span class="go"> [&#39;POP1&#39; &#39;12&#39;]</span>
<span class="go"> [&#39;POP1&#39; &#39;44&#39;]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="pysnptools.snpreader.SnpReader.iid_count">
<em class="property">property </em><code class="sig-name descname">iid_count</code><a class="headerlink" href="#pysnptools.snpreader.SnpReader.iid_count" title="Permalink to this definition">¶</a></dt>
<dd><p>number of iids</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>integer</p>
</dd>
</dl>
<p>This property (to the degree practical) reads only iid and sid data from the disk, not SNP value data. Moreover, the iid and sid data is read from file only once.</p>
</dd></dl>

<dl class="py method">
<dt id="pysnptools.snpreader.SnpReader.iid_to_index">
<code class="sig-name descname">iid_to_index</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">list</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.snpreader.SnpReader.iid_to_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes a list of iids and returns a list of index numbers</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>list</strong> – list of iids</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>ndarray of int</p>
</dd>
</dl>
<p>This method (to the degree practical) reads only iid and sid data from the disk, not SNP value data. Moreover, the iid and sid data is read from file only once.</p>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.snpreader</span> <span class="k">import</span> <span class="n">Bed</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.util</span> <span class="k">import</span> <span class="n">example_file</span> <span class="c1"># Download and return local file name</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bedfile</span> <span class="o">=</span> <span class="n">example_file</span><span class="p">(</span><span class="s2">&quot;tests/datasets/all_chr.maf0.001.N300.*&quot;</span><span class="p">,</span><span class="s2">&quot;*.bed&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snp_on_disk</span> <span class="o">=</span> <span class="n">Bed</span><span class="p">(</span><span class="n">bedfile</span><span class="p">,</span><span class="n">count_A1</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="c1"># Specify SNP data on disk</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">snp_on_disk</span><span class="o">.</span><span class="n">iid_to_index</span><span class="p">([[</span><span class="s1">&#39;POP1&#39;</span><span class="p">,</span><span class="s1">&#39;44&#39;</span><span class="p">],[</span><span class="s1">&#39;POP1&#39;</span><span class="p">,</span><span class="s1">&#39;12&#39;</span><span class="p">]]))</span> <span class="c1">#Find the indexes for two iids.</span>
<span class="go">[2 1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="pysnptools.snpreader.SnpReader.kernel">
<code class="sig-name descname">kernel</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">standardizer</span></em>, <em class="sig-param"><span class="n">allowlowrank</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">block_size</span><span class="o">=</span><span class="default_value">10000</span></em>, <em class="sig-param"><span class="n">blocksize</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.snpreader.SnpReader.kernel" title="Permalink to this definition">¶</a></dt>
<dd><div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Deprecated. Use <a class="reference internal" href="#pysnptools.snpreader.SnpReader.read_kernel" title="pysnptools.snpreader.SnpReader.read_kernel"><code class="xref py py-meth docutils literal notranslate"><span class="pre">read_kernel()</span></code></a> instead.</p>
</div>
<p>Returns a ndarray of size iid_count x iid_count. The returned array has the value of the standardized SNP values multiplied with their transposed selves.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>standardizer</strong> (<a class="reference internal" href="#pysnptools.standardizer.Standardizer" title="pysnptools.standardizer.Standardizer"><code class="xref py py-class docutils literal notranslate"><span class="pre">Standardizer</span></code></a>) – – Specify standardization to be applied before the matrix multiply. Any <a class="reference internal" href="#pysnptools.standardizer.Standardizer" title="pysnptools.standardizer.Standardizer"><code class="xref py py-class docutils literal notranslate"><span class="pre">Standardizer</span></code></a> may be used. Some choices include <code class="xref py py-class docutils literal notranslate"><span class="pre">Standardizer.Identity</span></code> 
(do nothing), <a class="reference internal" href="#pysnptools.standardizer.Unit" title="pysnptools.standardizer.Unit"><code class="xref py py-class docutils literal notranslate"><span class="pre">Unit</span></code></a> (make values for each SNP have mean zero and standard deviation 1.0), <code class="xref py py-class docutils literal notranslate"><span class="pre">Beta</span></code>.</p></li>
<li><p><strong>block_size</strong> (<em>int</em><em> or </em><em>None</em>) – optional – Default of 10000. None means to load all. Suggested number of sids to read into memory at a time.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>ndarray of size <a class="reference internal" href="#pysnptools.snpreader.SnpReader.iid_count" title="pysnptools.snpreader.SnpReader.iid_count"><code class="xref py py-attr docutils literal notranslate"><span class="pre">iid_count</span></code></a> x <a class="reference internal" href="#pysnptools.snpreader.SnpReader.iid_count" title="pysnptools.snpreader.SnpReader.iid_count"><code class="xref py py-attr docutils literal notranslate"><span class="pre">iid_count</span></code></a></p>
</dd>
</dl>
<p>Calling the method again causes the SNP values to be re-read and allocates a new ndarray.</p>
<p>When applied to an read-from-disk SnpReader, such as <a class="reference internal" href="#pysnptools.snpreader.Bed" title="pysnptools.snpreader.Bed"><code class="xref py py-class docutils literal notranslate"><span class="pre">Bed</span></code></a>, the method can save memory by reading (and standardizing) the data in blocks.</p>
<p>If you request the values for only a subset of the sids or iids, (to the degree practical) only that subset will be read from disk.</p>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.snpreader</span> <span class="k">import</span> <span class="n">Bed</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.standardizer</span> <span class="k">import</span> <span class="n">Unit</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.util</span> <span class="k">import</span> <span class="n">example_file</span> <span class="c1"># Download and return local file name</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bedfile</span> <span class="o">=</span> <span class="n">example_file</span><span class="p">(</span><span class="s2">&quot;tests/datasets/all_chr.maf0.001.N300.*&quot;</span><span class="p">,</span><span class="s2">&quot;*.bed&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snp_on_disk</span> <span class="o">=</span> <span class="n">Bed</span><span class="p">(</span><span class="n">bedfile</span><span class="p">,</span><span class="n">count_A1</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="c1"># Specify SNP data on disk</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kernel</span> <span class="o">=</span> <span class="n">snp_on_disk</span><span class="o">.</span><span class="n">kernel</span><span class="p">(</span><span class="n">Unit</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(((</span><span class="nb">int</span><span class="p">(</span><span class="n">kernel</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span><span class="nb">int</span><span class="p">(</span><span class="n">kernel</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])),</span> <span class="s1">&#39;</span><span class="si">{0:.6f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">kernel</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])))</span>
<span class="go">((300, 300), &#39;901.421836&#39;)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="pysnptools.snpreader.SnpReader.pos">
<em class="property">property </em><code class="sig-name descname">pos</code><a class="headerlink" href="#pysnptools.snpreader.SnpReader.pos" title="Permalink to this definition">¶</a></dt>
<dd><p>A ndarray of the position information for each sid. Each element is a ndarray of three numpy.numbers (chromosome, genetic distance, basepair distance).</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray of float64 with shape [<a class="reference internal" href="#pysnptools.snpreader.SnpReader.sid_count" title="pysnptools.snpreader.SnpReader.sid_count"><code class="xref py py-attr docutils literal notranslate"><span class="pre">sid_count</span></code></a>, 3]</p>
</dd>
</dl>
<p>This property (to the degree practical) reads only iid and sid data from the disk, not SNP value data. Moreover, the iid and sid data is read from file only once.</p>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.snpreader</span> <span class="k">import</span> <span class="n">Bed</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.util</span> <span class="k">import</span> <span class="n">example_file</span> <span class="c1"># Download and return local file name</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bedfile</span> <span class="o">=</span> <span class="n">example_file</span><span class="p">(</span><span class="s2">&quot;tests/datasets/all_chr.maf0.001.N300.*&quot;</span><span class="p">,</span><span class="s2">&quot;*.bed&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snp_on_disk</span> <span class="o">=</span> <span class="n">Bed</span><span class="p">(</span><span class="n">bedfile</span><span class="p">,</span><span class="n">count_A1</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">snp_on_disk</span><span class="o">.</span><span class="n">pos</span><span class="p">[:</span><span class="mi">3</span><span class="p">,])</span> <span class="c1"># print position information for the first three sids: #The &#39;...&#39; is for possible space char</span>
<span class="go">[[...1.          0.00800801  0.        ]</span>
<span class="go"> [...1.          0.023023    1.        ]</span>
<span class="go"> [...1.          0.0700701   4.        ]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="pysnptools.snpreader.SnpReader.read">
<code class="sig-name descname">read</code><span class="sig-paren">(</span><em class="sig-param">order='F'</em>, <em class="sig-param">dtype=&lt;class 'numpy.float64'&gt;</em>, <em class="sig-param">force_python_only=False</em>, <em class="sig-param">view_ok=False</em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.snpreader.SnpReader.read" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads the SNP values and returns a <a class="reference internal" href="#pysnptools.snpreader.SnpData" title="pysnptools.snpreader.SnpData"><code class="xref py py-class docutils literal notranslate"><span class="pre">SnpData</span></code></a> (with <a class="reference internal" href="#pysnptools.snpreader.SnpData.val" title="pysnptools.snpreader.SnpData.val"><code class="xref py py-attr docutils literal notranslate"><span class="pre">SnpData.val</span></code></a> property containing a new ndarray of the SNP values).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>order</strong> (<em>string</em><em> or </em><em>None</em>) – {‘F’ (default), ‘C’, ‘A’}, optional – Specify the order of the ndarray. If order is ‘F’ (default),
then the array will be in F-contiguous order (iid-index varies the fastest).
If order is ‘C’, then the returned array will be in C-contiguous order (sid-index varies the fastest).
If order is ‘A’, then the <a class="reference internal" href="#pysnptools.snpreader.SnpData.val" title="pysnptools.snpreader.SnpData.val"><code class="xref py py-attr docutils literal notranslate"><span class="pre">SnpData.val</span></code></a>
ndarray may be in any order (either C-, Fortran-contiguous).</p></li>
<li><p><strong>dtype</strong> (<em>data-type</em>) – {numpy.float64 (default), numpy.float32}, optional – The data-type for the <a class="reference internal" href="#pysnptools.snpreader.SnpData.val" title="pysnptools.snpreader.SnpData.val"><code class="xref py py-attr docutils literal notranslate"><span class="pre">SnpData.val</span></code></a> ndarray.</p></li>
<li><p><strong>force_python_only</strong> (<em>bool</em>) – optional – If False (default), may use outside library code. If True, requests that the read
be done without outside library code.</p></li>
<li><p><strong>view_ok</strong> (<em>bool</em>) – optional – If False (default), allocates new memory for the <a class="reference internal" href="#pysnptools.snpreader.SnpData.val" title="pysnptools.snpreader.SnpData.val"><code class="xref py py-attr docutils literal notranslate"><span class="pre">SnpData.val</span></code></a>’s ndarray. If True,
if practical and reading from a <a class="reference internal" href="#pysnptools.snpreader.SnpData" title="pysnptools.snpreader.SnpData"><code class="xref py py-class docutils literal notranslate"><span class="pre">SnpData</span></code></a>, will return a new 
<a class="reference internal" href="#pysnptools.snpreader.SnpData" title="pysnptools.snpreader.SnpData"><code class="xref py py-class docutils literal notranslate"><span class="pre">SnpData</span></code></a> with a ndarray shares memory with the original <a class="reference internal" href="#pysnptools.snpreader.SnpData" title="pysnptools.snpreader.SnpData"><code class="xref py py-class docutils literal notranslate"><span class="pre">SnpData</span></code></a>.
Typically, you’ll also wish to use “order=’A’” to increase the chance that sharing will be possible.
Use these parameters with care because any change to either ndarray (for example, via <a class="reference internal" href="#pysnptools.snpreader.SnpData.standardize" title="pysnptools.snpreader.SnpData.standardize"><code class="xref py py-meth docutils literal notranslate"><span class="pre">SnpData.standardize()</span></code></a>) will effect
the others. Also keep in mind that <a class="reference internal" href="#pysnptools.snpreader.SnpReader.read" title="pysnptools.snpreader.SnpReader.read"><code class="xref py py-meth docutils literal notranslate"><span class="pre">read()</span></code></a> relies on ndarray’s mechanisms to decide whether to actually
share memory and so it may ignore your suggestion and allocate a new ndarray anyway.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="#pysnptools.snpreader.SnpData" title="pysnptools.snpreader.SnpData"><code class="xref py py-class docutils literal notranslate"><span class="pre">SnpData</span></code></a></p>
</dd>
</dl>
<p>Calling the method again causes the SNP values to be re-read and creates a new in-memory <a class="reference internal" href="#pysnptools.snpreader.SnpData" title="pysnptools.snpreader.SnpData"><code class="xref py py-class docutils literal notranslate"><span class="pre">SnpData</span></code></a> with a new ndarray of SNP values.</p>
<p>If you request the values for only a subset of the sids or iids, (to the degree practical) only that subset will be read from disk.</p>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.snpreader</span> <span class="k">import</span> <span class="n">Bed</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snp_on_disk</span> <span class="o">=</span> <span class="n">Bed</span><span class="p">(</span><span class="s1">&#39;../../tests/datasets/all_chr.maf0.001.N300.bed&#39;</span><span class="p">,</span><span class="n">count_A1</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="c1"># Specify SNP data on disk</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snpdata1</span> <span class="o">=</span> <span class="n">snp_on_disk</span><span class="o">.</span><span class="n">read</span><span class="p">()</span> <span class="c1"># Read all the SNP data returning a SnpData instance</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">snpdata1</span><span class="o">.</span><span class="n">val</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span> <span class="c1"># The SnpData instance contains a ndarray of the data.</span>
<span class="go">ndarray</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">subset_snpdata</span> <span class="o">=</span> <span class="n">snp_on_disk</span><span class="p">[:,::</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">read</span><span class="p">()</span> <span class="c1"># From the disk, read SNP values for every other sid</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">subset_snpdata</span><span class="o">.</span><span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span> <span class="c1"># Print the first SNP value in the subset</span>
<span class="go">2.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">subsub_snpdata</span> <span class="o">=</span> <span class="n">subset_snpdata</span><span class="p">[:</span><span class="mi">10</span><span class="p">,:]</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="n">view_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1"># Create an in-memory subset of the subset with SNP values for the first ten iids. Share memory if practical.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># print np.may_share_memory(subset_snpdata.val, subsub_snpdata.val) # Do the two ndarray&#39;s share memory? They could. Currently they won&#39;t.       </span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="pysnptools.snpreader.SnpReader.read_kernel">
<code class="sig-name descname">read_kernel</code><span class="sig-paren">(</span><em class="sig-param">standardizer=None</em>, <em class="sig-param">block_size=None</em>, <em class="sig-param">order='A'</em>, <em class="sig-param">dtype=&lt;class 'numpy.float64'&gt;</em>, <em class="sig-param">force_python_only=False</em>, <em class="sig-param">view_ok=False</em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.snpreader.SnpReader.read_kernel" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a <code class="xref py py-class docutils literal notranslate"><span class="pre">KernelData</span></code> such that the <code class="xref py py-meth docutils literal notranslate"><span class="pre">KernelData.val()</span></code> property will be a ndarray of the standardized SNP values multiplied with their transposed selves.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>standardizer</strong> (<a class="reference internal" href="#pysnptools.standardizer.Standardizer" title="pysnptools.standardizer.Standardizer"><code class="xref py py-class docutils literal notranslate"><span class="pre">Standardizer</span></code></a>) – – (required) Specify standardization to be applied before the matrix multiply. Any <a class="reference internal" href="#pysnptools.standardizer.Standardizer" title="pysnptools.standardizer.Standardizer"><code class="xref py py-class docutils literal notranslate"><span class="pre">Standardizer</span></code></a> may be used. Some choices include <code class="xref py py-class docutils literal notranslate"><span class="pre">Standardizer.Identity</span></code> 
(do nothing), <a class="reference internal" href="#pysnptools.standardizer.Unit" title="pysnptools.standardizer.Unit"><code class="xref py py-class docutils literal notranslate"><span class="pre">Unit</span></code></a> (make values for each SNP have mean zero and standard deviation 1.0) and <code class="xref py py-class docutils literal notranslate"><span class="pre">Beta</span></code>.</p></li>
<li><p><strong>block_size</strong> (<em>int</em><em> or </em><em>None</em>) – optional – Default of None (meaning to load all). Suggested number of sids to read into memory at a time.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>class:<cite>KernelData</cite></p>
</dd>
</dl>
<p>Calling the method again causes the SNP values to be re-read and allocates a new class:<cite>KernelData</cite>.</p>
<p>When applied to an read-from-disk SnpReader, such as <a class="reference internal" href="#pysnptools.snpreader.Bed" title="pysnptools.snpreader.Bed"><code class="xref py py-class docutils literal notranslate"><span class="pre">Bed</span></code></a>, the method can save memory by reading (and standardizing) the data in blocks.</p>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.snpreader</span> <span class="k">import</span> <span class="n">Bed</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.standardizer</span> <span class="k">import</span> <span class="n">Unit</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.util</span> <span class="k">import</span> <span class="n">example_file</span> <span class="c1"># Download and return local file name</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bedfile</span> <span class="o">=</span> <span class="n">example_file</span><span class="p">(</span><span class="s2">&quot;tests/datasets/all_chr.maf0.001.N300.*&quot;</span><span class="p">,</span><span class="s2">&quot;*.bed&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snp_on_disk</span> <span class="o">=</span> <span class="n">Bed</span><span class="p">(</span><span class="n">bedfile</span><span class="p">,</span><span class="n">count_A1</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="c1"># Specify SNP data on disk</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kerneldata1</span> <span class="o">=</span> <span class="n">snp_on_disk</span><span class="o">.</span><span class="n">read_kernel</span><span class="p">(</span><span class="n">Unit</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">((</span><span class="nb">int</span><span class="p">(</span><span class="n">kerneldata1</span><span class="o">.</span><span class="n">iid_count</span><span class="p">),</span> <span class="s1">&#39;</span><span class="si">{0:.6f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">kerneldata1</span><span class="o">.</span><span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])))</span>
<span class="go">(300, &#39;901.421836&#39;)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="pysnptools.snpreader.SnpReader.row_property">
<em class="property">property </em><code class="sig-name descname">row_property</code><a class="headerlink" href="#pysnptools.snpreader.SnpReader.row_property" title="Permalink to this definition">¶</a></dt>
<dd><p>Defined as a zero-width array for compatibility with <code class="xref py py-class docutils literal notranslate"><span class="pre">PstReader</span></code>, but not used.</p>
</dd></dl>

<dl class="py method">
<dt id="pysnptools.snpreader.SnpReader.sid">
<em class="property">property </em><code class="sig-name descname">sid</code><a class="headerlink" href="#pysnptools.snpreader.SnpReader.sid" title="Permalink to this definition">¶</a></dt>
<dd><p>A ndarray of the sids. Each sid is a string that identifies a SNP.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray (length <a class="reference internal" href="#pysnptools.snpreader.SnpReader.sid_count" title="pysnptools.snpreader.SnpReader.sid_count"><code class="xref py py-attr docutils literal notranslate"><span class="pre">sid_count</span></code></a>) of strings</p>
</dd>
</dl>
<p>This property (to the degree practical) reads only iid and sid data from the disk, not SNP value data. Moreover, the iid and sid data is read from file only once.</p>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.snpreader</span> <span class="k">import</span> <span class="n">Bed</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.util</span> <span class="k">import</span> <span class="n">example_file</span> <span class="c1"># Download and return local file name</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bedfile</span> <span class="o">=</span> <span class="n">example_file</span><span class="p">(</span><span class="s2">&quot;tests/datasets/all_chr.maf0.001.N300.*&quot;</span><span class="p">,</span><span class="s2">&quot;*.bed&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snp_on_disk</span> <span class="o">=</span> <span class="n">Bed</span><span class="p">(</span><span class="n">bedfile</span><span class="p">,</span><span class="n">count_A1</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">snp_on_disk</span><span class="o">.</span><span class="n">sid</span><span class="p">[:</span><span class="mi">9</span><span class="p">])</span> <span class="c1"># print the first nine sids</span>
<span class="go">[&#39;1_12&#39; &#39;1_34&#39; &#39;1_10&#39; &#39;1_35&#39; &#39;1_28&#39; &#39;1_25&#39; &#39;1_36&#39; &#39;1_39&#39; &#39;1_4&#39;]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="pysnptools.snpreader.SnpReader.sid_count">
<em class="property">property </em><code class="sig-name descname">sid_count</code><a class="headerlink" href="#pysnptools.snpreader.SnpReader.sid_count" title="Permalink to this definition">¶</a></dt>
<dd><p>number of sids</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>integer</p>
</dd>
</dl>
<p>This property (to the degree practical) reads only iid and sid data from the disk, not SNP value data. Moreover, the iid and sid data is read from file only once.</p>
</dd></dl>

<dl class="py method">
<dt id="pysnptools.snpreader.SnpReader.sid_to_index">
<code class="sig-name descname">sid_to_index</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">list</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.snpreader.SnpReader.sid_to_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes a list of sids and returns a list of index numbers</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>list</strong> (<em>list of strings</em>) – list of sids</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>ndarray of int</p>
</dd>
</dl>
<p>This method (to the degree practical) reads only iid and sid data from the disk, not SNP value data. Moreover, the iid and sid data is read from file only once.</p>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.snpreader</span> <span class="k">import</span> <span class="n">Bed</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.util</span> <span class="k">import</span> <span class="n">example_file</span> <span class="c1"># Download and return local file name</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bedfile</span> <span class="o">=</span> <span class="n">example_file</span><span class="p">(</span><span class="s2">&quot;tests/datasets/all_chr.maf0.001.N300.*&quot;</span><span class="p">,</span><span class="s2">&quot;*.bed&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snp_on_disk</span> <span class="o">=</span> <span class="n">Bed</span><span class="p">(</span><span class="n">bedfile</span><span class="p">,</span><span class="n">count_A1</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="c1"># Specify SNP data on disk</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">snp_on_disk</span><span class="o">.</span><span class="n">sid_to_index</span><span class="p">([</span><span class="s1">&#39;1_10&#39;</span><span class="p">,</span><span class="s1">&#39;1_13&#39;</span><span class="p">]))</span> <span class="c1">#Find the indexes for two sids.</span>
<span class="go">[2 9]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="pysnptools.snpreader.SnpReader.val_shape">
<em class="property">property </em><code class="sig-name descname">val_shape</code><a class="headerlink" href="#pysnptools.snpreader.SnpReader.val_shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Tells the shape of value for a given individual and SNP. For SnpReaders always returns None, meaning a single scalar value.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="snpreader-bed">
<h3><code class="xref py py-class docutils literal notranslate"><span class="pre">snpreader.Bed</span></code><a class="headerlink" href="#snpreader-bed" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt id="pysnptools.snpreader.Bed">
<em class="property">class </em><code class="sig-prename descclassname">pysnptools.snpreader.</code><code class="sig-name descname">Bed</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span></em>, <em class="sig-param"><span class="n">count_A1</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">iid</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">sid</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">pos</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">skip_format_check</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.snpreader.Bed" title="Permalink to this definition">¶</a></dt>
<dd><p>A <a class="reference internal" href="#pysnptools.snpreader.SnpReader" title="pysnptools.snpreader.SnpReader"><code class="xref py py-class docutils literal notranslate"><span class="pre">SnpReader</span></code></a> for random-access reads of Bed/Bim/Fam files from disk.</p>
<p>See <a class="reference internal" href="#pysnptools.snpreader.SnpReader" title="pysnptools.snpreader.SnpReader"><code class="xref py py-class docutils literal notranslate"><span class="pre">SnpReader</span></code></a> for details and examples.</p>
<p>The format is described in <a class="reference external" href="http://zzz.bwh.harvard.edu/plink/binary.shtml">http://zzz.bwh.harvard.edu/plink/binary.shtml</a>.</p>
<dl>
<dt><strong>Constructor:</strong></dt><dd><dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>string</em>) – The *.bed file to read. The ‘.bed’ suffix is optional. The related *.bim and *.fam files will also be read.</p></li>
<li><p><strong>count_A1</strong> (<em>bool</em>) – Tells if it should count the number of A1 alleles (the PLINK standard) or the number of A2 alleles. False is the current default, but in the future the default will change to True.</p></li>
</ul>
<p><em>The following options are never needed, but can be used to avoid reading large ‘.fam’ and ‘.bim’ files when their information is already known.</em></p>
<ul class="simple">
<li><p><strong>iid</strong> (an array of strings) – The <a class="reference internal" href="#pysnptools.snpreader.SnpReader.iid" title="pysnptools.snpreader.SnpReader.iid"><code class="xref py py-attr docutils literal notranslate"><span class="pre">SnpReader.iid</span></code></a> information. If not given, reads info from ‘.fam’ file.</p></li>
<li><p><strong>sid</strong> (an array of strings) – The <a class="reference internal" href="#pysnptools.snpreader.SnpReader.sid" title="pysnptools.snpreader.SnpReader.sid"><code class="xref py py-attr docutils literal notranslate"><span class="pre">SnpReader.sid</span></code></a> information. If not given, reads info from ‘.bim’ file.</p></li>
<li><p><strong>pos</strong> (optional, an array of strings) – The <a class="reference internal" href="#pysnptools.snpreader.SnpReader.pos" title="pysnptools.snpreader.SnpReader.pos"><code class="xref py py-attr docutils literal notranslate"><span class="pre">SnpReader.pos</span></code></a> information.  If not given, reads info from ‘.bim’ file.</p></li>
<li><p><strong>skip_format_check</strong> (<em>bool</em>) – If False (default), will check that ‘.bed’ file has expected starting bytes.</p></li>
</ul>
</dd>
</dl>
</dd>
</dl>
<p><strong>Methods beyond</strong> <a class="reference internal" href="#pysnptools.snpreader.SnpReader" title="pysnptools.snpreader.SnpReader"><code class="xref py py-class docutils literal notranslate"><span class="pre">SnpReader</span></code></a></p>
<dl class="py method">
<dt id="pysnptools.snpreader.Bed.write">
<em class="property">static </em><code class="sig-name descname">write</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span></em>, <em class="sig-param"><span class="n">snpdata</span></em>, <em class="sig-param"><span class="n">count_A1</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">force_python_only</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.snpreader.Bed.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes a <a class="reference internal" href="#pysnptools.snpreader.SnpData" title="pysnptools.snpreader.SnpData"><code class="xref py py-class docutils literal notranslate"><span class="pre">SnpData</span></code></a> to Bed format and returns the <a class="reference internal" href="#pysnptools.snpreader.Bed" title="pysnptools.snpreader.Bed"><code class="xref py py-class docutils literal notranslate"><span class="pre">Bed</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>string</em>) – the name of the file to create</p></li>
<li><p><strong>snpdata</strong> (<a class="reference internal" href="#pysnptools.snpreader.SnpData" title="pysnptools.snpreader.SnpData"><code class="xref py py-class docutils literal notranslate"><span class="pre">SnpData</span></code></a>) – The in-memory data that should be written to disk.</p></li>
<li><p><strong>count_A1</strong> (<em>bool</em>) – Tells if it should count the number of A1 alleles (the PLINK standard) or the number of A2 alleles. False is the current default, but in the future the default will change to True.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="#pysnptools.snpreader.Bed" title="pysnptools.snpreader.Bed"><code class="xref py py-class docutils literal notranslate"><span class="pre">Bed</span></code></a></p>
</dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.snpreader</span> <span class="k">import</span> <span class="n">Pheno</span><span class="p">,</span> <span class="n">Bed</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pysnptools.util</span> <span class="k">as</span> <span class="nn">pstutil</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.util</span> <span class="k">import</span> <span class="n">example_file</span> <span class="c1"># Download and return local file name</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pheno_fn</span> <span class="o">=</span> <span class="n">example_file</span><span class="p">(</span><span class="s2">&quot;pysnptools/examples/toydata.phe&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snpdata</span> <span class="o">=</span> <span class="n">Pheno</span><span class="p">(</span><span class="n">pheno_fn</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>         <span class="c1"># Read data from Pheno format</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pstutil</span><span class="o">.</span><span class="n">create_directory_if_necessary</span><span class="p">(</span><span class="s2">&quot;tempdir/toydata.bed&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Bed</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;tempdir/toydata.bed&quot;</span><span class="p">,</span><span class="n">snpdata</span><span class="p">,</span><span class="n">count_A1</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>   <span class="c1"># Write data in Bed format</span>
<span class="go">Bed(&#39;tempdir/toydata.bed&#39;,count_A1=False)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="snpreader-snpdata">
<h3><code class="xref py py-class docutils literal notranslate"><span class="pre">snpreader.SnpData</span></code><a class="headerlink" href="#snpreader-snpdata" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt id="pysnptools.snpreader.SnpData">
<em class="property">class </em><code class="sig-prename descclassname">pysnptools.snpreader.</code><code class="sig-name descname">SnpData</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">iid</span></em>, <em class="sig-param"><span class="n">sid</span></em>, <em class="sig-param"><span class="n">val</span></em>, <em class="sig-param"><span class="n">pos</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">name</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">parent_string</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">copyinputs_function</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.snpreader.SnpData" title="Permalink to this definition">¶</a></dt>
<dd><p>A <a class="reference internal" href="#pysnptools.snpreader.SnpReader" title="pysnptools.snpreader.SnpReader"><code class="xref py py-class docutils literal notranslate"><span class="pre">SnpReader</span></code></a> for holding SNP values (or similar values) in-memory, along with related iid and sid information.
It is usually created by calling the <a class="reference internal" href="#pysnptools.snpreader.SnpReader.read" title="pysnptools.snpreader.SnpReader.read"><code class="xref py py-meth docutils literal notranslate"><span class="pre">SnpReader.read()</span></code></a> method on another <a class="reference internal" href="#pysnptools.snpreader.SnpReader" title="pysnptools.snpreader.SnpReader"><code class="xref py py-class docutils literal notranslate"><span class="pre">SnpReader</span></code></a>, for example, <a class="reference internal" href="#pysnptools.snpreader.Bed" title="pysnptools.snpreader.Bed"><code class="xref py py-class docutils literal notranslate"><span class="pre">Bed</span></code></a>. It can also be constructed directly.</p>
<p>See <a class="reference internal" href="#pysnptools.snpreader.SnpReader" title="pysnptools.snpreader.SnpReader"><code class="xref py py-class docutils literal notranslate"><span class="pre">SnpReader</span></code></a> for details and examples.</p>
<dl>
<dt><strong>Constructor:</strong></dt><dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>iid</strong> (an array of string pair) – The <a class="reference internal" href="#pysnptools.snpreader.SnpReader.iid" title="pysnptools.snpreader.SnpReader.iid"><code class="xref py py-attr docutils literal notranslate"><span class="pre">SnpReader.iid</span></code></a> information.</p></li>
<li><p><strong>sid</strong> (an array of strings) – The <a class="reference internal" href="#pysnptools.snpreader.SnpReader.sid" title="pysnptools.snpreader.SnpReader.sid"><code class="xref py py-attr docutils literal notranslate"><span class="pre">SnpReader.sid</span></code></a> information.</p></li>
<li><p><strong>val</strong> (a 2-D array of floats) – The SNP values</p></li>
<li><p><strong>pos</strong> (optional, an array of strings) – The <a class="reference internal" href="#pysnptools.snpreader.SnpReader.pos" title="pysnptools.snpreader.SnpReader.pos"><code class="xref py py-attr docutils literal notranslate"><span class="pre">SnpReader.pos</span></code></a> information</p></li>
<li><p><strong>name</strong> (optional, string) – Information to be display about the origin of this data</p></li>
<li><p><strong>copyinputs_function</strong> (optional, function) – <em>Used internally by optional clustering code</em></p></li>
</ul>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">print_function</span> <span class="c1">#Python 2 &amp; 3 compatibility</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.snpreader</span> <span class="k">import</span> <span class="n">SnpData</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snpdata</span> <span class="o">=</span> <span class="n">SnpData</span><span class="p">(</span><span class="n">iid</span><span class="o">=</span><span class="p">[[</span><span class="s1">&#39;fam0&#39;</span><span class="p">,</span><span class="s1">&#39;iid0&#39;</span><span class="p">],[</span><span class="s1">&#39;fam0&#39;</span><span class="p">,</span><span class="s1">&#39;iid1&#39;</span><span class="p">]],</span> <span class="n">sid</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;snp334&#39;</span><span class="p">,</span><span class="s1">&#39;snp349&#39;</span><span class="p">,</span><span class="s1">&#39;snp921&#39;</span><span class="p">],</span> <span class="n">val</span><span class="o">=</span><span class="p">[[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">2.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">2.</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">((</span><span class="n">snpdata</span><span class="o">.</span><span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">snpdata</span><span class="o">.</span><span class="n">iid_count</span><span class="p">,</span> <span class="n">snpdata</span><span class="o">.</span><span class="n">sid_count</span><span class="p">))</span>
<span class="go">(2.0, 2, 3)</span>
</pre></div>
</div>
</dd>
</dl>
<p><strong>Equality:</strong></p>
<blockquote>
<div><p>Two SnpData objects are equal if their four arrays (<a class="reference internal" href="#pysnptools.snpreader.SnpData.val" title="pysnptools.snpreader.SnpData.val"><code class="xref py py-attr docutils literal notranslate"><span class="pre">SnpData.val</span></code></a>, <a class="reference internal" href="#pysnptools.snpreader.SnpReader.iid" title="pysnptools.snpreader.SnpReader.iid"><code class="xref py py-attr docutils literal notranslate"><span class="pre">SnpReader.iid</span></code></a>, <a class="reference internal" href="#pysnptools.snpreader.SnpReader.sid" title="pysnptools.snpreader.SnpReader.sid"><code class="xref py py-attr docutils literal notranslate"><span class="pre">SnpReader.sid</span></code></a>, and <a class="reference internal" href="#pysnptools.snpreader.SnpReader.pos" title="pysnptools.snpreader.SnpReader.pos"><code class="xref py py-attr docutils literal notranslate"><span class="pre">SnpReader.pos</span></code></a>)
are ‘array_equal’. (Their ‘name’ does not need to be the same).
If either <a class="reference internal" href="#pysnptools.snpreader.SnpData.val" title="pysnptools.snpreader.SnpData.val"><code class="xref py py-attr docutils literal notranslate"><span class="pre">SnpData.val</span></code></a> contains NaN, the objects will not be equal. However, <a class="reference internal" href="#pysnptools.snpreader.SnpData.allclose" title="pysnptools.snpreader.SnpData.allclose"><code class="xref py py-meth docutils literal notranslate"><span class="pre">SnpData.allclose()</span></code></a> can be used to treat NaN as
regular values.</p>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.snpreader</span> <span class="k">import</span> <span class="n">SnpData</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snpdata1</span> <span class="o">=</span> <span class="n">SnpData</span><span class="p">(</span><span class="n">iid</span><span class="o">=</span><span class="p">[[</span><span class="s1">&#39;fam0&#39;</span><span class="p">,</span><span class="s1">&#39;iid0&#39;</span><span class="p">],[</span><span class="s1">&#39;fam0&#39;</span><span class="p">,</span><span class="s1">&#39;iid1&#39;</span><span class="p">]],</span> <span class="n">sid</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;snp334&#39;</span><span class="p">,</span><span class="s1">&#39;snp349&#39;</span><span class="p">,</span><span class="s1">&#39;snp921&#39;</span><span class="p">],</span> <span class="n">val</span><span class="o">=</span><span class="p">[[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">2.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">2.</span><span class="p">]],</span> <span class="n">pos</span><span class="o">=</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snpdata2</span> <span class="o">=</span> <span class="n">SnpData</span><span class="p">(</span><span class="n">iid</span><span class="o">=</span><span class="p">[[</span><span class="s1">&#39;fam0&#39;</span><span class="p">,</span><span class="s1">&#39;iid0&#39;</span><span class="p">],[</span><span class="s1">&#39;fam0&#39;</span><span class="p">,</span><span class="s1">&#39;iid1&#39;</span><span class="p">]],</span> <span class="n">sid</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;snp334&#39;</span><span class="p">,</span><span class="s1">&#39;snp349&#39;</span><span class="p">,</span><span class="s1">&#39;snp921&#39;</span><span class="p">],</span> <span class="n">val</span><span class="o">=</span><span class="p">[[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">2.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">2.</span><span class="p">]],</span> <span class="n">pos</span><span class="o">=</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">snpdata1</span> <span class="o">==</span> <span class="n">snpdata2</span><span class="p">)</span> <span class="c1">#True, because all the arrays have the same values.</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">snpdata1</span><span class="o">.</span><span class="n">val</span> <span class="ow">is</span> <span class="n">snpdata2</span><span class="o">.</span><span class="n">val</span><span class="p">)</span> <span class="c1">#False, because the two arrays have different memory.</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snpdata3</span> <span class="o">=</span> <span class="n">SnpData</span><span class="p">(</span><span class="n">iid</span><span class="o">=</span><span class="p">[[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;0&#39;</span><span class="p">],[</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="s1">&#39;0&#39;</span><span class="p">]],</span> <span class="n">sid</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;snp334&#39;</span><span class="p">,</span><span class="s1">&#39;snp349&#39;</span><span class="p">,</span><span class="s1">&#39;snp921&#39;</span><span class="p">],</span> <span class="n">val</span><span class="o">=</span><span class="p">[[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">2.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">2.</span><span class="p">]],</span> <span class="n">pos</span><span class="o">=</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snpdata4</span> <span class="o">=</span> <span class="n">SnpData</span><span class="p">(</span><span class="n">iid</span><span class="o">=</span><span class="p">[[</span><span class="s1">&#39;fam0&#39;</span><span class="p">,</span><span class="s1">&#39;iid0&#39;</span><span class="p">],[</span><span class="s1">&#39;fam0&#39;</span><span class="p">,</span><span class="s1">&#39;iid1&#39;</span><span class="p">]],</span> <span class="n">sid</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;snp334&#39;</span><span class="p">,</span><span class="s1">&#39;snp349&#39;</span><span class="p">,</span><span class="s1">&#39;snp921&#39;</span><span class="p">],</span> <span class="n">val</span><span class="o">=</span><span class="p">[[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">2.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">2.</span><span class="p">]],</span> <span class="n">pos</span><span class="o">=</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">snpdata3</span> <span class="o">==</span> <span class="n">snpdata4</span><span class="p">)</span> <span class="c1">#False, because the iids are different.</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snpdata5</span> <span class="o">=</span> <span class="n">SnpData</span><span class="p">(</span><span class="n">iid</span><span class="o">=</span><span class="p">[[</span><span class="s1">&#39;fam0&#39;</span><span class="p">,</span><span class="s1">&#39;iid0&#39;</span><span class="p">],[</span><span class="s1">&#39;fam0&#39;</span><span class="p">,</span><span class="s1">&#39;iid1&#39;</span><span class="p">]],</span> <span class="n">sid</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;snp334&#39;</span><span class="p">,</span><span class="s1">&#39;snp349&#39;</span><span class="p">,</span><span class="s1">&#39;snp921&#39;</span><span class="p">],</span> <span class="n">val</span><span class="o">=</span><span class="p">[[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">2.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">]],</span> <span class="n">pos</span><span class="o">=</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snpdata6</span> <span class="o">=</span> <span class="n">SnpData</span><span class="p">(</span><span class="n">iid</span><span class="o">=</span><span class="p">[[</span><span class="s1">&#39;fam0&#39;</span><span class="p">,</span><span class="s1">&#39;iid0&#39;</span><span class="p">],[</span><span class="s1">&#39;fam0&#39;</span><span class="p">,</span><span class="s1">&#39;iid1&#39;</span><span class="p">]],</span> <span class="n">sid</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;snp334&#39;</span><span class="p">,</span><span class="s1">&#39;snp349&#39;</span><span class="p">,</span><span class="s1">&#39;snp921&#39;</span><span class="p">],</span> <span class="n">val</span><span class="o">=</span><span class="p">[[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">2.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">]],</span> <span class="n">pos</span><span class="o">=</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">snpdata5</span> <span class="o">==</span> <span class="n">snpdata6</span><span class="p">)</span> <span class="c1">#False, because the val&#39;s contain NaN</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">snpdata5</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">snpdata6</span><span class="p">))</span> <span class="c1">#True, if we consider the NaN as regular values, all the arrays have the same values.</span>
<span class="go">True</span>
</pre></div>
</div>
</div></blockquote>
<p><strong>Methods beyond</strong> <a class="reference internal" href="#pysnptools.snpreader.SnpReader" title="pysnptools.snpreader.SnpReader"><code class="xref py py-class docutils literal notranslate"><span class="pre">SnpReader</span></code></a></p>
<dl class="py method">
<dt id="pysnptools.snpreader.SnpData.allclose">
<code class="sig-name descname">allclose</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">value</span></em>, <em class="sig-param"><span class="n">equal_nan</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.snpreader.SnpData.allclose" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>value</strong> (<a class="reference internal" href="#pysnptools.snpreader.SnpData" title="pysnptools.snpreader.SnpData"><code class="xref py py-class docutils literal notranslate"><span class="pre">SnpData</span></code></a>) – Other object with which to compare.</p></li>
<li><p><strong>equal_nan</strong> (<em>bool</em>) – (Default: True) Tells if NaN in <a class="reference internal" href="#pysnptools.snpreader.SnpData.val" title="pysnptools.snpreader.SnpData.val"><code class="xref py py-attr docutils literal notranslate"><span class="pre">SnpData.val</span></code></a> should be treated as regular values when testing equality.</p></li>
</ul>
</dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snpdata5</span> <span class="o">=</span> <span class="n">SnpData</span><span class="p">(</span><span class="n">iid</span><span class="o">=</span><span class="p">[[</span><span class="s1">&#39;fam0&#39;</span><span class="p">,</span><span class="s1">&#39;iid0&#39;</span><span class="p">],[</span><span class="s1">&#39;fam0&#39;</span><span class="p">,</span><span class="s1">&#39;iid1&#39;</span><span class="p">]],</span> <span class="n">sid</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;snp334&#39;</span><span class="p">,</span><span class="s1">&#39;snp349&#39;</span><span class="p">,</span><span class="s1">&#39;snp921&#39;</span><span class="p">],</span> <span class="n">val</span><span class="o">=</span><span class="p">[[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">2.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">]],</span> <span class="n">pos</span><span class="o">=</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snpdata6</span> <span class="o">=</span> <span class="n">SnpData</span><span class="p">(</span><span class="n">iid</span><span class="o">=</span><span class="p">[[</span><span class="s1">&#39;fam0&#39;</span><span class="p">,</span><span class="s1">&#39;iid0&#39;</span><span class="p">],[</span><span class="s1">&#39;fam0&#39;</span><span class="p">,</span><span class="s1">&#39;iid1&#39;</span><span class="p">]],</span> <span class="n">sid</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;snp334&#39;</span><span class="p">,</span><span class="s1">&#39;snp349&#39;</span><span class="p">,</span><span class="s1">&#39;snp921&#39;</span><span class="p">],</span> <span class="n">val</span><span class="o">=</span><span class="p">[[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">2.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">]],</span> <span class="n">pos</span><span class="o">=</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">snpdata5</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">snpdata6</span><span class="p">))</span> <span class="c1">#True, if we consider the NaN as regular values, all the arrays have the same values.</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">snpdata5</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">snpdata6</span><span class="p">,</span><span class="n">equal_nan</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span> <span class="c1">#False, if we consider the NaN as special values, all the arrays are not equal.</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="pysnptools.snpreader.SnpData.standardize">
<code class="sig-name descname">standardize</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">standardizer</span><span class="o">=</span><span class="default_value">Unit()</span></em>, <em class="sig-param"><span class="n">block_size</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">return_trained</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">force_python_only</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.snpreader.SnpData.standardize" title="Permalink to this definition">¶</a></dt>
<dd><p>Does in-place standardization of the in-memory
SNP data. By default, it applies ‘Unit’ standardization, that is: the values for each SNP will have mean zero and standard deviation 1.0.
NaN values are then filled with zero, the mean (consequently, if there are NaN values, the final standard deviation will not be zero.
Note that, for efficiency, this method works in-place, actually changing values in the ndarray. Although it works in place, for convenience
it also returns the SnpData.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>standardizer</strong> (<a class="reference internal" href="#pysnptools.standardizer.Standardizer" title="pysnptools.standardizer.Standardizer"><code class="xref py py-class docutils literal notranslate"><span class="pre">Standardizer</span></code></a>) – optional – Specify standardization to be applied. 
Any <a class="reference internal" href="#pysnptools.standardizer.Standardizer" title="pysnptools.standardizer.Standardizer"><code class="xref py py-class docutils literal notranslate"><span class="pre">Standardizer</span></code></a> may be used. Some choices include <a class="reference internal" href="#pysnptools.standardizer.Unit" title="pysnptools.standardizer.Unit"><code class="xref py py-class docutils literal notranslate"><span class="pre">Unit</span></code></a> (default, makes values for each SNP have mean zero and
standard deviation 1.0) and <a class="reference internal" href="#pysnptools.standardizer.Beta" title="pysnptools.standardizer.Beta"><code class="xref py py-class docutils literal notranslate"><span class="pre">Beta</span></code></a>.</p></li>
<li><p><strong>block_size</strong> (<em>None</em>) – optional – Deprecated.</p></li>
<li><p><strong>return_trained</strong> (<em>bool</em>) – If true, returns a second value containing a constant <a class="reference internal" href="#pysnptools.standardizer.Standardizer" title="pysnptools.standardizer.Standardizer"><code class="xref py py-class docutils literal notranslate"><span class="pre">Standardizer</span></code></a> trained on this data.</p></li>
<li><p><strong>force_python_only</strong> (<em>bool</em>) – optional – If true, will use pure Python instead of faster C++ libraries.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="#pysnptools.snpreader.SnpData" title="pysnptools.snpreader.SnpData"><code class="xref py py-class docutils literal notranslate"><span class="pre">SnpData</span></code></a> (standardizes in place, but for convenience, returns ‘self’)</p>
</dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.snpreader</span> <span class="k">import</span> <span class="n">Bed</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.util</span> <span class="k">import</span> <span class="n">example_file</span> <span class="c1"># Download and return local file name</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bed_file</span> <span class="o">=</span> <span class="n">example_file</span><span class="p">(</span><span class="s2">&quot;tests/datasets/all_chr.maf0.001.N300.*&quot;</span><span class="p">,</span><span class="s2">&quot;*.bed&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snp_on_disk</span> <span class="o">=</span> <span class="n">Bed</span><span class="p">(</span><span class="n">bed_file</span><span class="p">,</span><span class="n">count_A1</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="c1"># Specify some data on disk in Bed format</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snpdata1</span> <span class="o">=</span> <span class="n">snp_on_disk</span><span class="o">.</span><span class="n">read</span><span class="p">()</span> <span class="c1"># read all SNP values into memory</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">snpdata1</span><span class="p">)</span> <span class="c1"># Prints the specification for this SnpData</span>
<span class="go">SnpData(Bed(...tests/datasets/all_chr.maf0.001.N300.bed&#39;,count_A1=False))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">snpdata1</span><span class="o">.</span><span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="go">2.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snpdata1</span><span class="o">.</span><span class="n">standardize</span><span class="p">()</span> <span class="c1"># standardize changes the values in snpdata1.val and changes the specification.</span>
<span class="go">SnpData(Bed(...tests/datasets/all_chr.maf0.001.N300.bed&#39;,count_A1=False),Unit())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0:.6f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">snpdata1</span><span class="o">.</span><span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]))</span>
<span class="go">0.229416</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snpdata2</span> <span class="o">=</span> <span class="n">snp_on_disk</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">standardize</span><span class="p">()</span> <span class="c1"># Read and standardize in one expression with only one ndarray allocated.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0:.6f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">snpdata2</span><span class="o">.</span><span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]))</span>
<span class="go">0.229416</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="pysnptools.snpreader.SnpData.train_standardizer">
<code class="sig-name descname">train_standardizer</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">apply_in_place</span></em>, <em class="sig-param"><span class="n">standardizer</span><span class="o">=</span><span class="default_value">Unit()</span></em>, <em class="sig-param"><span class="n">force_python_only</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.snpreader.SnpData.train_standardizer" title="Permalink to this definition">¶</a></dt>
<dd><div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 0.2.23: </span>Use <a class="reference internal" href="#pysnptools.snpreader.SnpData.standardize" title="pysnptools.snpreader.SnpData.standardize"><code class="xref py py-meth docutils literal notranslate"><span class="pre">standardize()</span></code></a> with return_trained=True instead.</p>
</div>
</dd></dl>

<dl class="py method">
<dt id="pysnptools.snpreader.SnpData.val">
<em class="property">property </em><code class="sig-name descname">val</code><a class="headerlink" href="#pysnptools.snpreader.SnpData.val" title="Permalink to this definition">¶</a></dt>
<dd><p>The 2D NumPy array of floats that represents the values of the SNPs.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.snpreader</span> <span class="k">import</span> <span class="n">Bed</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.util</span> <span class="k">import</span> <span class="n">example_file</span> <span class="c1"># Download and return local file name</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bed_file</span> <span class="o">=</span> <span class="n">example_file</span><span class="p">(</span><span class="s2">&quot;tests/datasets/all_chr.maf0.001.N300.*&quot;</span><span class="p">,</span><span class="s2">&quot;*.bed&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snpdata</span> <span class="o">=</span> <span class="n">Bed</span><span class="p">(</span><span class="n">bed_file</span><span class="p">,</span><span class="n">count_A1</span><span class="o">=</span><span class="kc">False</span><span class="p">)[:</span><span class="mi">5</span><span class="p">,:]</span><span class="o">.</span><span class="n">read</span><span class="p">()</span> <span class="c1">#read data for first 5 iids</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">snpdata</span><span class="o">.</span><span class="n">val</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">100</span><span class="p">])</span> <span class="c1">#print one of the SNP values</span>
<span class="go">2.0</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="snpreader-pheno">
<h3><code class="xref py py-class docutils literal notranslate"><span class="pre">snpreader.Pheno</span></code><a class="headerlink" href="#snpreader-pheno" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt id="pysnptools.snpreader.Pheno">
<em class="property">class </em><code class="sig-prename descclassname">pysnptools.snpreader.</code><code class="sig-name descname">Pheno</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">input</span></em>, <em class="sig-param"><span class="n">iid_if_none</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">missing</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.snpreader.Pheno" title="Permalink to this definition">¶</a></dt>
<dd><p>A <a class="reference internal" href="#pysnptools.snpreader.SnpReader" title="pysnptools.snpreader.SnpReader"><code class="xref py py-class docutils literal notranslate"><span class="pre">SnpReader</span></code></a> for reading “alternative” phenotype files from disk.</p>
<p>See <a class="reference internal" href="#pysnptools.snpreader.SnpReader" title="pysnptools.snpreader.SnpReader"><code class="xref py py-class docutils literal notranslate"><span class="pre">SnpReader</span></code></a> for general examples of using SnpReaders.</p>
<p>This text format is described in <a class="reference external" href="http://zzz.bwh.harvard.edu/plink/data.shtml#pheno">http://zzz.bwh.harvard.edu/plink/data.shtml#pheno</a> and looks like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">FID</span>    <span class="n">IID</span>      <span class="n">qt1</span>   <span class="n">bmi</span>    <span class="n">site</span>  
<span class="n">F1</span>     <span class="mi">1110</span>     <span class="mf">2.3</span>   <span class="mf">22.22</span>  <span class="mi">2</span>     
<span class="n">F2</span>     <span class="mi">2202</span>     <span class="mf">34.12</span> <span class="mf">18.23</span>  <span class="mi">1</span>     
<span class="o">...</span>
</pre></div>
</div>
<p>where the heading row is optional.</p>
<dl>
<dt><strong>Constructor:</strong></dt><dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input</strong> (<em>string</em>) – The phenotype file to read.</p></li>
<li><p><strong>iid_if_none</strong> (<em>None</em> or array of strings) – An <a class="reference internal" href="#pysnptools.snpreader.SnpReader.iid" title="pysnptools.snpreader.SnpReader.iid"><code class="xref py py-attr docutils literal notranslate"><span class="pre">SnpReader.iid</span></code></a> to use if the file is empty.</p></li>
<li><p><strong>missing</strong> (<em>None</em> or string) – The value in the file that represents missing data.</p></li>
</ul>
</dd>
</dl>
<p>For backwards compatibility with older code, <strong>input</strong> can be a dictionary (instead of a filename) with these fields:</p>
<ul class="simple">
<li><p>‘header’ : [1] array phenotype name,</p></li>
<li><p>‘vals’   : [N*1] array of phenotype data,</p></li>
<li><p>‘iid’    : [N*2] array of family IDs and case IDs</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">print_function</span> <span class="c1">#Python 2 &amp; 3 compatibility</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.snpreader</span> <span class="k">import</span> <span class="n">Pheno</span><span class="p">,</span> <span class="n">Bed</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.util</span> <span class="k">import</span> <span class="n">example_file</span> <span class="c1"># Download and return local file name</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pheno_file</span> <span class="o">=</span> <span class="n">example_file</span><span class="p">(</span><span class="s1">&#39;pysnptools/examples/toydata.phe&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data_on_disk</span> <span class="o">=</span> <span class="n">Pheno</span><span class="p">(</span><span class="n">pheno_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">((</span><span class="n">data_on_disk</span><span class="o">.</span><span class="n">iid_count</span><span class="p">,</span> <span class="n">data_on_disk</span><span class="o">.</span><span class="n">sid_count</span><span class="p">))</span>
<span class="go">(500, 1)</span>
</pre></div>
</div>
</dd>
</dl>
<p><strong>Methods beyond</strong> <a class="reference internal" href="#pysnptools.snpreader.SnpReader" title="pysnptools.snpreader.SnpReader"><code class="xref py py-class docutils literal notranslate"><span class="pre">SnpReader</span></code></a></p>
<dl class="py method">
<dt id="pysnptools.snpreader.Pheno.write">
<em class="property">static </em><code class="sig-name descname">write</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span></em>, <em class="sig-param"><span class="n">snpdata</span></em>, <em class="sig-param"><span class="n">missing</span><span class="o">=</span><span class="default_value">'NaN'</span></em>, <em class="sig-param"><span class="n">sep</span><span class="o">=</span><span class="default_value">'\t'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.snpreader.Pheno.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes a <a class="reference internal" href="#pysnptools.snpreader.SnpData" title="pysnptools.snpreader.SnpData"><code class="xref py py-class docutils literal notranslate"><span class="pre">SnpData</span></code></a> to Pheno format and returns the <a class="reference internal" href="#pysnptools.snpreader.Pheno" title="pysnptools.snpreader.Pheno"><code class="xref py py-class docutils literal notranslate"><span class="pre">Pheno</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>string</em>) – the name of the file to create</p></li>
<li><p><strong>missing</strong> (<em>string</em>) – value to threat as missing (default ‘NaN’)</p></li>
<li><p><strong>sep</strong> (<em>string</em>) – the separator (default ‘    ‘)</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="#pysnptools.snpreader.Pheno" title="pysnptools.snpreader.Pheno"><code class="xref py py-class docutils literal notranslate"><span class="pre">Pheno</span></code></a></p>
</dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.snpreader</span> <span class="k">import</span> <span class="n">Pheno</span><span class="p">,</span> <span class="n">Bed</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pysnptools.util</span> <span class="k">as</span> <span class="nn">pstutil</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.util</span> <span class="k">import</span> <span class="n">example_file</span> <span class="c1"># Download and return local file name</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bed_file</span> <span class="o">=</span> <span class="n">example_file</span><span class="p">(</span><span class="s2">&quot;pysnptools/examples/toydata.5chrom.*&quot;</span><span class="p">,</span><span class="s2">&quot;*.bed&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snpdata</span> <span class="o">=</span> <span class="n">Bed</span><span class="p">(</span><span class="n">bed_file</span><span class="p">,</span><span class="n">count_A1</span><span class="o">=</span><span class="kc">False</span><span class="p">)[:,:</span><span class="mi">10</span><span class="p">]</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>  <span class="c1"># Read first 10 snps from Bed format</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pstutil</span><span class="o">.</span><span class="n">create_directory_if_necessary</span><span class="p">(</span><span class="s2">&quot;tempdir/toydata10.phe&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Pheno</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;tempdir/toydata10.txt&quot;</span><span class="p">,</span><span class="n">snpdata</span><span class="p">)</span>       <span class="c1"># Write data in Pheno format</span>
<span class="go">Pheno(&#39;tempdir/toydata10.txt&#39;)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="snpreader-ped">
<h3><code class="xref py py-class docutils literal notranslate"><span class="pre">snpreader.Ped</span></code><a class="headerlink" href="#snpreader-ped" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt id="pysnptools.snpreader.Ped">
<em class="property">class </em><code class="sig-prename descclassname">pysnptools.snpreader.</code><code class="sig-name descname">Ped</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span></em>, <em class="sig-param"><span class="n">missing</span><span class="o">=</span><span class="default_value">'0'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.snpreader.Ped" title="Permalink to this definition">¶</a></dt>
<dd><p>A <a class="reference internal" href="#pysnptools.snpreader.SnpReader" title="pysnptools.snpreader.SnpReader"><code class="xref py py-class docutils literal notranslate"><span class="pre">SnpReader</span></code></a> for reading Ped-formated (and the related Map-formated) files from disk.</p>
<p>See <a class="reference internal" href="#pysnptools.snpreader.SnpReader" title="pysnptools.snpreader.SnpReader"><code class="xref py py-class docutils literal notranslate"><span class="pre">SnpReader</span></code></a> for general examples of using SnpReaders.</p>
<p>This format is described in <a class="reference external" href="http://zzz.bwh.harvard.edu/plink/data.shtml#ped">http://zzz.bwh.harvard.edu/plink/data.shtml#ped</a> and looks like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">FAM001</span>  <span class="mi">1</span>  <span class="mi">0</span> <span class="mi">0</span>  <span class="mi">1</span>  <span class="mi">2</span>  <span class="n">A</span> <span class="n">A</span>  <span class="n">G</span> <span class="n">G</span>  <span class="n">A</span> <span class="n">C</span> 
<span class="n">FAM001</span>  <span class="mi">2</span>  <span class="mi">0</span> <span class="mi">0</span>  <span class="mi">1</span>  <span class="mi">2</span>  <span class="n">A</span> <span class="n">A</span>  <span class="n">A</span> <span class="n">G</span>  <span class="mi">0</span> <span class="mi">0</span> 
<span class="o">...</span>
</pre></div>
</div>
<p>the direction of the encoding from allele pair to 0,1,2 is arbitrary. That is, if the alleles are “A” and “G”, then “G G” could be 0 and “A A” could be 2 or visa versa. The pair “A G” will always be 1.</p>
<dl>
<dt><strong>Constructor:</strong></dt><dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>string</em>) – The Ped file to read.</p></li>
<li><p><strong>missing</strong> (<em>string</em>) – The value in the file that represents missing data.</p></li>
</ul>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">print_function</span> <span class="c1">#Python 2 &amp; 3 compatibility</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.snpreader</span> <span class="k">import</span> <span class="n">Ped</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.util</span> <span class="k">import</span> <span class="n">example_file</span> <span class="c1"># Download and return local file name</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ped_file</span> <span class="o">=</span> <span class="n">example_file</span><span class="p">(</span><span class="s1">&#39;pysnptools/examples/toydata.ped&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data_on_disk</span> <span class="o">=</span> <span class="n">Ped</span><span class="p">(</span><span class="n">ped_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">((</span><span class="n">data_on_disk</span><span class="o">.</span><span class="n">iid_count</span><span class="p">,</span> <span class="n">data_on_disk</span><span class="o">.</span><span class="n">sid_count</span><span class="p">))</span>
<span class="go">(500, 10000)</span>
</pre></div>
</div>
</dd>
</dl>
<p><strong>Methods beyond</strong> <a class="reference internal" href="#pysnptools.snpreader.SnpReader" title="pysnptools.snpreader.SnpReader"><code class="xref py py-class docutils literal notranslate"><span class="pre">SnpReader</span></code></a></p>
<dl class="py method">
<dt id="pysnptools.snpreader.Ped.write">
<em class="property">static </em><code class="sig-name descname">write</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span></em>, <em class="sig-param"><span class="n">snpdata</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.snpreader.Ped.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes a <a class="reference internal" href="#pysnptools.snpreader.SnpData" title="pysnptools.snpreader.SnpData"><code class="xref py py-class docutils literal notranslate"><span class="pre">SnpData</span></code></a> to Ped format. The values must be 0,1,2. The direction of the encoding to allele pairs is arbitrary. This means
that if a SnpData is written in Ped format and then read back, then 0’s may become 2’s and 2’s may become 0’s. (1’s will stay 1’s).
Returns the <a class="reference internal" href="#pysnptools.snpreader.Ped" title="pysnptools.snpreader.Ped"><code class="xref py py-class docutils literal notranslate"><span class="pre">Ped</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>string</em>) – the name of the file to create</p></li>
<li><p><strong>snpdata</strong> (<a class="reference internal" href="#pysnptools.snpreader.SnpData" title="pysnptools.snpreader.SnpData"><code class="xref py py-class docutils literal notranslate"><span class="pre">SnpData</span></code></a>) – The in-memory data that should be written to disk.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="#pysnptools.snpreader.Ped" title="pysnptools.snpreader.Ped"><code class="xref py py-class docutils literal notranslate"><span class="pre">Ped</span></code></a></p>
</dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.snpreader</span> <span class="k">import</span> <span class="n">Ped</span><span class="p">,</span> <span class="n">Bed</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pysnptools.util</span> <span class="k">as</span> <span class="nn">pstutil</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.util</span> <span class="k">import</span> <span class="n">example_file</span> <span class="c1"># Download and return local file name</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bed_file</span> <span class="o">=</span> <span class="n">example_file</span><span class="p">(</span><span class="s2">&quot;pysnptools/examples/toydata.5chrom.*&quot;</span><span class="p">,</span><span class="s2">&quot;*.bed&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snpdata</span> <span class="o">=</span> <span class="n">Bed</span><span class="p">(</span><span class="n">bed_file</span><span class="p">,</span><span class="n">count_A1</span><span class="o">=</span><span class="kc">False</span><span class="p">)[:,:</span><span class="mi">10</span><span class="p">]</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>  <span class="c1"># Read first 10 snps from Bed format</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pstutil</span><span class="o">.</span><span class="n">create_directory_if_necessary</span><span class="p">(</span><span class="s2">&quot;tempdir/toydata10.ped&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Ped</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;tempdir/toydata10.ped&quot;</span><span class="p">,</span><span class="n">snpdata</span><span class="p">)</span>            <span class="c1"># Write data in Ped format</span>
<span class="go">Ped(&#39;tempdir/toydata10.ped&#39;)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="snpreader-dat">
<h3><code class="xref py py-class docutils literal notranslate"><span class="pre">snpreader.Dat</span></code><a class="headerlink" href="#snpreader-dat" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt id="pysnptools.snpreader.Dat">
<em class="property">class </em><code class="sig-prename descclassname">pysnptools.snpreader.</code><code class="sig-name descname">Dat</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.snpreader.Dat" title="Permalink to this definition">¶</a></dt>
<dd><p>A <a class="reference internal" href="#pysnptools.snpreader.SnpReader" title="pysnptools.snpreader.SnpReader"><code class="xref py py-class docutils literal notranslate"><span class="pre">SnpReader</span></code></a> for reading Dat/Fam/Map-formated files from disk.</p>
<p>See <a class="reference internal" href="#pysnptools.snpreader.SnpReader" title="pysnptools.snpreader.SnpReader"><code class="xref py py-class docutils literal notranslate"><span class="pre">SnpReader</span></code></a> for general examples of using SnpReaders.</p>
<p>This is a text format that can store any numeric values. (In contrast, Bed and Ped can only store 0,1,2, and missing). Its Dat files look like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">null_0</span>          <span class="n">j</span>       <span class="n">n</span>       <span class="mf">0.333</span>   <span class="mi">1</span>       <span class="mi">2</span>
<span class="n">null_100</span>        <span class="n">j</span>       <span class="n">n</span>       <span class="mi">2</span>       <span class="mi">1</span>       <span class="mi">1</span>
<span class="n">null_200</span>        <span class="n">j</span>       <span class="n">n</span>       <span class="mi">0</span>       <span class="n">nan</span>     <span class="mi">1</span>
<span class="o">...</span>
</pre></div>
</div>
<p>Its Map and Fam files are described in <a class="reference external" href="http://pngu.mgh.harvard.edu/~purcell/plink/data.shtml">http://pngu.mgh.harvard.edu/~purcell/plink/data.shtml</a>.</p>
<dl>
<dt><strong>Constructor:</strong></dt><dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>string</em>) – The Dat file to read.</p></li>
</ul>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">print_function</span> <span class="c1">#Python 2 &amp; 3 compatibility</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.snpreader</span> <span class="k">import</span> <span class="n">Dat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.util</span> <span class="k">import</span> <span class="n">example_file</span> <span class="c1"># Download and return local file name</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dat_file</span> <span class="o">=</span> <span class="n">example_file</span><span class="p">(</span><span class="s2">&quot;pysnptools/examples/toydata.*&quot;</span><span class="p">,</span><span class="s2">&quot;*.dat&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data_on_disk</span> <span class="o">=</span> <span class="n">Dat</span><span class="p">(</span><span class="n">dat_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">((</span><span class="n">data_on_disk</span><span class="o">.</span><span class="n">iid_count</span><span class="p">,</span> <span class="n">data_on_disk</span><span class="o">.</span><span class="n">sid_count</span><span class="p">))</span>
<span class="go">(500, 10000)</span>
</pre></div>
</div>
</dd>
</dl>
<p><strong>Methods beyond</strong> <a class="reference internal" href="#pysnptools.snpreader.SnpReader" title="pysnptools.snpreader.SnpReader"><code class="xref py py-class docutils literal notranslate"><span class="pre">SnpReader</span></code></a></p>
<dl class="py method">
<dt id="pysnptools.snpreader.Dat.write">
<em class="property">static </em><code class="sig-name descname">write</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span></em>, <em class="sig-param"><span class="n">snpdata</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.snpreader.Dat.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes a <a class="reference internal" href="#pysnptools.snpreader.SnpData" title="pysnptools.snpreader.SnpData"><code class="xref py py-class docutils literal notranslate"><span class="pre">SnpData</span></code></a> to dat/fam/map format and returns the <a class="reference internal" href="#pysnptools.snpreader.Dat" title="pysnptools.snpreader.Dat"><code class="xref py py-class docutils literal notranslate"><span class="pre">Dat</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>string</em>) – the name of the file to create</p></li>
<li><p><strong>snpdata</strong> (<a class="reference internal" href="#pysnptools.snpreader.SnpData" title="pysnptools.snpreader.SnpData"><code class="xref py py-class docutils literal notranslate"><span class="pre">SnpData</span></code></a>) – The in-memory data that should be written to disk.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="#pysnptools.snpreader.Dat" title="pysnptools.snpreader.Dat"><code class="xref py py-class docutils literal notranslate"><span class="pre">Dat</span></code></a></p>
</dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.snpreader</span> <span class="k">import</span> <span class="n">Dat</span><span class="p">,</span> <span class="n">Bed</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pysnptools.util</span> <span class="k">as</span> <span class="nn">pstutil</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.util</span> <span class="k">import</span> <span class="n">example_file</span> <span class="c1"># Download and return local file name</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bed_file</span> <span class="o">=</span> <span class="n">example_file</span><span class="p">(</span><span class="s2">&quot;pysnptools/examples/toydata.5chrom.*&quot;</span><span class="p">,</span><span class="s2">&quot;*.bed&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snpdata</span> <span class="o">=</span> <span class="n">Bed</span><span class="p">(</span><span class="n">bed_file</span><span class="p">,</span><span class="n">count_A1</span><span class="o">=</span><span class="kc">False</span><span class="p">)[:,:</span><span class="mi">10</span><span class="p">]</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>  <span class="c1"># Read first 10 snps from Bed format</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pstutil</span><span class="o">.</span><span class="n">create_directory_if_necessary</span><span class="p">(</span><span class="s2">&quot;tempdir/toydata10.dat&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Dat</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;tempdir/toydata10.dat&quot;</span><span class="p">,</span><span class="n">snpdata</span><span class="p">)</span>              <span class="c1"># Write data in dat/fam/map format</span>
<span class="go">Dat(&#39;tempdir/toydata10.dat&#39;)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="snpreader-dense">
<h3><code class="xref py py-class docutils literal notranslate"><span class="pre">snpreader.Dense</span></code><a class="headerlink" href="#snpreader-dense" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt id="pysnptools.snpreader.Dense">
<em class="property">class </em><code class="sig-prename descclassname">pysnptools.snpreader.</code><code class="sig-name descname">Dense</code><span class="sig-paren">(</span><em class="sig-param">filename</em>, <em class="sig-param">extract_iid_function=&lt;function zero_family&gt;</em>, <em class="sig-param">extract_sid_pos_function=&lt;function zero_pos&gt;</em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.snpreader.Dense" title="Permalink to this definition">¶</a></dt>
<dd><p>A <a class="reference internal" href="#pysnptools.snpreader.SnpReader" title="pysnptools.snpreader.SnpReader"><code class="xref py py-class docutils literal notranslate"><span class="pre">SnpReader</span></code></a> for reading *.dense.txt (0,1,2 text files) from disk.</p>
<p>See <a class="reference internal" href="#pysnptools.snpreader.SnpReader" title="pysnptools.snpreader.SnpReader"><code class="xref py py-class docutils literal notranslate"><span class="pre">SnpReader</span></code></a> for general examples of using SnpReaders.</p>
<p>This format looks like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>var     4006    9570    22899   37676   41236   41978   55159   66828...
1-10004-rs12354060      22222222...
1-707348-rs12184279     222222?2...
1-724325-rs12564807     00000000...
...
</pre></div>
</div>
<p>where rows are sids and columns are iids.</p>
<dl>
<dt><strong>Constructor:</strong></dt><dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>string</em>) – The Dense file to read.</p></li>
<li><p><strong>extract_iid_function</strong> (<em>string</em>) – A function that breaks the row id from the file into a family id and an case id. Defaults to
setting the family id to 0 and using the whole row id as the iid.</p></li>
<li><p><strong>extract_sid_pos_function</strong> (<em>string</em>) – A function that breaks the column id from the file into (chromosome, sid, genetic distance, basepair distance).
Defaults to setting the <a class="reference internal" href="#pysnptools.snpreader.SnpReader.pos" title="pysnptools.snpreader.SnpReader.pos"><code class="xref py py-attr docutils literal notranslate"><span class="pre">SnpReader.pos</span></code></a> information to 0 and using the whole column id as the sid.</p></li>
</ul>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">print_function</span> <span class="c1">#Python 2 &amp; 3 compatibility</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.snpreader</span> <span class="k">import</span> <span class="n">Dense</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.util</span> <span class="k">import</span> <span class="n">example_file</span> <span class="c1"># Download and return local file name</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dense_file</span> <span class="o">=</span> <span class="n">example_file</span><span class="p">(</span><span class="s2">&quot;pysnptools/examples/toydata100.dense.txt&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data_on_disk</span> <span class="o">=</span> <span class="n">Dense</span><span class="p">(</span><span class="n">dense_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">((</span><span class="n">data_on_disk</span><span class="o">.</span><span class="n">iid_count</span><span class="p">,</span> <span class="n">data_on_disk</span><span class="o">.</span><span class="n">sid_count</span><span class="p">))</span>
<span class="go">(500, 100)</span>
</pre></div>
</div>
</dd>
</dl>
<p><strong>Methods beyond</strong> <a class="reference internal" href="#pysnptools.snpreader.SnpReader" title="pysnptools.snpreader.SnpReader"><code class="xref py py-class docutils literal notranslate"><span class="pre">SnpReader</span></code></a></p>
<dl class="py method">
<dt id="pysnptools.snpreader.Dense.write">
<em class="property">static </em><code class="sig-name descname">write</code><span class="sig-paren">(</span><em class="sig-param">filename</em>, <em class="sig-param">snpdata</em>, <em class="sig-param">join_iid_function=&lt;function just_case&gt;</em>, <em class="sig-param">join_sid_pos_function=&lt;function just_sid&gt;</em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.snpreader.Dense.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes a <a class="reference internal" href="#pysnptools.snpreader.SnpData" title="pysnptools.snpreader.SnpData"><code class="xref py py-class docutils literal notranslate"><span class="pre">SnpData</span></code></a> to Dense format. The values must be 0,1,2 (or missing). Returns a <a class="reference internal" href="#pysnptools.snpreader.Dense" title="pysnptools.snpreader.Dense"><code class="xref py py-class docutils literal notranslate"><span class="pre">Dense</span></code></a> with the default extractors.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>string</em>) – the name of the file to create</p></li>
<li><p><strong>snpdata</strong> (<a class="reference internal" href="#pysnptools.snpreader.SnpData" title="pysnptools.snpreader.SnpData"><code class="xref py py-class docutils literal notranslate"><span class="pre">SnpData</span></code></a>) – The in-memory data that should be written to disk.</p></li>
<li><p><strong>join_iid_function</strong> (<em>a function</em>) – function to turn a family id and case id into a file id for columns.
Defaults ignoring the family id and using the case id as the column id.</p></li>
<li><p><strong>join_sid_pos_function</strong> (<em>a function</em>) – function to turn a sid and pos data into a file id for rows.
Defaults ignoring the <a class="reference internal" href="#pysnptools.snpreader.SnpReader.pos" title="pysnptools.snpreader.SnpReader.pos"><code class="xref py py-attr docutils literal notranslate"><span class="pre">SnpReader.pos</span></code></a> information and using the sid id as the row id.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="#pysnptools.snpreader.Dense" title="pysnptools.snpreader.Dense"><code class="xref py py-class docutils literal notranslate"><span class="pre">Dense</span></code></a></p>
</dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.snpreader</span> <span class="k">import</span> <span class="n">Dense</span><span class="p">,</span> <span class="n">Bed</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pysnptools.util</span> <span class="k">as</span> <span class="nn">pstutil</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.util</span> <span class="k">import</span> <span class="n">example_file</span> <span class="c1"># Download and return local file name</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bed_file</span> <span class="o">=</span> <span class="n">example_file</span><span class="p">(</span><span class="s2">&quot;pysnptools/examples/toydata.5chrom.*&quot;</span><span class="p">,</span><span class="s2">&quot;*.bed&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snpdata</span> <span class="o">=</span> <span class="n">Bed</span><span class="p">(</span><span class="n">bed_file</span><span class="p">,</span><span class="n">count_A1</span><span class="o">=</span><span class="kc">False</span><span class="p">)[:,:</span><span class="mi">10</span><span class="p">]</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>  <span class="c1"># Read first 10 snps from Bed format</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pstutil</span><span class="o">.</span><span class="n">create_directory_if_necessary</span><span class="p">(</span><span class="s2">&quot;tempdir/toydata10.dense.txt&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Dense</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;tempdir/toydata10.dense.txt&quot;</span><span class="p">,</span><span class="n">snpdata</span><span class="p">)</span>        <span class="c1"># Write data in Dense format</span>
<span class="go">Dense(&#39;tempdir/toydata10.dense.txt&#39;)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="snpreader-snphdf5">
<h3><code class="xref py py-class docutils literal notranslate"><span class="pre">snpreader.SnpHdf5</span></code><a class="headerlink" href="#snpreader-snphdf5" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt id="pysnptools.snpreader.SnpHdf5">
<em class="property">class </em><code class="sig-prename descclassname">pysnptools.snpreader.</code><code class="sig-name descname">SnpHdf5</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.snpreader.SnpHdf5" title="Permalink to this definition">¶</a></dt>
<dd><p>A <a class="reference internal" href="#pysnptools.snpreader.SnpReader" title="pysnptools.snpreader.SnpReader"><code class="xref py py-class docutils literal notranslate"><span class="pre">SnpReader</span></code></a> for reading *.snp.hdf5 files from disk.</p>
<p>See <a class="reference internal" href="#pysnptools.snpreader.SnpReader" title="pysnptools.snpreader.SnpReader"><code class="xref py py-class docutils literal notranslate"><span class="pre">SnpReader</span></code></a> for general examples of using SnpReaders.</p>
<p>The general HDF5 format is described <a class="reference external" href="http://www.hdfgroup.org/HDF5/">here</a>. The SnpHdf5 format stores
val, iid, sid, and pos information in Hdf5 format.</p>
<dl>
<dt><strong>Constructor:</strong></dt><dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>string</em>) – The SnpHdf5 file to read.</p></li>
</ul>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">print_function</span> <span class="c1">#Python 2 &amp; 3 compatibility</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.snpreader</span> <span class="k">import</span> <span class="n">SnpHdf5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.util</span> <span class="k">import</span> <span class="n">example_file</span> <span class="c1"># Download and return local file name</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hd5f_file</span> <span class="o">=</span> <span class="n">example_file</span><span class="p">(</span><span class="s2">&quot;pysnptools/examples/toydata.snpmajor.snp.hdf5&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data_on_disk</span> <span class="o">=</span> <span class="n">SnpHdf5</span><span class="p">(</span><span class="n">hd5f_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">((</span><span class="n">data_on_disk</span><span class="o">.</span><span class="n">iid_count</span><span class="p">,</span> <span class="n">data_on_disk</span><span class="o">.</span><span class="n">sid_count</span><span class="p">))</span>
<span class="go">(500, 10000)</span>
</pre></div>
</div>
</dd>
</dl>
<p><strong>Methods beyond</strong> <a class="reference internal" href="#pysnptools.snpreader.SnpReader" title="pysnptools.snpreader.SnpReader"><code class="xref py py-class docutils literal notranslate"><span class="pre">SnpReader</span></code></a></p>
<dl class="py method">
<dt id="pysnptools.snpreader.SnpHdf5.write">
<em class="property">static </em><code class="sig-name descname">write</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span></em>, <em class="sig-param"><span class="n">snpdata</span></em>, <em class="sig-param"><span class="n">hdf5_dtype</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">sid_major</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.snpreader.SnpHdf5.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes a <a class="reference internal" href="#pysnptools.snpreader.SnpData" title="pysnptools.snpreader.SnpData"><code class="xref py py-class docutils literal notranslate"><span class="pre">SnpData</span></code></a> to SnpHdf5 format and return a the <a class="reference internal" href="#pysnptools.snpreader.SnpHdf5" title="pysnptools.snpreader.SnpHdf5"><code class="xref py py-class docutils literal notranslate"><span class="pre">SnpHdf5</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>string</em>) – the name of the file to create</p></li>
<li><p><strong>snpdata</strong> (<a class="reference internal" href="#pysnptools.snpreader.SnpData" title="pysnptools.snpreader.SnpData"><code class="xref py py-class docutils literal notranslate"><span class="pre">SnpData</span></code></a>) – The in-memory data that should be written to disk.</p></li>
<li><p><strong>hdf5_dtype</strong> (<em>string</em>) – None (use the .val’s dtype) or a Hdf5 dtype, e.g. ‘f8’,’f4’,etc.</p></li>
<li><p><strong>sid_major</strong> (<em>bool</em>) – Tells if vals should be stored on disk in sid_major (default) or iid_major format.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="#pysnptools.snpreader.SnpHdf5" title="pysnptools.snpreader.SnpHdf5"><code class="xref py py-class docutils literal notranslate"><span class="pre">SnpHdf5</span></code></a></p>
</dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.snpreader</span> <span class="k">import</span> <span class="n">SnpHdf5</span><span class="p">,</span> <span class="n">Bed</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pysnptools.util</span> <span class="k">as</span> <span class="nn">pstutil</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.util</span> <span class="k">import</span> <span class="n">example_file</span> <span class="c1"># Download and return local file name</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bedfile</span> <span class="o">=</span> <span class="n">example_file</span><span class="p">(</span><span class="s2">&quot;pysnptools/examples/toydata.5chrom.*&quot;</span><span class="p">,</span><span class="s2">&quot;*.bed&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snpdata</span> <span class="o">=</span> <span class="n">Bed</span><span class="p">(</span><span class="n">bedfile</span><span class="p">,</span><span class="n">count_A1</span><span class="o">=</span><span class="kc">False</span><span class="p">)[:,:</span><span class="mi">10</span><span class="p">]</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>     <span class="c1"># Read first 10 snps from Bed format</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pstutil</span><span class="o">.</span><span class="n">create_directory_if_necessary</span><span class="p">(</span><span class="s2">&quot;tempdir/toydata10.snp.hdf5&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">SnpHdf5</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;tempdir/toydata10.snp.hdf5&quot;</span><span class="p">,</span><span class="n">snpdata</span><span class="p">)</span>        <span class="c1"># Write data in SnpHdf5 format</span>
<span class="go">SnpHdf5(&#39;tempdir/toydata10.snp.hdf5&#39;)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="snpreader-snpnpz">
<h3><code class="xref py py-class docutils literal notranslate"><span class="pre">snpreader.SnpNpz</span></code><a class="headerlink" href="#snpreader-snpnpz" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt id="pysnptools.snpreader.SnpNpz">
<em class="property">class </em><code class="sig-prename descclassname">pysnptools.snpreader.</code><code class="sig-name descname">SnpNpz</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.snpreader.SnpNpz" title="Permalink to this definition">¶</a></dt>
<dd><p>A <a class="reference internal" href="#pysnptools.snpreader.SnpReader" title="pysnptools.snpreader.SnpReader"><code class="xref py py-class docutils literal notranslate"><span class="pre">SnpReader</span></code></a> for reading *.snp.npz files from disk.</p>
<p>See <a class="reference internal" href="#pysnptools.snpreader.SnpReader" title="pysnptools.snpreader.SnpReader"><code class="xref py py-class docutils literal notranslate"><span class="pre">SnpReader</span></code></a> for general examples of using SnpReaders.</p>
<p>The general NPZ format is described in <a class="reference external" href="http://docs.scipy.org/doc/numpy/reference/generated/numpy.savez.html">http://docs.scipy.org/doc/numpy/reference/generated/numpy.savez.html</a>. The SnpNpz format stores
val, iid, sid, and pos information in NPZ format.</p>
<dl>
<dt><strong>Constructor:</strong></dt><dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>string</em>) – The SnpNpz file to read.</p></li>
</ul>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">print_function</span> <span class="c1">#Python 2 &amp; 3 compatibility</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.snpreader</span> <span class="k">import</span> <span class="n">SnpNpz</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.util</span> <span class="k">import</span> <span class="n">example_file</span> <span class="c1"># Download and return local file name</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">npz_file</span> <span class="o">=</span> <span class="n">example_file</span><span class="p">(</span><span class="s1">&#39;pysnptools/examples/toydata10.snp.npz&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data_on_disk</span> <span class="o">=</span> <span class="n">SnpNpz</span><span class="p">(</span><span class="n">npz_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">((</span><span class="n">data_on_disk</span><span class="o">.</span><span class="n">iid_count</span><span class="p">,</span> <span class="n">data_on_disk</span><span class="o">.</span><span class="n">sid_count</span><span class="p">))</span>
<span class="go">(500, 10)</span>
</pre></div>
</div>
</dd>
</dl>
<p><strong>Methods beyond</strong> <a class="reference internal" href="#pysnptools.snpreader.SnpReader" title="pysnptools.snpreader.SnpReader"><code class="xref py py-class docutils literal notranslate"><span class="pre">SnpReader</span></code></a></p>
<dl class="py method">
<dt id="pysnptools.snpreader.SnpNpz.write">
<em class="property">static </em><code class="sig-name descname">write</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span></em>, <em class="sig-param"><span class="n">snpdata</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.snpreader.SnpNpz.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes a <a class="reference internal" href="#pysnptools.snpreader.SnpData" title="pysnptools.snpreader.SnpData"><code class="xref py py-class docutils literal notranslate"><span class="pre">SnpData</span></code></a> to SnpNpz format and returns the <a class="reference internal" href="#pysnptools.snpreader.SnpNpz" title="pysnptools.snpreader.SnpNpz"><code class="xref py py-class docutils literal notranslate"><span class="pre">SnpNpz</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>string</em>) – the name of the file to create</p></li>
<li><p><strong>snpdata</strong> (<a class="reference internal" href="#pysnptools.snpreader.SnpData" title="pysnptools.snpreader.SnpData"><code class="xref py py-class docutils literal notranslate"><span class="pre">SnpData</span></code></a>) – The in-memory data that should be written to disk.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="#pysnptools.snpreader.SnpNpz" title="pysnptools.snpreader.SnpNpz"><code class="xref py py-class docutils literal notranslate"><span class="pre">SnpNpz</span></code></a></p>
</dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.snpreader</span> <span class="k">import</span> <span class="n">SnpNpz</span><span class="p">,</span> <span class="n">Bed</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pysnptools.util</span> <span class="k">as</span> <span class="nn">pstutil</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.util</span> <span class="k">import</span> <span class="n">example_file</span> <span class="c1"># Download and return local file name</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bed_file</span> <span class="o">=</span> <span class="n">example_file</span><span class="p">(</span><span class="s2">&quot;pysnptools/examples/toydata.5chrom.*&quot;</span><span class="p">,</span><span class="s2">&quot;*.bed&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snpdata</span> <span class="o">=</span> <span class="n">Bed</span><span class="p">(</span><span class="n">bed_file</span><span class="p">,</span><span class="n">count_A1</span><span class="o">=</span><span class="kc">False</span><span class="p">)[:,:</span><span class="mi">10</span><span class="p">]</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>     <span class="c1"># Read first 10 snps from Bed format</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pstutil</span><span class="o">.</span><span class="n">create_directory_if_necessary</span><span class="p">(</span><span class="s2">&quot;tempdir/toydata10.snp.npz&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">SnpNpz</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;tempdir/toydata10.snp.npz&quot;</span><span class="p">,</span><span class="n">snpdata</span><span class="p">)</span>          <span class="c1"># Write data in SnpNpz format</span>
<span class="go">SnpNpz(&#39;tempdir/toydata10.snp.npz&#39;)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="snpreader-snpmemmap">
<h3><code class="xref py py-class docutils literal notranslate"><span class="pre">snpreader.SnpMemMap</span></code><a class="headerlink" href="#snpreader-snpmemmap" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt id="pysnptools.snpreader.SnpMemMap">
<em class="property">class </em><code class="sig-prename descclassname">pysnptools.snpreader.</code><code class="sig-name descname">SnpMemMap</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.snpreader.SnpMemMap" title="Permalink to this definition">¶</a></dt>
<dd><p>A <a class="reference internal" href="#pysnptools.snpreader.SnpData" title="pysnptools.snpreader.SnpData"><code class="xref py py-class docutils literal notranslate"><span class="pre">SnpData</span></code></a> that keeps its data in a memory-mapped file. This allows data large than fits in main memory.</p>
<p>See <a class="reference internal" href="#pysnptools.snpreader.SnpData" title="pysnptools.snpreader.SnpData"><code class="xref py py-class docutils literal notranslate"><span class="pre">SnpData</span></code></a> for general examples of using SnpData.</p>
<dl>
<dt><strong>Constructor:</strong></dt><dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>filename</strong> (<em>string</em>) – The <em>*.snp.memmap</em> file to read.</p>
</dd>
</dl>
<p>Also see <a class="reference internal" href="#pysnptools.snpreader.SnpMemMap.empty" title="pysnptools.snpreader.SnpMemMap.empty"><code class="xref py py-meth docutils literal notranslate"><span class="pre">SnpMemMap.empty()</span></code></a> and <a class="reference internal" href="#pysnptools.snpreader.SnpMemMap.write" title="pysnptools.snpreader.SnpMemMap.write"><code class="xref py py-meth docutils literal notranslate"><span class="pre">SnpMemMap.write()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">print_function</span> <span class="c1">#Python 2 &amp; 3 compatibility</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.snpreader</span> <span class="k">import</span> <span class="n">SnpMemMap</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.util</span> <span class="k">import</span> <span class="n">example_file</span> <span class="c1"># Download and return local file name</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mem_map_file</span> <span class="o">=</span> <span class="n">example_file</span><span class="p">(</span><span class="s1">&#39;pysnptools/examples/tiny.snp.memmap&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snp_mem_map</span> <span class="o">=</span> <span class="n">SnpMemMap</span><span class="p">(</span><span class="n">mem_map_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">snp_mem_map</span><span class="o">.</span><span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">snp_mem_map</span><span class="o">.</span><span class="n">iid_count</span><span class="p">,</span> <span class="n">snp_mem_map</span><span class="o">.</span><span class="n">sid_count</span><span class="p">)</span>
<span class="go">2.0 2 3</span>
</pre></div>
</div>
</dd>
</dl>
<p><strong>Methods inherited from</strong> <a class="reference internal" href="#pysnptools.snpreader.SnpData" title="pysnptools.snpreader.SnpData"><code class="xref py py-class docutils literal notranslate"><span class="pre">SnpData</span></code></a></p>
<blockquote>
<div><p><a class="reference internal" href="#pysnptools.snpreader.SnpData.allclose" title="pysnptools.snpreader.SnpData.allclose"><code class="xref py py-meth docutils literal notranslate"><span class="pre">SnpData.allclose()</span></code></a>, <a class="reference internal" href="#pysnptools.snpreader.SnpData.standardize" title="pysnptools.snpreader.SnpData.standardize"><code class="xref py py-meth docutils literal notranslate"><span class="pre">SnpData.standardize()</span></code></a></p>
</div></blockquote>
<p><strong>Methods beyond</strong> <a class="reference internal" href="#pysnptools.snpreader.SnpReader" title="pysnptools.snpreader.SnpReader"><code class="xref py py-class docutils literal notranslate"><span class="pre">SnpReader</span></code></a></p>
<dl class="py method">
<dt id="pysnptools.snpreader.SnpMemMap.empty">
<em class="property">static </em><code class="sig-name descname">empty</code><span class="sig-paren">(</span><em class="sig-param">iid</em>, <em class="sig-param">sid</em>, <em class="sig-param">filename</em>, <em class="sig-param">pos=None</em>, <em class="sig-param">order='F'</em>, <em class="sig-param">dtype=&lt;class 'numpy.float64'&gt;</em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.snpreader.SnpMemMap.empty" title="Permalink to this definition">¶</a></dt>
<dd><p>Create an empty <a class="reference internal" href="#pysnptools.snpreader.SnpMemMap" title="pysnptools.snpreader.SnpMemMap"><code class="xref py py-class docutils literal notranslate"><span class="pre">SnpMemMap</span></code></a> on disk.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>iid</strong> (<em>an array of string pairs</em>) – The <a class="reference internal" href="#pysnptools.snpreader.SnpReader.iid" title="pysnptools.snpreader.SnpReader.iid"><code class="xref py py-attr docutils literal notranslate"><span class="pre">SnpReader.iid</span></code></a> information</p></li>
<li><p><strong>sid</strong> (<em>an array of strings</em>) – The <a class="reference internal" href="#pysnptools.snpreader.SnpReader.sid" title="pysnptools.snpreader.SnpReader.sid"><code class="xref py py-attr docutils literal notranslate"><span class="pre">SnpReader.sid</span></code></a> information</p></li>
<li><p><strong>filename</strong> (<em>string</em>) – name of memory-mapped file to create</p></li>
<li><p><strong>pos</strong> (<em>an array of numeric triples</em>) – optional – The additional <a class="reference internal" href="#pysnptools.snpreader.SnpReader.pos" title="pysnptools.snpreader.SnpReader.pos"><code class="xref py py-attr docutils literal notranslate"><span class="pre">SnpReader.pos</span></code></a> information associated with each sid. Default: None</p></li>
<li><p><strong>order</strong> (<em>string</em><em> or </em><em>None</em>) – {‘F’ (default), ‘C’}, optional – Specify the order of the ndarray.</p></li>
<li><p><strong>dtype</strong> (<em>data-type</em>) – {scipy.float64 (default), scipy.float32}, optional – The data-type for the <a class="reference internal" href="#pysnptools.snpreader.SnpMemMap.val" title="pysnptools.snpreader.SnpMemMap.val"><code class="xref py py-attr docutils literal notranslate"><span class="pre">SnpMemMap.val</span></code></a> ndarray.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="#pysnptools.snpreader.SnpMemMap" title="pysnptools.snpreader.SnpMemMap"><code class="xref py py-class docutils literal notranslate"><span class="pre">SnpMemMap</span></code></a></p>
</dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pysnptools.util</span> <span class="k">as</span> <span class="nn">pstutil</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.snpreader</span> <span class="k">import</span> <span class="n">SnpMemMap</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filename</span> <span class="o">=</span> <span class="s2">&quot;tempdir/tiny.snp.memmap&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pstutil</span><span class="o">.</span><span class="n">create_directory_if_necessary</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snp_mem_map</span> <span class="o">=</span> <span class="n">SnpMemMap</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">iid</span><span class="o">=</span><span class="p">[[</span><span class="s1">&#39;fam0&#39;</span><span class="p">,</span><span class="s1">&#39;iid0&#39;</span><span class="p">],[</span><span class="s1">&#39;fam0&#39;</span><span class="p">,</span><span class="s1">&#39;iid1&#39;</span><span class="p">]],</span> <span class="n">sid</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;snp334&#39;</span><span class="p">,</span><span class="s1">&#39;snp349&#39;</span><span class="p">,</span><span class="s1">&#39;snp921&#39;</span><span class="p">],</span><span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span><span class="n">order</span><span class="o">=</span><span class="s2">&quot;F&quot;</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snp_mem_map</span><span class="o">.</span><span class="n">val</span><span class="p">[:,:]</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">2.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">2.</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snp_mem_map</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="pysnptools.snpreader.SnpMemMap.filename">
<em class="property">property </em><code class="sig-name descname">filename</code><a class="headerlink" href="#pysnptools.snpreader.SnpMemMap.filename" title="Permalink to this definition">¶</a></dt>
<dd><p>The name of the memory-mapped file</p>
</dd></dl>

<dl class="py method">
<dt id="pysnptools.snpreader.SnpMemMap.flush">
<code class="sig-name descname">flush</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.snpreader.SnpMemMap.flush" title="Permalink to this definition">¶</a></dt>
<dd><p>Flush <a class="reference internal" href="#pysnptools.snpreader.SnpMemMap.val" title="pysnptools.snpreader.SnpMemMap.val"><code class="xref py py-attr docutils literal notranslate"><span class="pre">SnpMemMap.val</span></code></a> to disk and close the file. (If values or properties are accessed again, the file will be reopened.)</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pysnptools.util</span> <span class="k">as</span> <span class="nn">pstutil</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.snpreader</span> <span class="k">import</span> <span class="n">SnpMemMap</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filename</span> <span class="o">=</span> <span class="s2">&quot;tempdir/tiny.snp.memmap&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pstutil</span><span class="o">.</span><span class="n">create_directory_if_necessary</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snp_mem_map</span> <span class="o">=</span> <span class="n">SnpMemMap</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">iid</span><span class="o">=</span><span class="p">[[</span><span class="s1">&#39;fam0&#39;</span><span class="p">,</span><span class="s1">&#39;iid0&#39;</span><span class="p">],[</span><span class="s1">&#39;fam0&#39;</span><span class="p">,</span><span class="s1">&#39;iid1&#39;</span><span class="p">]],</span> <span class="n">sid</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;snp334&#39;</span><span class="p">,</span><span class="s1">&#39;snp349&#39;</span><span class="p">,</span><span class="s1">&#39;snp921&#39;</span><span class="p">],</span><span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span><span class="n">order</span><span class="o">=</span><span class="s2">&quot;F&quot;</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snp_mem_map</span><span class="o">.</span><span class="n">val</span><span class="p">[:,:]</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">2.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">2.</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snp_mem_map</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="pysnptools.snpreader.SnpMemMap.offset">
<em class="property">property </em><code class="sig-name descname">offset</code><a class="headerlink" href="#pysnptools.snpreader.SnpMemMap.offset" title="Permalink to this definition">¶</a></dt>
<dd><p>The byte position in the file where the memory-mapped values start.</p>
<p>(The disk space before this is used to store <a class="reference internal" href="#pysnptools.snpreader.SnpReader.iid" title="pysnptools.snpreader.SnpReader.iid"><code class="xref py py-attr docutils literal notranslate"><span class="pre">SnpReader.iid</span></code></a>, etc. information.
This property is useful when interfacing with, for example, external Fortran and C matrix libraries.)</p>
</dd></dl>

<dl class="py method">
<dt id="pysnptools.snpreader.SnpMemMap.val">
<em class="property">property </em><code class="sig-name descname">val</code><a class="headerlink" href="#pysnptools.snpreader.SnpMemMap.val" title="Permalink to this definition">¶</a></dt>
<dd><p>The 2D NumPy memmap array of floats that represents the values.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.snpreader</span> <span class="k">import</span> <span class="n">SnpMemMap</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.util</span> <span class="k">import</span> <span class="n">example_file</span> <span class="c1"># Download and return local file name</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mem_map_file</span> <span class="o">=</span> <span class="n">example_file</span><span class="p">(</span><span class="s1">&#39;pysnptools/examples/tiny.snp.memmap&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snp_mem_map</span> <span class="o">=</span> <span class="n">SnpMemMap</span><span class="p">(</span><span class="n">mem_map_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">snp_mem_map</span><span class="o">.</span><span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="go">2.0</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="pysnptools.snpreader.SnpMemMap.write">
<em class="property">static </em><code class="sig-name descname">write</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span></em>, <em class="sig-param"><span class="n">snpdata</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.snpreader.SnpMemMap.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes a <a class="reference internal" href="#pysnptools.snpreader.SnpData" title="pysnptools.snpreader.SnpData"><code class="xref py py-class docutils literal notranslate"><span class="pre">SnpData</span></code></a> to <a class="reference internal" href="#pysnptools.snpreader.SnpMemMap" title="pysnptools.snpreader.SnpMemMap"><code class="xref py py-class docutils literal notranslate"><span class="pre">SnpMemMap</span></code></a> format.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>string</em>) – the name of the file to create</p></li>
<li><p><strong>snpdata</strong> (<a class="reference internal" href="#pysnptools.snpreader.SnpData" title="pysnptools.snpreader.SnpData"><code class="xref py py-class docutils literal notranslate"><span class="pre">SnpData</span></code></a>) – The in-memory data that should be written to disk.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="#pysnptools.snpreader.SnpMemMap" title="pysnptools.snpreader.SnpMemMap"><code class="xref py py-class docutils literal notranslate"><span class="pre">SnpMemMap</span></code></a></p>
</dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pysnptools.util</span> <span class="k">as</span> <span class="nn">pstutil</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.snpreader</span> <span class="k">import</span> <span class="n">SnpData</span><span class="p">,</span> <span class="n">SnpMemMap</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data1</span> <span class="o">=</span> <span class="n">SnpData</span><span class="p">(</span><span class="n">iid</span><span class="o">=</span><span class="p">[[</span><span class="s1">&#39;fam0&#39;</span><span class="p">,</span><span class="s1">&#39;iid0&#39;</span><span class="p">],[</span><span class="s1">&#39;fam0&#39;</span><span class="p">,</span><span class="s1">&#39;iid1&#39;</span><span class="p">]],</span> <span class="n">sid</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;snp334&#39;</span><span class="p">,</span><span class="s1">&#39;snp349&#39;</span><span class="p">,</span><span class="s1">&#39;snp921&#39;</span><span class="p">],</span><span class="n">val</span><span class="o">=</span> <span class="p">[[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">2.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">2.</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pstutil</span><span class="o">.</span><span class="n">create_directory_if_necessary</span><span class="p">(</span><span class="s2">&quot;tempdir/tiny.pst.memmap&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">SnpMemMap</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;tempdir/tiny.snp.memmap&quot;</span><span class="p">,</span><span class="n">data1</span><span class="p">)</span>      <span class="c1"># Write data1 in SnpMemMap format</span>
<span class="go">SnpMemMap(&#39;tempdir/tiny.snp.memmap&#39;)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="snpreader-snpgen">
<h3><code class="xref py py-class docutils literal notranslate"><span class="pre">snpreader.SnpGen</span></code><a class="headerlink" href="#snpreader-snpgen" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt id="pysnptools.snpreader.SnpGen">
<em class="property">class </em><code class="sig-prename descclassname">pysnptools.snpreader.</code><code class="sig-name descname">SnpGen</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">seed</span></em>, <em class="sig-param"><span class="n">iid_count</span></em>, <em class="sig-param"><span class="n">sid_count</span></em>, <em class="sig-param"><span class="n">chrom_count</span><span class="o">=</span><span class="default_value">22</span></em>, <em class="sig-param"><span class="n">cache_file</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">sid_batch_size</span><span class="o">=</span><span class="default_value">1000</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.snpreader.SnpGen" title="Permalink to this definition">¶</a></dt>
<dd><p>A <a class="reference internal" href="#pysnptools.snpreader.SnpReader" title="pysnptools.snpreader.SnpReader"><code class="xref py py-class docutils literal notranslate"><span class="pre">SnpReader</span></code></a> that generates deterministic SNP data on the fly.</p>
<p>See <a class="reference internal" href="#pysnptools.snpreader.SnpReader" title="pysnptools.snpreader.SnpReader"><code class="xref py py-class docutils literal notranslate"><span class="pre">SnpReader</span></code></a> for general examples of using SnpReader.</p>
<dl>
<dt><strong>Constructor:</strong></dt><dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>seed</strong> (<em>number</em>) – The random seed that (along with <em>sid_batch_size</em>) determines the SNP values.</p></li>
</ul>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>iid_count</strong> (<em>number</em>) –  the number of iids (number of individuals)</p></li>
</ul>
</dd>
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sid_count</strong> (<em>number</em>) –  the number of sids (number of SNPs)</p></li>
</ul>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>chrom_count</strong> (<em>number</em>) –  the number of chromosomes to generate (must be 22 or fewer)</p></li>
</ul>
</dd>
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cache_file</strong> (<em>string</em>) – (default None) If provided, tells where to cache the common iid, sid, and pos information. Using it can save time.</p></li>
</ul>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>sid_batch_size</strong> (<em>number</em>) – (default 1000) Tells how many SNP to generate at once. The default value is usually good.</p></li>
</ul>
</dd>
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">print_function</span> <span class="c1">#Python 2 &amp; 3 compatibility</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.snpreader</span> <span class="k">import</span> <span class="n">SnpGen</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#Prepare to generate data for 1000 individuals and 1,000,000 SNPs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snp_gen</span> <span class="o">=</span> <span class="n">SnpGen</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="mi">332</span><span class="p">,</span><span class="n">iid_count</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span><span class="n">sid_count</span><span class="o">=</span><span class="mi">1000</span><span class="o">*</span><span class="mi">1000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">snp_gen</span><span class="o">.</span><span class="n">iid_count</span><span class="p">,</span><span class="n">snp_gen</span><span class="o">.</span><span class="n">sid_count</span><span class="p">)</span>
<span class="go">1000 1000000</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snp_data</span> <span class="o">=</span> <span class="n">snp_gen</span><span class="p">[:,</span><span class="mi">200</span><span class="o">*</span><span class="mi">1000</span><span class="p">:</span><span class="mi">201</span><span class="o">*</span><span class="mi">1000</span><span class="p">]</span><span class="o">.</span><span class="n">read</span><span class="p">()</span> <span class="c1">#Generate for all users and for SNPs 200K to 201K</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">snp_data</span><span class="o">.</span><span class="n">val</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">snp_data</span><span class="o">.</span><span class="n">iid_count</span><span class="p">,</span> <span class="n">snp_data</span><span class="o">.</span><span class="n">sid_count</span><span class="p">)</span>
<span class="go">0.0 1000 1000</span>
</pre></div>
</div>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Also See</dt>
<dd class="field-odd"><p><a class="reference internal" href="#pysnptools.util.snp_gen" title="pysnptools.util.snp_gen"><code class="xref py py-func docutils literal notranslate"><span class="pre">snp_gen()</span></code></a></p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="snpreader-distributedbed">
<h3><code class="xref py py-class docutils literal notranslate"><span class="pre">snpreader.DistributedBed</span></code><a class="headerlink" href="#snpreader-distributedbed" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt id="pysnptools.snpreader.DistributedBed">
<em class="property">class </em><code class="sig-prename descclassname">pysnptools.snpreader.</code><code class="sig-name descname">DistributedBed</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">storage</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.snpreader.DistributedBed" title="Permalink to this definition">¶</a></dt>
<dd><p>A class that implements the <a class="reference internal" href="#pysnptools.snpreader.SnpReader" title="pysnptools.snpreader.SnpReader"><code class="xref py py-class docutils literal notranslate"><span class="pre">SnpReader</span></code></a> interface. It stores <a class="reference internal" href="#pysnptools.snpreader.Bed" title="pysnptools.snpreader.Bed"><code class="xref py py-class docutils literal notranslate"><span class="pre">Bed</span></code></a>-like data in pieces on storage. When you request data, it retrieves only the needed pieces.</p>
<dl>
<dt><strong>Constructor:</strong></dt><dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>storage</strong> (string or <a class="reference internal" href="#pysnptools.util.filecache.FileCache" title="pysnptools.util.filecache.FileCache"><code class="xref py py-class docutils literal notranslate"><span class="pre">FileCache</span></code></a>) – Tells where the DistirubtedBed data is stored.
A string can be given and will be interpreted as the path to a directory.
A <a class="reference internal" href="#pysnptools.util.filecache.FileCache" title="pysnptools.util.filecache.FileCache"><code class="xref py py-class docutils literal notranslate"><span class="pre">FileCache</span></code></a> instance can be given, which provides a method to specify cluster-distributed storage.</p>
</dd>
<dt class="field-even">type storage</dt>
<dd class="field-even"><p>string or <a class="reference internal" href="#pysnptools.util.filecache.FileCache" title="pysnptools.util.filecache.FileCache"><code class="xref py py-class docutils literal notranslate"><span class="pre">FileCache</span></code></a></p>
</dd>
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">print_function</span> <span class="c1">#Python 2 &amp; 3 compatibility</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">os</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.snpreader</span> <span class="k">import</span> <span class="n">DistributedBed</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.util</span> <span class="k">import</span> <span class="n">example_file</span> <span class="c1"># Download and return local file name</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">folder</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">example_file</span><span class="p">(</span><span class="s1">&#39;pysnptools/examples/toydataSkip10.distributedbed/*&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data_on_disk</span> <span class="o">=</span> <span class="n">DistributedBed</span><span class="p">(</span><span class="n">folder</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">((</span><span class="n">data_on_disk</span><span class="o">.</span><span class="n">iid_count</span><span class="p">,</span> <span class="n">data_on_disk</span><span class="o">.</span><span class="n">sid_count</span><span class="p">))</span>
<span class="go">(500, 1000)</span>
</pre></div>
</div>
</dd>
</dl>
<dl class="py method">
<dt id="pysnptools.snpreader.DistributedBed.write">
<em class="property">static </em><code class="sig-name descname">write</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">storage</span></em>, <em class="sig-param"><span class="n">snpreader</span></em>, <em class="sig-param"><span class="n">piece_per_chrom_count</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">updater</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">runner</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.snpreader.DistributedBed.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Uploads from any <a class="reference internal" href="#pysnptools.snpreader.Bed" title="pysnptools.snpreader.Bed"><code class="xref py py-class docutils literal notranslate"><span class="pre">Bed</span></code></a>-like data to cluster storage for efficient retrieval later.
If some of the contents already exists in storage, it skips uploading that part of the contents. (To avoid this behavior,
clear the storage.)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>storage</strong> (string or <a class="reference internal" href="#pysnptools.util.filecache.FileCache" title="pysnptools.util.filecache.FileCache"><code class="xref py py-class docutils literal notranslate"><span class="pre">FileCache</span></code></a> or None.) – Tells where to store SNP data.
A string can be given and will be interpreted as the path of a local directory to use for storage. (The local
directory will <strong>not</strong> be automatically erased and so must be user managed.) 
A <a class="reference internal" href="#pysnptools.util.filecache.FileCache" title="pysnptools.util.filecache.FileCache"><code class="xref py py-class docutils literal notranslate"><span class="pre">FileCache</span></code></a> instance can be given, which provides a
method to specify cluster-distributed storage. (<a class="reference internal" href="#pysnptools.util.filecache.FileCache" title="pysnptools.util.filecache.FileCache"><code class="xref py py-class docutils literal notranslate"><span class="pre">FileCache</span></code></a>’s will <strong>not</strong> be automatically erased and must be user managed.)
If <cite>None</cite>, the storage will be in an automatically-erasing temporary directory. (If the TEMP environment variable is set, Python places the temp directory under it.)</p></li>
<li><p><strong>snpreader</strong> (<a class="reference internal" href="#pysnptools.snpreader.SnpReader" title="pysnptools.snpreader.SnpReader"><code class="xref py py-class docutils literal notranslate"><span class="pre">SnpReader</span></code></a>) – A <a class="reference internal" href="#pysnptools.snpreader.Bed" title="pysnptools.snpreader.Bed"><code class="xref py py-class docutils literal notranslate"><span class="pre">Bed</span></code></a> or other <a class="reference internal" href="#pysnptools.snpreader.SnpReader" title="pysnptools.snpreader.SnpReader"><code class="xref py py-class docutils literal notranslate"><span class="pre">SnpReader</span></code></a> with values of 0,1,2, or missing.
(Note that this differs from most other <cite>write</cite> methods that take a <a class="reference internal" href="#pysnptools.snpreader.SnpData" title="pysnptools.snpreader.SnpData"><code class="xref py py-class docutils literal notranslate"><span class="pre">SnpData</span></code></a>)</p></li>
<li><p><strong>piece_per_chrom_count</strong> (<em>A number</em>) – The number of pieces in which to store the data from each chromosome. Data is split across
SNPs. For exmple, if <cite>piece_per_chrom_count</cite> is set to 100 and 22 chromosomes are uploaded, then data will be stored in 2200 pieces. Later, when data is requested
only the pieces necessary for the request will be downloaded to local storage.</p></li>
<li><p><strong>updater</strong> (<em>A function</em><em> or </em><em>lambda</em>) – A single argument function to write logging message to, for example, the function created by <a class="reference internal" href="#pysnptools.util.log_in_place" title="pysnptools.util.log_in_place"><code class="xref py py-func docutils literal notranslate"><span class="pre">log_in_place()</span></code></a>.</p></li>
<li><p><strong>runner</strong> (<a class="reference internal" href="#pysnptools.util.mapreduce1.runner.Runner" title="pysnptools.util.mapreduce1.runner.Runner"><code class="xref py py-class docutils literal notranslate"><span class="pre">Runner</span></code></a>) – a <a class="reference internal" href="#pysnptools.util.mapreduce1.runner.Runner" title="pysnptools.util.mapreduce1.runner.Runner"><code class="xref py py-class docutils literal notranslate"><span class="pre">Runner</span></code></a>, optional: Tells how to run.
(Note that <a class="reference internal" href="#pysnptools.util.mapreduce1.runner.Local" title="pysnptools.util.mapreduce1.runner.Local"><code class="xref py py-class docutils literal notranslate"><span class="pre">Local</span></code></a> and <code class="xref py py-class docutils literal notranslate"><span class="pre">LocalMultProc</span></code> are good options.)
If not given, the function is run locally.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="#pysnptools.snpreader.DistributedBed" title="pysnptools.snpreader.DistributedBed">DistributedBed</a></p>
</dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.snpreader</span> <span class="k">import</span> <span class="n">DistributedBed</span><span class="p">,</span> <span class="n">Bed</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">shutil</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.util</span> <span class="k">import</span> <span class="n">example_file</span> <span class="c1"># Download and return local file name</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">directory</span> <span class="o">=</span> <span class="s1">&#39;tempdir/toydataSkip10.distributedbed&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">directory</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">shutil</span><span class="o">.</span><span class="n">rmtree</span><span class="p">(</span><span class="n">directory</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bedfile</span> <span class="o">=</span> <span class="n">example_file</span><span class="p">(</span><span class="s2">&quot;pysnptools/examples/toydata.5chrom.*&quot;</span><span class="p">,</span><span class="s2">&quot;*.bed&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snpreader</span> <span class="o">=</span> <span class="n">Bed</span><span class="p">(</span><span class="n">bedfile</span><span class="p">,</span><span class="n">count_A1</span><span class="o">=</span><span class="kc">False</span><span class="p">)[:,::</span><span class="mi">10</span><span class="p">]</span>  <span class="c1"># Read every 10 snps from Bed format</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">DistributedBed</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">directory</span><span class="p">,</span><span class="n">snpreader</span><span class="p">,</span><span class="n">piece_per_chrom_count</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>  <span class="c1"># Write data in DistributedBed format</span>
<span class="go">DistributedBed(LocalCache(&#39;tempdir/toydataSkip10.distributedbed&#39;))</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</div>
</div>
<div class="section" id="module-pysnptools.kernelreader">
<span id="kernelreader-module"></span><h2><code class="xref py py-mod docutils literal notranslate"><span class="pre">kernelreader</span></code> Module<a class="headerlink" href="#module-pysnptools.kernelreader" title="Permalink to this headline">¶</a></h2>
<p>Tools for reading and manipulating kernels. A kernels is a matrix from iid to iid that typically tells the relatedness of pairs of people.</p>
<div class="section" id="kernelreader-kernelreader">
<h3><code class="xref py py-class docutils literal notranslate"><span class="pre">kernelreader.KernelReader</span></code><a class="headerlink" href="#kernelreader-kernelreader" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt id="pysnptools.kernelreader.KernelReader">
<em class="property">class </em><code class="sig-prename descclassname">pysnptools.kernelreader.</code><code class="sig-name descname">KernelReader</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.kernelreader.KernelReader" title="Permalink to this definition">¶</a></dt>
<dd><p>A KernelReader is one of three things:</p>
<ul>
<li><p>A class such as <a class="reference internal" href="#pysnptools.kernelreader.KernelNpz" title="pysnptools.kernelreader.KernelNpz"><code class="xref py py-class docutils literal notranslate"><span class="pre">KernelNpz</span></code></a> for you to specify data in a file. For example,</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">print_function</span> <span class="c1">#Python 2 &amp; 3 compatibility</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.kernelreader</span> <span class="k">import</span> <span class="n">KernelNpz</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.util</span> <span class="k">import</span> <span class="n">example_file</span> <span class="c1"># Download and return local file name</span>
<span class="gp">&gt;&gt;&gt; </span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kernel_file</span> <span class="o">=</span> <span class="n">example_file</span><span class="p">(</span><span class="s1">&#39;pysnptools/examples/toydata.kernel.npz&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kernel_on_disk</span> <span class="o">=</span> <span class="n">KernelNpz</span><span class="p">(</span><span class="n">kernel_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">kernel_on_disk</span><span class="p">)</span> <span class="c1"># prints specification for reading from file</span>
<span class="go">KernelNpz(&#39;...pysnptools/examples/toydata.kernel.npz&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kernel_on_disk</span><span class="o">.</span><span class="n">iid_count</span> <span class="c1"># prints the number of iids (but doesn&#39;t read any kernel values)</span>
<span class="go">500</span>
</pre></div>
</div>
</li>
<li><p>A <a class="reference internal" href="#pysnptools.kernelreader.KernelData" title="pysnptools.kernelreader.KernelData"><code class="xref py py-class docutils literal notranslate"><span class="pre">KernelData</span></code></a> class that holds kernel data in memory, typically after computing from a SnpReader or reading it from a KernelReader:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Compute kernel from a SnpReader</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.snpreader</span> <span class="k">import</span> <span class="n">Bed</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.standardizer</span> <span class="k">import</span> <span class="n">Unit</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.util</span> <span class="k">import</span> <span class="n">example_file</span> <span class="c1"># Download and return local file name</span>
<span class="gp">&gt;&gt;&gt; </span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bed_file</span> <span class="o">=</span> <span class="n">example_file</span><span class="p">(</span><span class="s1">&#39;tests/datasets/all_chr.maf0.001.N300.*&#39;</span><span class="p">,</span><span class="s1">&#39;*.bed&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snp_on_disk</span> <span class="o">=</span> <span class="n">Bed</span><span class="p">(</span><span class="n">bed_file</span><span class="p">,</span><span class="n">count_A1</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kerneldata1</span> <span class="o">=</span> <span class="n">snp_on_disk</span><span class="o">.</span><span class="n">read_kernel</span><span class="p">(</span><span class="n">Unit</span><span class="p">())</span> <span class="c1">#reads the SNP values and computes the kernel</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">type</span><span class="p">(</span><span class="n">kerneldata1</span><span class="o">.</span><span class="n">val</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span> <span class="c1"># The val property is an ndarray of kernel values</span>
<span class="go">&#39;ndarray&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">kerneldata1</span><span class="p">)</span> <span class="c1"># prints the specification of the in-memory kernel information</span>
<span class="go">KernelData(SnpKernel(Bed(...tests/datasets/all_chr.maf0.001.N300.bed&#39;,count_A1=False),standardizer=Unit()))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kerneldata1</span><span class="o">.</span><span class="n">iid_count</span> <span class="c1">#prints the number of iids (number of individuals) in this in-memory data</span>
<span class="go">300</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Read kernel from a KernelReader</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kernel_file</span> <span class="o">=</span> <span class="n">example_file</span><span class="p">(</span><span class="s1">&#39;pysnptools/examples/toydata.kernel.npz&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kernel_on_disk</span> <span class="o">=</span> <span class="n">KernelNpz</span><span class="p">(</span><span class="n">kernel_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kerneldata2</span> <span class="o">=</span> <span class="n">kernel_on_disk</span><span class="o">.</span><span class="n">read</span><span class="p">()</span> <span class="c1">#reads the kernel values</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">kerneldata2</span><span class="p">)</span> <span class="c1"># prints the specification of the in-memory kernel information</span>
<span class="go">KernelData(KernelNpz(...pysnptools/examples/toydata.kernel.npz&#39;))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kerneldata2</span><span class="o">.</span><span class="n">iid_count</span> <span class="c1">#prints the number of iids (number of individuals) in this in-memory data</span>
<span class="go">500</span>
</pre></div>
</div>
</li>
<li><p>A subset of any KernelReader, specified with “[ <em>iid_index</em> ]” (or  specified with “[ <em>iid0_index</em> , <em>iid1_index</em> ]”), to read only some kernel values. It can
also be used to re-order the values.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">kernel_on_disk</span> <span class="o">=</span> <span class="n">KernelNpz</span><span class="p">(</span><span class="n">kernel_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">subset_on_disk1</span> <span class="o">=</span> <span class="n">kernel_on_disk</span><span class="p">[[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]]</span> <span class="c1"># specification for a subset of the data on disk. No kernel values are read yet.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">subset_on_disk1</span><span class="o">.</span><span class="n">iid_count</span><span class="p">)</span> <span class="c1"># prints the number of iids in this subset (but still doesn&#39;t read any kernel values)</span>
<span class="go">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">subset_on_disk1</span><span class="p">)</span> <span class="c1">#prints a specification of &#39;subset_on_disk1&#39;</span>
<span class="go">KernelNpz(...pysnptools/examples/toydata.kernel.npz&#39;)[[3,4],[3,4]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kerneldata_subset</span> <span class="o">=</span> <span class="n">subset_on_disk1</span><span class="o">.</span><span class="n">read</span><span class="p">()</span> <span class="c1"># efficiently (if possible) reads the specified subset of values from the disk</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">kerneldata_subset</span><span class="p">)</span> <span class="c1"># prints the specification of the in-memory kernel information</span>
<span class="go">KernelData(KernelNpz(...pysnptools/examples/toydata.kernel.npz&#39;)[[3,4],[3,4]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">((</span><span class="nb">int</span><span class="p">(</span><span class="n">kerneldata_subset</span><span class="o">.</span><span class="n">val</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">int</span><span class="p">(</span><span class="n">kerneldata_subset</span><span class="o">.</span><span class="n">val</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])))</span> <span class="c1"># The dimensions of the ndarray of kernel values</span>
<span class="go">(2, 2)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">subset_on_disk2</span> <span class="o">=</span> <span class="n">kernel_on_disk</span><span class="p">[[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],::</span><span class="mi">2</span><span class="p">]</span> <span class="c1"># specification for a subset of the data on disk. No kernel values are read yet.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">((</span><span class="n">subset_on_disk2</span><span class="o">.</span><span class="n">iid0_count</span><span class="p">,</span> <span class="n">subset_on_disk2</span><span class="o">.</span><span class="n">iid1_count</span><span class="p">))</span>
<span class="go">(2, 250)</span>
</pre></div>
</div>
</li>
</ul>
<p>The KernelReaders Classes</p>
<blockquote>
<div><table class="docutils align-default">
<colgroup>
<col style="width: 30%" />
<col style="width: 16%" />
<col style="width: 20%" />
<col style="width: 16%" />
<col style="width: 18%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><em>Class</em></p></td>
<td><p><em>Format</em></p></td>
<td><p><em>Random Access</em></p></td>
<td><p><em>Suffixes</em></p></td>
<td><p><em>Write</em> method?</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pysnptools.kernelreader.KernelData" title="pysnptools.kernelreader.KernelData"><code class="xref py py-class docutils literal notranslate"><span class="pre">KernelData</span></code></a></p></td>
<td><p>in-memory</p></td>
<td><p>Yes</p></td>
<td><p><em>n/a</em></p></td>
<td><p><em>n/a</em></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pysnptools.kernelreader.KernelNpz" title="pysnptools.kernelreader.KernelNpz"><code class="xref py py-class docutils literal notranslate"><span class="pre">KernelNpz</span></code></a></p></td>
<td><p>binary</p></td>
<td><p>No</p></td>
<td><p>.kernel.npz</p></td>
<td><p>Yes</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pysnptools.kernelreader.KernelHdf5" title="pysnptools.kernelreader.KernelHdf5"><code class="xref py py-class docutils literal notranslate"><span class="pre">KernelHdf5</span></code></a></p></td>
<td><p>binary</p></td>
<td><p>Yes</p></td>
<td><p>.kernel.hdf5</p></td>
<td><p>Yes</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pysnptools.kernelreader.Identity" title="pysnptools.kernelreader.Identity"><code class="xref py py-class docutils literal notranslate"><span class="pre">Identity</span></code></a></p></td>
<td><p><em>n/a</em></p></td>
<td><p>Yes</p></td>
<td><p><em>n/a</em></p></td>
<td><p>No</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pysnptools.kernelreader.SnpKernel" title="pysnptools.kernelreader.SnpKernel"><code class="xref py py-class docutils literal notranslate"><span class="pre">SnpKernel</span></code></a></p></td>
<td><p>depends</p></td>
<td><p>depends</p></td>
<td><p><em>n/a</em></p></td>
<td><p>No</p></td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>Methods &amp; Properties:</p>
<blockquote>
<div><p>Every KernelReader, such as <a class="reference internal" href="#pysnptools.kernelreader.KernelNpz" title="pysnptools.kernelreader.KernelNpz"><code class="xref py py-class docutils literal notranslate"><span class="pre">KernelNpz</span></code></a> and <a class="reference internal" href="#pysnptools.kernelreader.KernelData" title="pysnptools.kernelreader.KernelData"><code class="xref py py-class docutils literal notranslate"><span class="pre">KernelData</span></code></a>, when square has these properties: <a class="reference internal" href="#pysnptools.kernelreader.KernelReader.iid" title="pysnptools.kernelreader.KernelReader.iid"><code class="xref py py-attr docutils literal notranslate"><span class="pre">iid</span></code></a>, <a class="reference internal" href="#pysnptools.kernelreader.KernelReader.iid_count" title="pysnptools.kernelreader.KernelReader.iid_count"><code class="xref py py-attr docutils literal notranslate"><span class="pre">iid_count</span></code></a>, 
and these methods: <a class="reference internal" href="#pysnptools.kernelreader.KernelReader.read" title="pysnptools.kernelreader.KernelReader.read"><code class="xref py py-meth docutils literal notranslate"><span class="pre">read()</span></code></a>, and <a class="reference internal" href="#pysnptools.kernelreader.KernelReader.iid_to_index" title="pysnptools.kernelreader.KernelReader.iid_to_index"><code class="xref py py-meth docutils literal notranslate"><span class="pre">iid_to_index()</span></code></a>. A square kernel is one that has the same iid list for both its rows and columns.</p>
<p>More generally, KernelReaders can have one iid list for its rows and a different iid list for its columns, so these properties and methods are also defined: <a class="reference internal" href="#pysnptools.kernelreader.KernelReader.iid0" title="pysnptools.kernelreader.KernelReader.iid0"><code class="xref py py-attr docutils literal notranslate"><span class="pre">iid0</span></code></a>, <a class="reference internal" href="#pysnptools.kernelreader.KernelReader.iid1" title="pysnptools.kernelreader.KernelReader.iid1"><code class="xref py py-attr docutils literal notranslate"><span class="pre">iid1</span></code></a>, <a class="reference internal" href="#pysnptools.kernelreader.KernelReader.iid0_count" title="pysnptools.kernelreader.KernelReader.iid0_count"><code class="xref py py-attr docutils literal notranslate"><span class="pre">iid0_count</span></code></a>, 
<a class="reference internal" href="#pysnptools.kernelreader.KernelReader.iid1_count" title="pysnptools.kernelreader.KernelReader.iid1_count"><code class="xref py py-attr docutils literal notranslate"><span class="pre">iid1_count</span></code></a>, <a class="reference internal" href="#pysnptools.kernelreader.KernelReader.iid0_to_index" title="pysnptools.kernelreader.KernelReader.iid0_to_index"><code class="xref py py-meth docutils literal notranslate"><span class="pre">iid0_to_index()</span></code></a>, and <a class="reference internal" href="#pysnptools.kernelreader.KernelReader.iid1_to_index" title="pysnptools.kernelreader.KernelReader.iid1_to_index"><code class="xref py py-meth docutils literal notranslate"><span class="pre">iid1_to_index()</span></code></a>.</p>
<p>See below for details.</p>
<p><a class="reference internal" href="#pysnptools.kernelreader.KernelData" title="pysnptools.kernelreader.KernelData"><code class="xref py py-class docutils literal notranslate"><span class="pre">KernelData</span></code></a> is a KernelReader so it supports the above properties and methods. In addition, it supports property <a class="reference internal" href="#pysnptools.kernelreader.KernelData.val" title="pysnptools.kernelreader.KernelData.val"><code class="xref py py-attr docutils literal notranslate"><span class="pre">KernelData.val</span></code></a>, method <a class="reference internal" href="#pysnptools.kernelreader.KernelData.standardize" title="pysnptools.kernelreader.KernelData.standardize"><code class="xref py py-meth docutils literal notranslate"><span class="pre">KernelData.standardize()</span></code></a>, and equality testing.
See below for details.</p>
<p>Some of the classes, such as <a class="reference internal" href="#pysnptools.kernelreader.KernelNpz" title="pysnptools.kernelreader.KernelNpz"><code class="xref py py-class docutils literal notranslate"><span class="pre">KernelNpz</span></code></a>, also provide a static <a class="reference internal" href="#pysnptools.kernelreader.KernelNpz.write" title="pysnptools.kernelreader.KernelNpz.write"><code class="xref py py-meth docutils literal notranslate"><span class="pre">KernelNpz.write()</span></code></a> method for writing <a class="reference internal" href="#pysnptools.kernelreader.KernelData" title="pysnptools.kernelreader.KernelData"><code class="xref py py-class docutils literal notranslate"><span class="pre">KernelData</span></code></a>.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># create a kernel from a Bed file and write to KernelNpz format</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">print_function</span> <span class="c1">#Python 2 &amp; 3 compatibility</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.snpreader</span> <span class="k">import</span> <span class="n">Bed</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.util</span> <span class="k">import</span> <span class="n">example_file</span> <span class="c1"># Download and return local file name</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.standardizer</span> <span class="k">import</span> <span class="n">Unit</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pysnptools.util</span> <span class="k">as</span> <span class="nn">pstutil</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">bed_file</span> <span class="o">=</span> <span class="n">example_file</span><span class="p">(</span><span class="s1">&#39;pysnptools/examples/toydata.5chrom.bed&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kerneldata</span> <span class="o">=</span> <span class="n">Bed</span><span class="p">(</span><span class="n">bed_file</span><span class="p">,</span><span class="n">count_A1</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">read_kernel</span><span class="p">(</span><span class="n">Unit</span><span class="p">())</span>     <span class="c1"># Create a kernel from the data in the Bed file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pstutil</span><span class="o">.</span><span class="n">create_directory_if_necessary</span><span class="p">(</span><span class="s2">&quot;tempdir/toydata.kernel.npz&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">KernelNpz</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;tempdir/toydata.kernel.npz&quot;</span><span class="p">,</span><span class="n">kerneldata</span><span class="p">)</span>      <span class="c1"># Write data in KernelNpz format</span>
<span class="go">KernelNpz(&#39;tempdir/toydata.kernel.npz&#39;)</span>
</pre></div>
</div>
</div></blockquote>
<p>iids:</p>
<blockquote>
<div><p>Individual are identified with an iid, which is a ndarray of two strings: a family ID and a case ID. For example:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">kernel_on_disk</span> <span class="o">=</span> <span class="n">KernelNpz</span><span class="p">(</span><span class="n">kernel_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">kernel_on_disk</span><span class="o">.</span><span class="n">iid</span><span class="p">[:</span><span class="mi">3</span><span class="p">])</span> <span class="c1"># print the first three iids</span>
<span class="go">[[&#39;per0&#39; &#39;per0&#39;]</span>
<span class="go"> [&#39;per1&#39; &#39;per1&#39;]</span>
<span class="go"> [&#39;per2&#39; &#39;per2&#39;]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">kernel_on_disk</span><span class="o">.</span><span class="n">iid_to_index</span><span class="p">([[</span><span class="s1">&#39;per2&#39;</span><span class="p">,</span><span class="s1">&#39;per2&#39;</span><span class="p">],[</span><span class="s1">&#39;per1&#39;</span><span class="p">,</span><span class="s1">&#39;per1&#39;</span><span class="p">]]))</span> <span class="c1">#Find the indexes for two iids.</span>
<span class="go">[2 1]</span>
</pre></div>
</div>
</div></blockquote>
<p><a class="reference internal" href="#pysnptools.kernelreader.KernelReader" title="pysnptools.kernelreader.KernelReader"><code class="xref py py-class docutils literal notranslate"><span class="pre">KernelReader</span></code></a> is a kind of <a class="reference internal" href="#pysnptools.pstreader.PstReader" title="pysnptools.pstreader.PstReader"><code class="xref py py-class docutils literal notranslate"><span class="pre">PstReader</span></code></a>. See the documentation for <a class="reference internal" href="#pysnptools.pstreader.PstReader" title="pysnptools.pstreader.PstReader"><code class="xref py py-class docutils literal notranslate"><span class="pre">PstReader</span></code></a> to learn about:</p>
<blockquote>
<div><ul class="simple">
<li><p>When Data is Read</p></li>
<li><p>When Data is Re-Read and Copied</p></li>
<li><p>Avoiding Unwanted ndarray Allocations</p></li>
<li><p>Creating Subsetting PstReaders with Indexing</p></li>
</ul>
</div></blockquote>
<p>The <a class="reference internal" href="#pysnptools.kernelreader.KernelReader.read" title="pysnptools.kernelreader.KernelReader.read"><code class="xref py py-meth docutils literal notranslate"><span class="pre">read()</span></code></a> Method</p>
<blockquote>
<div><p>By default the <a class="reference internal" href="#pysnptools.kernelreader.KernelReader.read" title="pysnptools.kernelreader.KernelReader.read"><code class="xref py py-meth docutils literal notranslate"><span class="pre">read()</span></code></a> returns a ndarray of scipy.float64 laid out in memory in F-contiguous order (iid0-index varies the fastest). You may, instead,
ask for scipy.float32 or for C-contiguous order or any order. See <a class="reference internal" href="#pysnptools.kernelreader.KernelReader.read" title="pysnptools.kernelreader.KernelReader.read"><code class="xref py py-meth docutils literal notranslate"><span class="pre">read()</span></code></a> for details.</p>
</div></blockquote>
<dl>
<dt>The <a class="reference internal" href="#pysnptools.kernelreader.KernelData.standardize" title="pysnptools.kernelreader.KernelData.standardize"><code class="xref py py-meth docutils literal notranslate"><span class="pre">KernelData.standardize()</span></code></a> Method</dt><dd><p>The <a class="reference internal" href="#pysnptools.kernelreader.KernelData.standardize" title="pysnptools.kernelreader.KernelData.standardize"><code class="xref py py-meth docutils literal notranslate"><span class="pre">KernelData.standardize()</span></code></a> method, available only on <a class="reference internal" href="#pysnptools.kernelreader.KernelData" title="pysnptools.kernelreader.KernelData"><code class="xref py py-class docutils literal notranslate"><span class="pre">KernelData</span></code></a>, does in-place standardization of the in-memory
kernel data. The method multiples the values with a scalar factor such that the diagonal sums to iid_count. Although it works in place, for convenience
it also returns itself. See <a class="reference internal" href="#pysnptools.kernelreader.KernelData.standardize" title="pysnptools.kernelreader.KernelData.standardize"><code class="xref py py-meth docutils literal notranslate"><span class="pre">KernelData.standardize()</span></code></a> for details.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">kernel_on_disk</span> <span class="o">=</span> <span class="n">KernelNpz</span><span class="p">(</span><span class="n">kernel_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kerneldata1</span> <span class="o">=</span> <span class="n">kernel_on_disk</span><span class="o">.</span><span class="n">read</span><span class="p">()</span> <span class="c1"># read all kernel values into memory</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">kerneldata1</span><span class="o">.</span><span class="n">val</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
<span class="go">5000000.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kerneldata1</span><span class="o">.</span><span class="n">standardize</span><span class="p">()</span> <span class="c1"># standardize changes the values in kerneldata1.val</span>
<span class="go">KernelData(KernelNpz(...pysnptools/examples/toydata.kernel.npz&#39;))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">kerneldata1</span><span class="o">.</span><span class="n">val</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
<span class="go">500.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kerneldata2</span> <span class="o">=</span> <span class="n">kernel_on_disk</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">standardize</span><span class="p">()</span> <span class="c1"># Read and standardize in one expression with only one ndarray allocated.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">kerneldata2</span><span class="o">.</span><span class="n">val</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
<span class="go">500.0</span>
</pre></div>
</div>
</dd>
</dl>
<p>Details of Methods &amp; Properties:</p>
<dl class="py method">
<dt id="pysnptools.kernelreader.KernelReader.iid">
<em class="property">property </em><code class="sig-name descname">iid</code><a class="headerlink" href="#pysnptools.kernelreader.KernelReader.iid" title="Permalink to this definition">¶</a></dt>
<dd><p>A ndarray of the iids. Each iid is a ndarray of two strings (a family ID and a case ID) that identifies an individual.
Assumes the kernel is square, so will throw an exception if the row iids are different from the column iids.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray (length <a class="reference internal" href="#pysnptools.kernelreader.KernelReader.iid_count" title="pysnptools.kernelreader.KernelReader.iid_count"><code class="xref py py-attr docutils literal notranslate"><span class="pre">iid_count</span></code></a>) of ndarray (length 2) of strings</p>
</dd>
</dl>
<p>This property (to the degree practical) reads only iid and sid data from the disk, not kernel value data. Moreover, the iid data is read from file only once.</p>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.kernelreader</span> <span class="k">import</span> <span class="n">KernelNpz</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">print_function</span> <span class="c1">#Python 2 &amp; 3 compatibility</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.util</span> <span class="k">import</span> <span class="n">example_file</span> <span class="c1"># Download and return local file name</span>
<span class="gp">&gt;&gt;&gt; </span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kernel_file</span> <span class="o">=</span> <span class="n">example_file</span><span class="p">(</span><span class="s1">&#39;pysnptools/examples/toydata.kernel.npz&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kernel_on_disk</span> <span class="o">=</span> <span class="n">KernelNpz</span><span class="p">(</span><span class="n">kernel_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">kernel_on_disk</span><span class="o">.</span><span class="n">iid</span><span class="p">[:</span><span class="mi">3</span><span class="p">])</span> <span class="c1"># print the first three iids</span>
<span class="go">[[&#39;per0&#39; &#39;per0&#39;]</span>
<span class="go"> [&#39;per1&#39; &#39;per1&#39;]</span>
<span class="go"> [&#39;per2&#39; &#39;per2&#39;]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="pysnptools.kernelreader.KernelReader.iid0">
<em class="property">property </em><code class="sig-name descname">iid0</code><a class="headerlink" href="#pysnptools.kernelreader.KernelReader.iid0" title="Permalink to this definition">¶</a></dt>
<dd><p>A ndarray of the row iids. See <a class="reference internal" href="#pysnptools.kernelreader.KernelReader.iid" title="pysnptools.kernelreader.KernelReader.iid"><code class="xref py py-attr docutils literal notranslate"><span class="pre">iid</span></code></a></p>
</dd></dl>

<dl class="py method">
<dt id="pysnptools.kernelreader.KernelReader.iid0_count">
<em class="property">property </em><code class="sig-name descname">iid0_count</code><a class="headerlink" href="#pysnptools.kernelreader.KernelReader.iid0_count" title="Permalink to this definition">¶</a></dt>
<dd><p>number of row iids. See <a class="reference internal" href="#pysnptools.kernelreader.KernelReader.iid_count" title="pysnptools.kernelreader.KernelReader.iid_count"><code class="xref py py-attr docutils literal notranslate"><span class="pre">iid_count</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>integer</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pysnptools.kernelreader.KernelReader.iid0_to_index">
<code class="sig-name descname">iid0_to_index</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">list</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.kernelreader.KernelReader.iid0_to_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes a list of row iids and returns a list of index numbers. See <a class="reference internal" href="#pysnptools.kernelreader.KernelReader.iid_to_index" title="pysnptools.kernelreader.KernelReader.iid_to_index"><code class="xref py py-attr docutils literal notranslate"><span class="pre">iid_to_index</span></code></a></p>
</dd></dl>

<dl class="py method">
<dt id="pysnptools.kernelreader.KernelReader.iid1">
<em class="property">property </em><code class="sig-name descname">iid1</code><a class="headerlink" href="#pysnptools.kernelreader.KernelReader.iid1" title="Permalink to this definition">¶</a></dt>
<dd><p>A ndarray of the column iids. See <a class="reference internal" href="#pysnptools.kernelreader.KernelReader.iid" title="pysnptools.kernelreader.KernelReader.iid"><code class="xref py py-attr docutils literal notranslate"><span class="pre">iid</span></code></a></p>
</dd></dl>

<dl class="py method">
<dt id="pysnptools.kernelreader.KernelReader.iid1_count">
<em class="property">property </em><code class="sig-name descname">iid1_count</code><a class="headerlink" href="#pysnptools.kernelreader.KernelReader.iid1_count" title="Permalink to this definition">¶</a></dt>
<dd><p>number of column iids. See <a class="reference internal" href="#pysnptools.kernelreader.KernelReader.iid_count" title="pysnptools.kernelreader.KernelReader.iid_count"><code class="xref py py-attr docutils literal notranslate"><span class="pre">iid_count</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>integer</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pysnptools.kernelreader.KernelReader.iid1_to_index">
<code class="sig-name descname">iid1_to_index</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">list</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.kernelreader.KernelReader.iid1_to_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes a list of column iids and returns a list of index numbers. See <a class="reference internal" href="#pysnptools.kernelreader.KernelReader.iid_to_index" title="pysnptools.kernelreader.KernelReader.iid_to_index"><code class="xref py py-attr docutils literal notranslate"><span class="pre">iid_to_index</span></code></a></p>
</dd></dl>

<dl class="py method">
<dt id="pysnptools.kernelreader.KernelReader.iid_count">
<em class="property">property </em><code class="sig-name descname">iid_count</code><a class="headerlink" href="#pysnptools.kernelreader.KernelReader.iid_count" title="Permalink to this definition">¶</a></dt>
<dd><p>number of iids
Assumes the kernel is square, so will throw an exception if the row iids are different from the column iids.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>integer</p>
</dd>
</dl>
<p>This property (to the degree practical) reads only iid data from the disk, not kernel value data. Moreover, the iid data is read from file only once.</p>
</dd></dl>

<dl class="py method">
<dt id="pysnptools.kernelreader.KernelReader.iid_to_index">
<code class="sig-name descname">iid_to_index</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">list</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.kernelreader.KernelReader.iid_to_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes a list of iids and returns a list of index numbers.
Assumes the kernel is square, so will throw an exception if the row iids are different from the column iids.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>list</strong> – list of iids</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>ndarray of int</p>
</dd>
</dl>
<p>This method (to the degree practical) reads only iid from the disk, not kernel value data. Moreover, the iid data is read from file only once.</p>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.kernelreader</span> <span class="k">import</span> <span class="n">KernelNpz</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.util</span> <span class="k">import</span> <span class="n">example_file</span> <span class="c1"># Download and return local file name</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">npz_file</span> <span class="o">=</span> <span class="n">example_file</span><span class="p">(</span><span class="s1">&#39;pysnptools/examples/toydata.kernel.npz&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kernel_on_disk</span> <span class="o">=</span> <span class="n">KernelNpz</span><span class="p">(</span><span class="n">npz_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">kernel_on_disk</span><span class="o">.</span><span class="n">iid_to_index</span><span class="p">([[</span><span class="s1">&#39;per2&#39;</span><span class="p">,</span><span class="s1">&#39;per2&#39;</span><span class="p">],[</span><span class="s1">&#39;per1&#39;</span><span class="p">,</span><span class="s1">&#39;per1&#39;</span><span class="p">]]))</span> <span class="c1">#Find the indexes for two iids.</span>
<span class="go">[2 1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="pysnptools.kernelreader.KernelReader.read">
<code class="sig-name descname">read</code><span class="sig-paren">(</span><em class="sig-param">order='F'</em>, <em class="sig-param">dtype=&lt;class 'numpy.float64'&gt;</em>, <em class="sig-param">force_python_only=False</em>, <em class="sig-param">view_ok=False</em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.kernelreader.KernelReader.read" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads the kernel values and returns a <a class="reference internal" href="#pysnptools.kernelreader.KernelData" title="pysnptools.kernelreader.KernelData"><code class="xref py py-class docutils literal notranslate"><span class="pre">KernelData</span></code></a> (with <a class="reference internal" href="#pysnptools.kernelreader.KernelData.val" title="pysnptools.kernelreader.KernelData.val"><code class="xref py py-attr docutils literal notranslate"><span class="pre">KernelData.val</span></code></a> property containing a new ndarray of the kernel values).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>order</strong> (<em>string</em><em> or </em><em>None</em>) – {‘F’ (default), ‘C’, ‘A’}, optional – Specify the order of the ndarray. If order is ‘F’ (default),
then the array will be in F-contiguous order (iid0-index varies the fastest).
If order is ‘C’, then the returned array will be in C-contiguous order (iid1-index varies the fastest).
If order is ‘A’, then the <a class="reference internal" href="#pysnptools.kernelreader.KernelData.val" title="pysnptools.kernelreader.KernelData.val"><code class="xref py py-attr docutils literal notranslate"><span class="pre">KernelData.val</span></code></a>
ndarray may be in any order (either C-, Fortran-contiguous, or even discontiguous).</p></li>
<li><p><strong>dtype</strong> (<em>data-type</em>) – {scipy.float64 (default), scipy.float32}, optional – The data-type for the <a class="reference internal" href="#pysnptools.kernelreader.KernelData.val" title="pysnptools.kernelreader.KernelData.val"><code class="xref py py-attr docutils literal notranslate"><span class="pre">KernelData.val</span></code></a> ndarray.</p></li>
<li><p><strong>force_python_only</strong> (<em>bool</em>) – optional – If False (default), may use outside library code. If True, requests that the read
be done without outside library code.</p></li>
<li><p><strong>view_ok</strong> (<em>bool</em>) – optional – If False (default), allocates new memory for the <a class="reference internal" href="#pysnptools.kernelreader.KernelData.val" title="pysnptools.kernelreader.KernelData.val"><code class="xref py py-attr docutils literal notranslate"><span class="pre">KernelData.val</span></code></a>’s ndarray. If True,
if practical and reading from a <a class="reference internal" href="#pysnptools.kernelreader.KernelData" title="pysnptools.kernelreader.KernelData"><code class="xref py py-class docutils literal notranslate"><span class="pre">KernelData</span></code></a>, will return a new 
<a class="reference internal" href="#pysnptools.kernelreader.KernelData" title="pysnptools.kernelreader.KernelData"><code class="xref py py-class docutils literal notranslate"><span class="pre">KernelData</span></code></a> with a ndarray shares memory with the original <a class="reference internal" href="#pysnptools.kernelreader.KernelData" title="pysnptools.kernelreader.KernelData"><code class="xref py py-class docutils literal notranslate"><span class="pre">KernelData</span></code></a>.
Typically, you’ll also wish to use “order=’A’” to increase the chance that sharing will be possible.
Use these parameters with care because any change to either ndarray (for example, via <a class="reference internal" href="#pysnptools.kernelreader.KernelData.standardize" title="pysnptools.kernelreader.KernelData.standardize"><code class="xref py py-meth docutils literal notranslate"><span class="pre">KernelData.standardize()</span></code></a>) will effect
the others. Also keep in mind that <a class="reference internal" href="#pysnptools.kernelreader.KernelReader.read" title="pysnptools.kernelreader.KernelReader.read"><code class="xref py py-meth docutils literal notranslate"><span class="pre">read()</span></code></a> relies on ndarray’s mechanisms to decide whether to actually
share memory and so it may ignore your suggestion and allocate a new ndarray anyway.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="#pysnptools.kernelreader.KernelData" title="pysnptools.kernelreader.KernelData"><code class="xref py py-class docutils literal notranslate"><span class="pre">KernelData</span></code></a></p>
</dd>
</dl>
<p>Calling the method again causes the kernel values to be re-read and creates a new in-memory <a class="reference internal" href="#pysnptools.kernelreader.KernelData" title="pysnptools.kernelreader.KernelData"><code class="xref py py-class docutils literal notranslate"><span class="pre">KernelData</span></code></a> with a new ndarray of kernel values.</p>
<p>If you request the values for only a subset of the sids or iids, (to the degree practical) only that subset will be read from disk.</p>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.kernelreader</span> <span class="k">import</span> <span class="n">KernelNpz</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.util</span> <span class="k">import</span> <span class="n">example_file</span> <span class="c1"># Download and return local file name</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">npz_file</span> <span class="o">=</span> <span class="n">example_file</span><span class="p">(</span><span class="s1">&#39;pysnptools/examples/toydata.kernel.npz&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kernel_on_disk</span> <span class="o">=</span> <span class="n">KernelNpz</span><span class="p">(</span><span class="n">npz_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kerneldata1</span> <span class="o">=</span> <span class="n">kernel_on_disk</span><span class="o">.</span><span class="n">read</span><span class="p">()</span> <span class="c1"># Read all the kernel data returning a KernelData instance</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">kerneldata1</span><span class="o">.</span><span class="n">val</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span> <span class="c1"># The KernelData instance contains a ndarray of the data.</span>
<span class="go">ndarray</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">subset_kerneldata</span> <span class="o">=</span> <span class="n">kernel_on_disk</span><span class="p">[::</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">read</span><span class="p">()</span> <span class="c1"># From the disk, read kernel values for every other iid</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0:.6f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">subset_kerneldata</span><span class="o">.</span><span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]))</span> <span class="c1"># Print the first kernel value in the subset</span>
<span class="go">9923.069928</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">subsub_kerneldata</span> <span class="o">=</span> <span class="n">subset_kerneldata</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="n">view_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1"># Create an in-memory subset of the subset with kernel values for the first ten iids. Share memory if practical.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#print(np.may_share_memory(subset_kerneldata.val, subsub_kerneldata.val)) # Do the two ndarray&#39;s share memory? They could. Currently they won&#39;t.       </span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="kernelreader-kerneldata">
<h3><code class="xref py py-class docutils literal notranslate"><span class="pre">kernelreader.KernelData</span></code><a class="headerlink" href="#kernelreader-kerneldata" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt id="pysnptools.kernelreader.KernelData">
<em class="property">class </em><code class="sig-prename descclassname">pysnptools.kernelreader.</code><code class="sig-name descname">KernelData</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">iid</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">iid0</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">iid1</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">val</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">name</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">parent_string</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.kernelreader.KernelData" title="Permalink to this definition">¶</a></dt>
<dd><p>A <a class="reference internal" href="#pysnptools.kernelreader.KernelReader" title="pysnptools.kernelreader.KernelReader"><code class="xref py py-class docutils literal notranslate"><span class="pre">KernelReader</span></code></a> for holding kernel values in-memory, along with related iid information.
It is usually created by calling the <a class="reference internal" href="#pysnptools.snpreader.SnpReader.read_kernel" title="pysnptools.snpreader.SnpReader.read_kernel"><code class="xref py py-meth docutils literal notranslate"><span class="pre">SnpReader.read_kernel()</span></code></a> method on a <a class="reference internal" href="#pysnptools.snpreader.SnpReader" title="pysnptools.snpreader.SnpReader"><code class="xref py py-class docutils literal notranslate"><span class="pre">SnpReader</span></code></a>, for example, <a class="reference internal" href="#pysnptools.snpreader.Bed" title="pysnptools.snpreader.Bed"><code class="xref py py-class docutils literal notranslate"><span class="pre">Bed</span></code></a>.
It can also be created by calling the <a class="reference internal" href="#pysnptools.kernelreader.KernelReader.read" title="pysnptools.kernelreader.KernelReader.read"><code class="xref py py-meth docutils literal notranslate"><span class="pre">KernelReader.read()</span></code></a> method on <a class="reference internal" href="#pysnptools.kernelreader.SnpKernel" title="pysnptools.kernelreader.SnpKernel"><code class="xref py py-class docutils literal notranslate"><span class="pre">SnpKernel</span></code></a>, for example, <a class="reference internal" href="#pysnptools.kernelreader.KernelNpz" title="pysnptools.kernelreader.KernelNpz"><code class="xref py py-class docutils literal notranslate"><span class="pre">KernelNpz</span></code></a>.
It can also be constructed directly.</p>
<p>See <a class="reference internal" href="#pysnptools.kernelreader.KernelReader" title="pysnptools.kernelreader.KernelReader"><code class="xref py py-class docutils literal notranslate"><span class="pre">KernelReader</span></code></a> for details and examples.</p>
<dl>
<dt><strong>Constructor:</strong></dt><dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>iid</strong> (an array of string pairs) – The <a class="reference internal" href="#pysnptools.kernelreader.KernelReader.iid" title="pysnptools.kernelreader.KernelReader.iid"><code class="xref py py-attr docutils literal notranslate"><span class="pre">KernelReader.iid</span></code></a> information.</p></li>
<li><p><strong>iid0</strong> (an array of string pairs) – The <a class="reference internal" href="#pysnptools.kernelreader.KernelReader.iid0" title="pysnptools.kernelreader.KernelReader.iid0"><code class="xref py py-attr docutils literal notranslate"><span class="pre">KernelReader.iid0</span></code></a> information.</p></li>
<li><p><strong>iid1</strong> (an array of strings pairs) – The <a class="reference internal" href="#pysnptools.kernelreader.KernelReader.iid1" title="pysnptools.kernelreader.KernelReader.iid1"><code class="xref py py-attr docutils literal notranslate"><span class="pre">KernelReader.iid1</span></code></a> information.</p></li>
<li><p><strong>val</strong> (a 2-D array of floats) – The SNP values</p></li>
<li><p><strong>name</strong> (optional, string) – Information to be display about the origin of this data</p></li>
</ul>
</dd>
</dl>
<p>If <em>iid</em> is provided, don’t provide <em>iid0</em> and <em>iid1</em>. Likewise, if <em>iid0</em> and <em>iid1</em> are provided, don’t provide <em>iid</em>.</p>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">print_function</span> <span class="c1">#Python 2 &amp; 3 compatibility</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.kernelreader</span> <span class="k">import</span> <span class="n">KernelData</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kerneldata</span> <span class="o">=</span> <span class="n">KernelData</span><span class="p">(</span><span class="n">iid</span><span class="o">=</span><span class="p">[[</span><span class="s1">&#39;fam0&#39;</span><span class="p">,</span><span class="s1">&#39;iid0&#39;</span><span class="p">],[</span><span class="s1">&#39;fam0&#39;</span><span class="p">,</span><span class="s1">&#39;iid1&#39;</span><span class="p">]],</span> <span class="n">val</span><span class="o">=</span><span class="p">[[</span><span class="mf">1.</span><span class="p">,</span><span class="o">.</span><span class="mi">5</span><span class="p">],[</span><span class="o">.</span><span class="mi">5</span><span class="p">,</span><span class="mf">1.</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">((</span><span class="n">kerneldata</span><span class="o">.</span><span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">kerneldata</span><span class="o">.</span><span class="n">iid_count</span><span class="p">))</span>
<span class="go">(0.5, 2)</span>
</pre></div>
</div>
</dd>
</dl>
<p><strong>Equality:</strong></p>
<blockquote>
<div><p>Two KernelData objects are equal if their three arrays (<a class="reference internal" href="#pysnptools.kernelreader.KernelReader.iid0" title="pysnptools.kernelreader.KernelReader.iid0"><code class="xref py py-attr docutils literal notranslate"><span class="pre">iid0</span></code></a>, <a class="reference internal" href="#pysnptools.kernelreader.KernelReader.iid1" title="pysnptools.kernelreader.KernelReader.iid1"><code class="xref py py-attr docutils literal notranslate"><span class="pre">iid1</span></code></a>, and <a class="reference internal" href="#pysnptools.kernelreader.KernelData.val" title="pysnptools.kernelreader.KernelData.val"><code class="xref py py-attr docutils literal notranslate"><span class="pre">KernelData.val</span></code></a>) are ‘array_equal’.
(Their ‘string’ does not need to be the same).
If either <a class="reference internal" href="#pysnptools.kernelreader.KernelData.val" title="pysnptools.kernelreader.KernelData.val"><code class="xref py py-attr docutils literal notranslate"><span class="pre">KernelData.val</span></code></a> contains NaN, the objects will not be equal. However, <a class="reference internal" href="#pysnptools.kernelreader.KernelData.allclose" title="pysnptools.kernelreader.KernelData.allclose"><code class="xref py py-meth docutils literal notranslate"><span class="pre">KernelData.allclose()</span></code></a> can be used to treat NaN as
regular values.</p>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.kernelreader</span> <span class="k">import</span> <span class="n">KernelData</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kerneldata1</span> <span class="o">=</span> <span class="n">KernelData</span><span class="p">(</span><span class="n">iid</span><span class="o">=</span><span class="p">[[</span><span class="s1">&#39;fam0&#39;</span><span class="p">,</span><span class="s1">&#39;iid0&#39;</span><span class="p">],[</span><span class="s1">&#39;fam0&#39;</span><span class="p">,</span><span class="s1">&#39;iid1&#39;</span><span class="p">]],</span> <span class="n">val</span><span class="o">=</span><span class="p">[[</span><span class="mf">1.</span><span class="p">,</span><span class="o">.</span><span class="mi">5</span><span class="p">],[</span><span class="o">.</span><span class="mi">5</span><span class="p">,</span><span class="mf">1.</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kerneldata2</span> <span class="o">=</span> <span class="n">KernelData</span><span class="p">(</span><span class="n">iid</span><span class="o">=</span><span class="p">[[</span><span class="s1">&#39;fam0&#39;</span><span class="p">,</span><span class="s1">&#39;iid0&#39;</span><span class="p">],[</span><span class="s1">&#39;fam0&#39;</span><span class="p">,</span><span class="s1">&#39;iid1&#39;</span><span class="p">]],</span> <span class="n">val</span><span class="o">=</span><span class="p">[[</span><span class="mf">1.</span><span class="p">,</span><span class="o">.</span><span class="mi">5</span><span class="p">],[</span><span class="o">.</span><span class="mi">5</span><span class="p">,</span><span class="mf">1.</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">kerneldata1</span> <span class="o">==</span> <span class="n">kerneldata2</span><span class="p">)</span> <span class="c1">#True, because all the arrays have the same values.</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">kerneldata1</span><span class="o">.</span><span class="n">val</span> <span class="ow">is</span> <span class="n">kerneldata2</span><span class="o">.</span><span class="n">val</span><span class="p">)</span> <span class="c1">#False, because the two arrays have different memory.</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kerneldata3</span> <span class="o">=</span> <span class="n">KernelData</span><span class="p">(</span><span class="n">iid</span><span class="o">=</span><span class="p">[[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;0&#39;</span><span class="p">],[</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="s1">&#39;0&#39;</span><span class="p">]],</span> <span class="n">val</span><span class="o">=</span><span class="p">[[</span><span class="mf">1.</span><span class="p">,</span><span class="o">.</span><span class="mi">5</span><span class="p">],[</span><span class="o">.</span><span class="mi">5</span><span class="p">,</span><span class="mf">1.</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kerneldata4</span> <span class="o">=</span> <span class="n">KernelData</span><span class="p">(</span><span class="n">iid</span><span class="o">=</span><span class="p">[[</span><span class="s1">&#39;fam0&#39;</span><span class="p">,</span><span class="s1">&#39;iid0&#39;</span><span class="p">],[</span><span class="s1">&#39;fam0&#39;</span><span class="p">,</span><span class="s1">&#39;iid1&#39;</span><span class="p">]],</span> <span class="n">val</span><span class="o">=</span><span class="p">[[</span><span class="mf">1.</span><span class="p">,</span><span class="o">.</span><span class="mi">5</span><span class="p">],[</span><span class="o">.</span><span class="mi">5</span><span class="p">,</span><span class="mf">1.</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">kerneldata3</span> <span class="o">==</span> <span class="n">kerneldata4</span><span class="p">)</span> <span class="c1">#False, because the iids are different.</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kerneldata5</span> <span class="o">=</span> <span class="n">KernelData</span><span class="p">(</span><span class="n">iid</span><span class="o">=</span><span class="p">[[</span><span class="s1">&#39;fam0&#39;</span><span class="p">,</span><span class="s1">&#39;iid0&#39;</span><span class="p">],[</span><span class="s1">&#39;fam0&#39;</span><span class="p">,</span><span class="s1">&#39;iid1&#39;</span><span class="p">]],</span> <span class="n">val</span><span class="o">=</span><span class="p">[[</span><span class="mf">1.</span><span class="p">,</span><span class="o">.</span><span class="mi">5</span><span class="p">],[</span><span class="o">.</span><span class="mi">5</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kerneldata6</span> <span class="o">=</span> <span class="n">KernelData</span><span class="p">(</span><span class="n">iid</span><span class="o">=</span><span class="p">[[</span><span class="s1">&#39;fam0&#39;</span><span class="p">,</span><span class="s1">&#39;iid0&#39;</span><span class="p">],[</span><span class="s1">&#39;fam0&#39;</span><span class="p">,</span><span class="s1">&#39;iid1&#39;</span><span class="p">]],</span> <span class="n">val</span><span class="o">=</span><span class="p">[[</span><span class="mf">1.</span><span class="p">,</span><span class="o">.</span><span class="mi">5</span><span class="p">],[</span><span class="o">.</span><span class="mi">5</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">kerneldata5</span> <span class="o">==</span> <span class="n">kerneldata6</span><span class="p">)</span> <span class="c1">#False, because the val&#39;s contain NaN</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">kerneldata5</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">kerneldata6</span><span class="p">))</span> <span class="c1">#True, if we consider the NaN as regular values, all the arrays have the same values.</span>
<span class="go">True</span>
</pre></div>
</div>
</div></blockquote>
<p><strong>Methods beyond</strong> <a class="reference internal" href="#pysnptools.kernelreader.KernelReader" title="pysnptools.kernelreader.KernelReader"><code class="xref py py-class docutils literal notranslate"><span class="pre">KernelReader</span></code></a></p>
<dl class="py method">
<dt id="pysnptools.kernelreader.KernelData.allclose">
<code class="sig-name descname">allclose</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">value</span></em>, <em class="sig-param"><span class="n">equal_nan</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.kernelreader.KernelData.allclose" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>value</strong> (<a class="reference internal" href="#pysnptools.kernelreader.KernelData" title="pysnptools.kernelreader.KernelData"><code class="xref py py-class docutils literal notranslate"><span class="pre">KernelData</span></code></a>) – Other object with which to compare.</p></li>
<li><p><strong>equal_nan</strong> (<em>bool</em>) – (Default: True) Tells if NaN in <a class="reference internal" href="#pysnptools.kernelreader.KernelData.val" title="pysnptools.kernelreader.KernelData.val"><code class="xref py py-attr docutils literal notranslate"><span class="pre">KernelData.val</span></code></a> should be treated as regular values when testing equality.</p></li>
</ul>
</dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kerneldata5</span> <span class="o">=</span> <span class="n">KernelData</span><span class="p">(</span><span class="n">iid</span><span class="o">=</span><span class="p">[[</span><span class="s1">&#39;fam0&#39;</span><span class="p">,</span><span class="s1">&#39;iid0&#39;</span><span class="p">],[</span><span class="s1">&#39;fam0&#39;</span><span class="p">,</span><span class="s1">&#39;iid1&#39;</span><span class="p">]],</span> <span class="n">val</span><span class="o">=</span><span class="p">[[</span><span class="mf">1.</span><span class="p">,</span><span class="o">.</span><span class="mi">5</span><span class="p">],[</span><span class="o">.</span><span class="mi">5</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kerneldata6</span> <span class="o">=</span> <span class="n">KernelData</span><span class="p">(</span><span class="n">iid</span><span class="o">=</span><span class="p">[[</span><span class="s1">&#39;fam0&#39;</span><span class="p">,</span><span class="s1">&#39;iid0&#39;</span><span class="p">],[</span><span class="s1">&#39;fam0&#39;</span><span class="p">,</span><span class="s1">&#39;iid1&#39;</span><span class="p">]],</span> <span class="n">val</span><span class="o">=</span><span class="p">[[</span><span class="mf">1.</span><span class="p">,</span><span class="o">.</span><span class="mi">5</span><span class="p">],[</span><span class="o">.</span><span class="mi">5</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">kerneldata5</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">kerneldata6</span><span class="p">))</span> <span class="c1">#True, if we consider the NaN as regular values, all the arrays have the same values.</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">kerneldata5</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">kerneldata6</span><span class="p">,</span><span class="n">equal_nan</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span> <span class="c1">#False, if we consider the NaN as special values, all the arrays are not equal.</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="pysnptools.kernelreader.KernelData.standardize">
<code class="sig-name descname">standardize</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">standardizer</span><span class="o">=</span><span class="default_value">DiagKtoN()</span></em>, <em class="sig-param"><span class="n">return_trained</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">force_python_only</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.kernelreader.KernelData.standardize" title="Permalink to this definition">¶</a></dt>
<dd><p>Does in-place standardization of the in-memory
kernel data. The method multiples the values with a scalar factor such that the diagonal sums to iid_count. Although it works in place, for convenience
it also returns the KernelData.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#pysnptools.kernelreader.KernelData" title="pysnptools.kernelreader.KernelData"><code class="xref py py-class docutils literal notranslate"><span class="pre">KernelData</span></code></a> (standardizes in place, but for convenience, returns ‘self’)</p>
</dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.kernelreader</span> <span class="k">import</span> <span class="n">KernelNpz</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.util</span> <span class="k">import</span> <span class="n">example_file</span> <span class="c1"># Download and return local file name</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kernel_file</span> <span class="o">=</span> <span class="n">example_file</span><span class="p">(</span><span class="s1">&#39;pysnptools/examples/toydata.kernel.npz&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kernel_on_disk</span> <span class="o">=</span> <span class="n">KernelNpz</span><span class="p">(</span><span class="n">kernel_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kerneldata1</span> <span class="o">=</span> <span class="n">kernel_on_disk</span><span class="o">.</span><span class="n">read</span><span class="p">()</span> <span class="c1"># read all kernel values into memory</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">kerneldata1</span><span class="o">.</span><span class="n">val</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
<span class="go">5000000.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kerneldata1</span><span class="o">.</span><span class="n">standardize</span><span class="p">()</span> <span class="c1"># standardize changes the values in kerneldata1.val</span>
<span class="go">KernelData(KernelNpz(...pysnptools/examples/toydata.kernel.npz&#39;))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">kerneldata1</span><span class="o">.</span><span class="n">val</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
<span class="go">500.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kerneldata2</span> <span class="o">=</span> <span class="n">kernel_on_disk</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">standardize</span><span class="p">()</span> <span class="c1"># Read and standardize in one expression with only one ndarray allocated.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">kerneldata2</span><span class="o">.</span><span class="n">val</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
<span class="go">500.0</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="pysnptools.kernelreader.KernelData.val">
<em class="property">property </em><code class="sig-name descname">val</code><a class="headerlink" href="#pysnptools.kernelreader.KernelData.val" title="Permalink to this definition">¶</a></dt>
<dd><p>The 2D NumPy array of floats that represents the values of the kernel.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.kernelreader</span> <span class="k">import</span> <span class="n">KernelData</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kerneldata</span> <span class="o">=</span> <span class="n">KernelData</span><span class="p">(</span><span class="n">iid</span><span class="o">=</span><span class="p">[[</span><span class="s1">&#39;fam0&#39;</span><span class="p">,</span><span class="s1">&#39;iid0&#39;</span><span class="p">],[</span><span class="s1">&#39;fam0&#39;</span><span class="p">,</span><span class="s1">&#39;iid1&#39;</span><span class="p">]],</span> <span class="n">val</span><span class="o">=</span><span class="p">[[</span><span class="mf">1.</span><span class="p">,</span><span class="o">.</span><span class="mi">5</span><span class="p">],[</span><span class="o">.</span><span class="mi">5</span><span class="p">,</span><span class="mf">1.</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">((</span><span class="n">kerneldata</span><span class="o">.</span><span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">kerneldata</span><span class="o">.</span><span class="n">iid_count</span><span class="p">))</span>
<span class="go">(0.5, 2)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="kernelreader-kernelnpz">
<h3><code class="xref py py-class docutils literal notranslate"><span class="pre">kernelreader.KernelNpz</span></code><a class="headerlink" href="#kernelreader-kernelnpz" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt id="pysnptools.kernelreader.KernelNpz">
<em class="property">class </em><code class="sig-prename descclassname">pysnptools.kernelreader.</code><code class="sig-name descname">KernelNpz</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.kernelreader.KernelNpz" title="Permalink to this definition">¶</a></dt>
<dd><p>A <a class="reference internal" href="#pysnptools.kernelreader.KernelReader" title="pysnptools.kernelreader.KernelReader"><code class="xref py py-class docutils literal notranslate"><span class="pre">KernelReader</span></code></a> for reading *.kernel.npz files from disk.</p>
<p>See <a class="reference internal" href="#pysnptools.kernelreader.KernelReader" title="pysnptools.kernelreader.KernelReader"><code class="xref py py-class docutils literal notranslate"><span class="pre">KernelReader</span></code></a> for general examples of using KernelReaders.</p>
<p>The general NPZ format is described in <a class="reference external" href="http://docs.scipy.org/doc/numpy/reference/generated/numpy.savez.html">http://docs.scipy.org/doc/numpy/reference/generated/numpy.savez.html</a>. The KernelNpz format stores
val, iid0, and iid1 information in NPZ format.</p>
<dl>
<dt><strong>Constructor:</strong></dt><dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>string</em>) – The KernelNpz file to read.</p></li>
</ul>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">print_function</span> <span class="c1">#Python 2 &amp; 3 compatibility</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.kernelreader</span> <span class="k">import</span> <span class="n">KernelNpz</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.util</span> <span class="k">import</span> <span class="n">example_file</span> <span class="c1"># Download and return local file name</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">npz_file</span> <span class="o">=</span> <span class="n">example_file</span><span class="p">(</span><span class="s1">&#39;pysnptools/examples/toydata.kernel.npz&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data_on_disk</span> <span class="o">=</span> <span class="n">KernelNpz</span><span class="p">(</span><span class="n">npz_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">data_on_disk</span><span class="o">.</span><span class="n">iid_count</span><span class="p">)</span>
<span class="go">500</span>
</pre></div>
</div>
</dd>
</dl>
<p><strong>Methods beyond</strong> <a class="reference internal" href="#pysnptools.kernelreader.KernelReader" title="pysnptools.kernelreader.KernelReader"><code class="xref py py-class docutils literal notranslate"><span class="pre">KernelReader</span></code></a></p>
<dl class="py method">
<dt id="pysnptools.kernelreader.KernelNpz.write">
<em class="property">static </em><code class="sig-name descname">write</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span></em>, <em class="sig-param"><span class="n">kerneldata</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.kernelreader.KernelNpz.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes a <a class="reference internal" href="#pysnptools.kernelreader.KernelData" title="pysnptools.kernelreader.KernelData"><code class="xref py py-class docutils literal notranslate"><span class="pre">KernelData</span></code></a> to KernelNpz format and returns the <a class="reference internal" href="#pysnptools.kernelreader.KernelNpz" title="pysnptools.kernelreader.KernelNpz"><code class="xref py py-class docutils literal notranslate"><span class="pre">KernelNpz</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>string</em>) – the name of the file to create</p></li>
<li><p><strong>kerneldata</strong> (<a class="reference internal" href="#pysnptools.kernelreader.KernelData" title="pysnptools.kernelreader.KernelData"><code class="xref py py-class docutils literal notranslate"><span class="pre">KernelData</span></code></a>) – The in-memory data that should be written to disk.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="#pysnptools.kernelreader.KernelNpz" title="pysnptools.kernelreader.KernelNpz"><code class="xref py py-class docutils literal notranslate"><span class="pre">KernelNpz</span></code></a></p>
</dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.snpreader</span> <span class="k">import</span> <span class="n">Bed</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.standardizer</span> <span class="k">import</span> <span class="n">Unit</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pysnptools.util</span> <span class="k">as</span> <span class="nn">pstutil</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.util</span> <span class="k">import</span> <span class="n">example_file</span> <span class="c1"># Download and return local file name</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bed_file</span> <span class="o">=</span> <span class="n">example_file</span><span class="p">(</span><span class="s1">&#39;pysnptools/examples/toydata.5chrom.*&#39;</span><span class="p">,</span><span class="s1">&#39;*.bed&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kerneldata</span> <span class="o">=</span> <span class="n">Bed</span><span class="p">(</span><span class="n">bed_file</span><span class="p">,</span><span class="n">count_A1</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">read_kernel</span><span class="p">(</span><span class="n">Unit</span><span class="p">())</span>     <span class="c1"># Create a kernel from the data in the Bed file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pstutil</span><span class="o">.</span><span class="n">create_directory_if_necessary</span><span class="p">(</span><span class="s2">&quot;tempdir/toydata.kernel.npz&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">KernelNpz</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;tempdir/toydata.kernel.npz&quot;</span><span class="p">,</span><span class="n">kerneldata</span><span class="p">)</span>      <span class="c1"># Write data in KernelNpz format</span>
<span class="go">KernelNpz(&#39;tempdir/toydata.kernel.npz&#39;)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="kernelreader-kernelhdf5">
<h3><code class="xref py py-class docutils literal notranslate"><span class="pre">kernelreader.KernelHdf5</span></code><a class="headerlink" href="#kernelreader-kernelhdf5" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt id="pysnptools.kernelreader.KernelHdf5">
<em class="property">class </em><code class="sig-prename descclassname">pysnptools.kernelreader.</code><code class="sig-name descname">KernelHdf5</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.kernelreader.KernelHdf5" title="Permalink to this definition">¶</a></dt>
<dd><p>A <a class="reference internal" href="#pysnptools.kernelreader.KernelReader" title="pysnptools.kernelreader.KernelReader"><code class="xref py py-class docutils literal notranslate"><span class="pre">KernelReader</span></code></a> for reading *.kernel.hdf5 files from disk.</p>
<p>See <a class="reference internal" href="#pysnptools.kernelreader.KernelReader" title="pysnptools.kernelreader.KernelReader"><code class="xref py py-class docutils literal notranslate"><span class="pre">KernelReader</span></code></a> for general examples of using KernelReaders.</p>
<p>The general HDF5 format is described in <a class="reference external" href="http://www.hdfgroup.org/HDF5/">http://www.hdfgroup.org/HDF5/</a>. The KernelHdf5 format stores
val, iid, sid, and pos information in Hdf5 format.</p>
<dl>
<dt><strong>Constructor:</strong></dt><dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>string</em>) – The KernelHdf5 file to read.</p></li>
</ul>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">print_function</span> <span class="c1">#Python 2 &amp; 3 compatibility</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.kernelreader</span> <span class="k">import</span> <span class="n">KernelHdf5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.util</span> <span class="k">import</span> <span class="n">example_file</span> <span class="c1"># Download and return local file name</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hdf5_file</span> <span class="o">=</span> <span class="n">example_file</span><span class="p">(</span><span class="s1">&#39;pysnptools/examples/toydata.kernel.hdf5&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data_on_disk</span> <span class="o">=</span> <span class="n">KernelHdf5</span><span class="p">(</span><span class="n">hdf5_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">data_on_disk</span><span class="o">.</span><span class="n">iid_count</span><span class="p">)</span>
<span class="go">500</span>
</pre></div>
</div>
</dd>
</dl>
<p><strong>Methods beyond</strong> <a class="reference internal" href="#pysnptools.kernelreader.KernelReader" title="pysnptools.kernelreader.KernelReader"><code class="xref py py-class docutils literal notranslate"><span class="pre">KernelReader</span></code></a></p>
<dl class="py method">
<dt id="pysnptools.kernelreader.KernelHdf5.write">
<em class="property">static </em><code class="sig-name descname">write</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span></em>, <em class="sig-param"><span class="n">kerneldata</span></em>, <em class="sig-param"><span class="n">hdf5_dtype</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">sid_major</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.kernelreader.KernelHdf5.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes a <a class="reference internal" href="#pysnptools.kernelreader.KernelData" title="pysnptools.kernelreader.KernelData"><code class="xref py py-class docutils literal notranslate"><span class="pre">KernelData</span></code></a> to KernelHdf5 format and returns the <a class="reference internal" href="#pysnptools.kernelreader.KernelHdf5" title="pysnptools.kernelreader.KernelHdf5"><code class="xref py py-class docutils literal notranslate"><span class="pre">KernelHdf5</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>string</em>) – the name of the file to create</p></li>
<li><p><strong>kerneldata</strong> (<a class="reference internal" href="#pysnptools.kernelreader.KernelData" title="pysnptools.kernelreader.KernelData"><code class="xref py py-class docutils literal notranslate"><span class="pre">KernelData</span></code></a>) – The in-memory data that should be written to disk.</p></li>
<li><p><strong>hdf5_dtype</strong> (<em>string</em>) – None (use the .val’s dtype) or a Hdf5 dtype, e.g. ‘f8’,’f4’,etc.</p></li>
<li><p><strong>col_major</strong> (<em>bool</em>) – Tells if vals should be stored on disk in sid_major (default) or iid_major format.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="#pysnptools.kernelreader.KernelHdf5" title="pysnptools.kernelreader.KernelHdf5"><code class="xref py py-class docutils literal notranslate"><span class="pre">KernelHdf5</span></code></a></p>
</dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.snpreader</span> <span class="k">import</span> <span class="n">Bed</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.standardizer</span> <span class="k">import</span> <span class="n">Unit</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pysnptools.util</span> <span class="k">as</span> <span class="nn">pstutil</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.util</span> <span class="k">import</span> <span class="n">example_file</span> <span class="c1"># Download and return local file name</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bed_file</span> <span class="o">=</span> <span class="n">example_file</span><span class="p">(</span><span class="s1">&#39;pysnptools/examples/toydata.5chrom.*&#39;</span><span class="p">,</span><span class="s1">&#39;*.bed&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kerneldata</span> <span class="o">=</span> <span class="n">Bed</span><span class="p">(</span><span class="n">bed_file</span><span class="p">,</span><span class="n">count_A1</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">read_kernel</span><span class="p">(</span><span class="n">Unit</span><span class="p">())</span>     <span class="c1"># Create a kernel from the data in the Bed file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pstutil</span><span class="o">.</span><span class="n">create_directory_if_necessary</span><span class="p">(</span><span class="s2">&quot;tempdir/toydata.kernel.hdf5&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">KernelHdf5</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;tempdir/toydata.kernel.hdf5&quot;</span><span class="p">,</span><span class="n">kerneldata</span><span class="p">)</span>          <span class="c1"># Write data in KernelHdf5 format</span>
<span class="go">KernelHdf5(&#39;tempdir/toydata.kernel.hdf5&#39;)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="kernelreader-identity">
<h3><code class="xref py py-class docutils literal notranslate"><span class="pre">kernelreader.Identity</span></code><a class="headerlink" href="#kernelreader-identity" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt id="pysnptools.kernelreader.Identity">
<em class="property">class </em><code class="sig-prename descclassname">pysnptools.kernelreader.</code><code class="sig-name descname">Identity</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">iid</span></em>, <em class="sig-param"><span class="n">test</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.kernelreader.Identity" title="Permalink to this definition">¶</a></dt>
<dd><p>A <a class="reference internal" href="#pysnptools.kernelreader.KernelReader" title="pysnptools.kernelreader.KernelReader"><code class="xref py py-class docutils literal notranslate"><span class="pre">KernelReader</span></code></a> for that represents an identity matrix. No memory for the values is allocated until <code class="xref py py-meth docutils literal notranslate"><span class="pre">Identity.read()</span></code> is called.</p>
<p>See <a class="reference internal" href="#pysnptools.kernelreader.KernelReader" title="pysnptools.kernelreader.KernelReader"><code class="xref py py-class docutils literal notranslate"><span class="pre">KernelReader</span></code></a> for general examples of using KernelReaders.</p>
<dl>
<dt><strong>Constructor:</strong></dt><dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>iid</strong> (an array of strings) – The <a class="reference internal" href="#pysnptools.kernelreader.KernelReader.iid" title="pysnptools.kernelreader.KernelReader.iid"><code class="xref py py-attr docutils literal notranslate"><span class="pre">KernelReader.iid</span></code></a> information</p></li>
</ul>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">print_function</span> <span class="c1">#Python 2 &amp; 3 compatibility</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.kernelreader</span> <span class="k">import</span> <span class="n">Identity</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">identity</span> <span class="o">=</span> <span class="n">Identity</span><span class="p">(</span><span class="n">iid</span><span class="o">=</span><span class="p">[[</span><span class="s1">&#39;fam0&#39;</span><span class="p">,</span><span class="s1">&#39;iid0&#39;</span><span class="p">],[</span><span class="s1">&#39;fam0&#39;</span><span class="p">,</span><span class="s1">&#39;iid1&#39;</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">identity</span><span class="o">.</span><span class="n">iid_count</span><span class="p">)</span>
<span class="go">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">identity</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">val</span><span class="p">)</span> <span class="c1"># &#39;...&#39; is possible space character</span>
<span class="go">[[...1.  0.]</span>
<span class="go"> [...0.  1.]]</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">identity</span> <span class="o">=</span> <span class="n">Identity</span><span class="p">(</span><span class="n">iid</span><span class="o">=</span><span class="p">[[</span><span class="s1">&#39;fam0&#39;</span><span class="p">,</span><span class="s1">&#39;iid0&#39;</span><span class="p">],[</span><span class="s1">&#39;fam0&#39;</span><span class="p">,</span><span class="s1">&#39;iid1&#39;</span><span class="p">],[</span><span class="s1">&#39;fam0&#39;</span><span class="p">,</span><span class="s1">&#39;iid2&#39;</span><span class="p">]],</span><span class="n">test</span><span class="o">=</span><span class="p">[[</span><span class="s1">&#39;fam0&#39;</span><span class="p">,</span><span class="s1">&#39;iid1&#39;</span><span class="p">],[</span><span class="s1">&#39;fam0&#39;</span><span class="p">,</span><span class="s1">&#39;iid3&#39;</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">((</span><span class="n">identity</span><span class="o">.</span><span class="n">iid0_count</span><span class="p">,</span> <span class="n">identity</span><span class="o">.</span><span class="n">iid1_count</span><span class="p">))</span>
<span class="go">(3, 2)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">identity</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">val</span><span class="p">)</span> <span class="c1"># &#39;...&#39; is possible space character</span>
<span class="go">[[...0.  0.]</span>
<span class="go"> [...1.  0.]</span>
<span class="go"> [...0.  0.]]</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="kernelreader-snpkernel">
<h3><code class="xref py py-class docutils literal notranslate"><span class="pre">kernelreader.SnpKernel</span></code><a class="headerlink" href="#kernelreader-snpkernel" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt id="pysnptools.kernelreader.SnpKernel">
<em class="property">class </em><code class="sig-prename descclassname">pysnptools.kernelreader.</code><code class="sig-name descname">SnpKernel</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">snpreader</span></em>, <em class="sig-param"><span class="n">standardizer</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">block_size</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.kernelreader.SnpKernel" title="Permalink to this definition">¶</a></dt>
<dd><p>A <a class="reference internal" href="#pysnptools.kernelreader.KernelReader" title="pysnptools.kernelreader.KernelReader"><code class="xref py py-class docutils literal notranslate"><span class="pre">KernelReader</span></code></a> that creates a kernel from a <a class="reference internal" href="#pysnptools.snpreader.SnpReader" title="pysnptools.snpreader.SnpReader"><code class="xref py py-class docutils literal notranslate"><span class="pre">SnpReader</span></code></a>. No SNP data will be read until
the <code class="xref py py-meth docutils literal notranslate"><span class="pre">SnpKernel.read()</span></code> method is called. Use block_size to avoid ever reading all the SNP data into memory
at once.</p>
<p>See <a class="reference internal" href="#pysnptools.kernelreader.KernelReader" title="pysnptools.kernelreader.KernelReader"><code class="xref py py-class docutils literal notranslate"><span class="pre">KernelReader</span></code></a> for general examples of using KernelReaders.</p>
<dl>
<dt><strong>Constructor:</strong></dt><dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>snpreader</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">SnpReader</span></code>) – The SNP data</p></li>
<li><p><strong>standardizer</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Standardizer</span></code>) – How the SNP data should be standardized</p></li>
<li><p><strong>block_size</strong> (optional, int) – The number of SNPs to read at a time.</p></li>
</ul>
</dd>
</dl>
<p>If <strong>block_size</strong> is not given, then all SNP data will be read at once.</p>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">print_function</span> <span class="c1">#Python 2 &amp; 3 compatibility</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.snpreader</span> <span class="k">import</span> <span class="n">Bed</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.standardizer</span> <span class="k">import</span> <span class="n">Unit</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.util</span> <span class="k">import</span> <span class="n">example_file</span> <span class="c1"># Download and return local file name</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bed_file</span> <span class="o">=</span> <span class="n">example_file</span><span class="p">(</span><span class="s1">&#39;pysnptools/examples/toydata.5chrom.*&#39;</span><span class="p">,</span><span class="s1">&#39;*.bed&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snp_on_disk</span> <span class="o">=</span> <span class="n">Bed</span><span class="p">(</span><span class="n">bed_file</span><span class="p">,</span><span class="n">count_A1</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>     <span class="c1"># A Bed file is specified, but nothing is read from disk</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kernel_on_disk</span> <span class="o">=</span> <span class="n">SnpKernel</span><span class="p">(</span><span class="n">snp_on_disk</span><span class="p">,</span> <span class="n">Unit</span><span class="p">(),</span><span class="n">block_size</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>  <span class="c1"># A kernel is specified, but nothing is read from disk</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">kernel_on_disk</span><span class="p">)</span> <span class="c1">#Print the specification</span>
<span class="go">SnpKernel(Bed(...pysnptools/examples/toydata.5chrom.bed&#39;,count_A1=False),standardizer=Unit(),block_size=500)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">kernel_on_disk</span><span class="o">.</span><span class="n">iid_count</span><span class="p">)</span>                                  <span class="c1"># iid information is read from disk, but not SNP data</span>
<span class="go">500</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kerneldata</span> <span class="o">=</span> <span class="n">kernel_on_disk</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">standardize</span><span class="p">()</span>                <span class="c1"># SNPs are read and Unit standardized, 500 at a time, to create a kernel, which is then standardized</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0:.6f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">kerneldata</span><span class="o">.</span><span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]))</span>
<span class="go">0.992307</span>
</pre></div>
</div>
</dd>
</dl>
<dl class="py method">
<dt id="pysnptools.kernelreader.SnpKernel.pos">
<em class="property">property </em><code class="sig-name descname">pos</code><a class="headerlink" href="#pysnptools.kernelreader.SnpKernel.pos" title="Permalink to this definition">¶</a></dt>
<dd><p>The <a class="reference internal" href="#pysnptools.snpreader.SnpReader.pos" title="pysnptools.snpreader.SnpReader.pos"><code class="xref py py-attr docutils literal notranslate"><span class="pre">SnpReader.pos</span></code></a> property of the SNP data.</p>
</dd></dl>

<dl class="py method">
<dt id="pysnptools.kernelreader.SnpKernel.read_snps">
<code class="sig-name descname">read_snps</code><span class="sig-paren">(</span><em class="sig-param">order='F'</em>, <em class="sig-param">dtype=&lt;class 'numpy.float64'&gt;</em>, <em class="sig-param">force_python_only=False</em>, <em class="sig-param">view_ok=False</em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.kernelreader.SnpKernel.read_snps" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads the SNP values, applies the standardizer, and returns a <a class="reference internal" href="#pysnptools.snpreader.SnpData" title="pysnptools.snpreader.SnpData"><code class="xref py py-class docutils literal notranslate"><span class="pre">SnpData</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>order</strong> (<em>string</em><em> or </em><em>None</em>) – {‘F’ (default), ‘C’, ‘A’}, optional – Specify the order of the ndarray. If order is ‘F’ (default),
then the array will be in F-contiguous order (iid-index varies the fastest).
If order is ‘C’, then the returned array will be in C-contiguous order (sid-index varies the fastest).
If order is ‘A’, then the <a class="reference internal" href="#pysnptools.snpreader.SnpData.val" title="pysnptools.snpreader.SnpData.val"><code class="xref py py-attr docutils literal notranslate"><span class="pre">SnpData.val</span></code></a>
ndarray may be in any order (either C-, Fortran-contiguous).</p></li>
<li><p><strong>dtype</strong> (<em>data-type</em>) – {scipy.float64 (default), scipy.float32}, optional – The data-type for the <a class="reference internal" href="#pysnptools.snpreader.SnpData.val" title="pysnptools.snpreader.SnpData.val"><code class="xref py py-attr docutils literal notranslate"><span class="pre">SnpData.val</span></code></a> ndarray.</p></li>
<li><p><strong>force_python_only</strong> (<em>bool</em>) – optional – If False (default), may use outside library code. If True, requests that the read
be done without outside library code.</p></li>
<li><p><strong>view_ok</strong> (<em>bool</em>) – optional – If False (default), allocates new memory for the <a class="reference internal" href="#pysnptools.snpreader.SnpData.val" title="pysnptools.snpreader.SnpData.val"><code class="xref py py-attr docutils literal notranslate"><span class="pre">SnpData.val</span></code></a>’s ndarray. If True,
if practical and reading from a <code class="xref py py-class docutils literal notranslate"><span class="pre">SnpData</span></code>, will return a new 
<code class="xref py py-class docutils literal notranslate"><span class="pre">SnpData</span></code> with a ndarray shares memory with the original <code class="xref py py-class docutils literal notranslate"><span class="pre">SnpData</span></code>.
Typically, you’ll also wish to use “order=’A’” to increase the chance that sharing will be possible.
Use these parameters with care because any change to either ndarray (for example, via <a class="reference internal" href="#pysnptools.snpreader.SnpData.standardize" title="pysnptools.snpreader.SnpData.standardize"><code class="xref py py-meth docutils literal notranslate"><span class="pre">SnpData.standardize()</span></code></a>) will effect
the others. Also keep in mind that <code class="xref py py-meth docutils literal notranslate"><span class="pre">read()</span></code> relies on ndarray’s mechanisms to decide whether to actually
share memory and so it may ignore your suggestion and allocate a new ndarray anyway.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="#pysnptools.snpreader.SnpData" title="pysnptools.snpreader.SnpData"><code class="xref py py-class docutils literal notranslate"><span class="pre">SnpData</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pysnptools.kernelreader.SnpKernel.sid">
<em class="property">property </em><code class="sig-name descname">sid</code><a class="headerlink" href="#pysnptools.kernelreader.SnpKernel.sid" title="Permalink to this definition">¶</a></dt>
<dd><p>The <a class="reference internal" href="#pysnptools.snpreader.SnpReader.sid" title="pysnptools.snpreader.SnpReader.sid"><code class="xref py py-attr docutils literal notranslate"><span class="pre">SnpReader.sid</span></code></a> property of the SNP data.</p>
</dd></dl>

<dl class="py method">
<dt id="pysnptools.kernelreader.SnpKernel.sid_count">
<em class="property">property </em><code class="sig-name descname">sid_count</code><a class="headerlink" href="#pysnptools.kernelreader.SnpKernel.sid_count" title="Permalink to this definition">¶</a></dt>
<dd><p>The <a class="reference internal" href="#pysnptools.snpreader.SnpReader.sid_count" title="pysnptools.snpreader.SnpReader.sid_count"><code class="xref py py-attr docutils literal notranslate"><span class="pre">SnpReader.sid_count</span></code></a> property of the SNP data.</p>
</dd></dl>

</dd></dl>

</div>
</div>
<div class="section" id="module-pysnptools.standardizer">
<span id="standardizer-module"></span><h2><code class="xref py py-mod docutils literal notranslate"><span class="pre">standardizer</span></code> Module<a class="headerlink" href="#module-pysnptools.standardizer" title="Permalink to this headline">¶</a></h2>
<div class="section" id="standardizer-standardizer">
<h3><code class="xref py py-class docutils literal notranslate"><span class="pre">standardizer.Standardizer</span></code><a class="headerlink" href="#standardizer-standardizer" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt id="pysnptools.standardizer.Standardizer">
<em class="property">class </em><code class="sig-prename descclassname">pysnptools.standardizer.</code><code class="sig-name descname">Standardizer</code><a class="headerlink" href="#pysnptools.standardizer.Standardizer" title="Permalink to this definition">¶</a></dt>
<dd><p>A Standardizer is a class such as <a class="reference internal" href="#pysnptools.standardizer.Unit" title="pysnptools.standardizer.Unit"><code class="xref py py-class docutils literal notranslate"><span class="pre">Unit</span></code></a> and <a class="reference internal" href="#pysnptools.standardizer.Beta" title="pysnptools.standardizer.Beta"><code class="xref py py-class docutils literal notranslate"><span class="pre">Beta</span></code></a> to be used by the <a class="reference internal" href="#pysnptools.snpreader.SnpData.standardize" title="pysnptools.snpreader.SnpData.standardize"><code class="xref py py-meth docutils literal notranslate"><span class="pre">SnpData.standardize()</span></code></a> and <a class="reference internal" href="#pysnptools.snpreader.SnpReader.read_kernel" title="pysnptools.snpreader.SnpReader.read_kernel"><code class="xref py py-meth docutils literal notranslate"><span class="pre">SnpReader.read_kernel()</span></code></a> method to standardize SNP data.</p>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<p>Read and standardize SNP data.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">print_function</span> <span class="c1">#Python 2 &amp; 3 compatibility</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">six.moves</span> <span class="k">import</span> <span class="nb">range</span> <span class="c1">#Python 2 &amp; 3 compatibility</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.standardizer</span> <span class="k">import</span> <span class="n">Unit</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.snpreader</span> <span class="k">import</span> <span class="n">Bed</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.util</span> <span class="k">import</span> <span class="n">example_file</span> <span class="c1"># Download and return local file name</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bedfile</span> <span class="o">=</span> <span class="n">example_file</span><span class="p">(</span><span class="s2">&quot;tests/datasets/all_chr.maf0.001.N300.*&quot;</span><span class="p">,</span><span class="s2">&quot;*.bed&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snpdata1</span> <span class="o">=</span> <span class="n">Bed</span><span class="p">(</span><span class="n">bedfile</span><span class="p">,</span><span class="n">count_A1</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">standardize</span><span class="p">(</span><span class="n">Unit</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0:.6f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">snpdata1</span><span class="o">.</span><span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]))</span>
<span class="go">0.229416</span>
</pre></div>
</div>
<p>Create a kernel from SNP data on disk.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">kerneldata</span> <span class="o">=</span> <span class="n">Bed</span><span class="p">(</span><span class="s1">&#39;../examples/toydata.bed&#39;</span><span class="p">,</span><span class="n">count_A1</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">read_kernel</span><span class="p">(</span><span class="n">Unit</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0:.6f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">kerneldata</span><span class="o">.</span><span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]))</span>
<span class="go">9923.069928</span>
</pre></div>
</div>
<p>Can also return a constant SNP standardizer that can be applied to other <a class="reference internal" href="#pysnptools.snpreader.SnpData" title="pysnptools.snpreader.SnpData"><code class="xref py py-class docutils literal notranslate"><span class="pre">SnpData</span></code></a>.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">snp_whole</span> <span class="o">=</span> <span class="n">Bed</span><span class="p">(</span><span class="n">bedfile</span><span class="p">,</span><span class="n">count_A1</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">train_idx</span><span class="p">,</span> <span class="n">test_idx</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="n">snp_whole</span><span class="o">.</span><span class="n">iid_count</span><span class="p">),</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span> <span class="c1">#test on the first 10, train on the rest</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snp_train</span><span class="p">,</span> <span class="n">trained_standardizer</span> <span class="o">=</span> <span class="n">Unit</span><span class="p">()</span><span class="o">.</span><span class="n">standardize</span><span class="p">(</span><span class="n">snp_whole</span><span class="p">[</span><span class="n">train_idx</span><span class="p">,:]</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span><span class="n">return_trained</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0:.6f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">snp_train</span><span class="o">.</span><span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]))</span>
<span class="go">0.233550</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">trained_standardizer</span><span class="o">.</span><span class="n">stats</span><span class="p">[</span><span class="mi">0</span><span class="p">,:])</span> <span class="c1">#The mean and stddev of the 1st SNP on the training data # &#39;...&#39; for a possible space character</span>
<span class="go">[...1.94827586  0.22146953]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snp_test</span> <span class="o">=</span> <span class="n">snp_whole</span><span class="p">[</span><span class="n">test_idx</span><span class="p">,:]</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">standardize</span><span class="p">(</span><span class="n">trained_standardizer</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snp_test</span><span class="o">.</span><span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
<span class="go">0.23354968324845735</span>
</pre></div>
</div>
<p>Standardize any Numpy array.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">val</span> <span class="o">=</span> <span class="n">Bed</span><span class="p">(</span><span class="n">bedfile</span><span class="p">,</span><span class="n">count_A1</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">val</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="go">2.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">val</span> <span class="o">=</span> <span class="n">Unit</span><span class="p">()</span><span class="o">.</span><span class="n">standardize</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0:.6f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]))</span>
<span class="go">0.229416</span>
</pre></div>
</div>
<p>Details of Methods &amp; Properties:</p>
<dl class="py method">
<dt id="pysnptools.standardizer.Standardizer.is_constant">
<em class="property">property </em><code class="sig-name descname">is_constant</code><a class="headerlink" href="#pysnptools.standardizer.Standardizer.is_constant" title="Permalink to this definition">¶</a></dt>
<dd><p>Tell if a standardizer’s statistics are constant. For example, <code class="xref py py-class docutils literal notranslate"><span class="pre">Unit_Trained</span></code> contains a pre-specified mean and stddev for each SNP, so <code class="xref py py-attr docutils literal notranslate"><span class="pre">Unit_Trained.is_constant</span></code> is True.
<a class="reference internal" href="#pysnptools.standardizer.Unit" title="pysnptools.standardizer.Unit"><code class="xref py py-class docutils literal notranslate"><span class="pre">Unit</span></code></a>, on the other hand, measures the mean and stddev for each SNP, so <code class="xref py py-attr docutils literal notranslate"><span class="pre">Unit.is_constant</span></code> is False.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pysnptools.standardizer.Standardizer.standardize">
<code class="sig-name descname">standardize</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">snps</span></em>, <em class="sig-param"><span class="n">block_size</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">return_trained</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">force_python_only</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.standardizer.Standardizer.standardize" title="Permalink to this definition">¶</a></dt>
<dd><p>Applies standardization, in place, to <a class="reference internal" href="#pysnptools.snpreader.SnpData" title="pysnptools.snpreader.SnpData"><code class="xref py py-class docutils literal notranslate"><span class="pre">SnpData</span></code></a> (or a NumPy array). For convenience also returns the <a class="reference internal" href="#pysnptools.snpreader.SnpData" title="pysnptools.snpreader.SnpData"><code class="xref py py-class docutils literal notranslate"><span class="pre">SnpData</span></code></a> (or a NumPy array).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>snps</strong> (<a class="reference internal" href="#pysnptools.snpreader.SnpData" title="pysnptools.snpreader.SnpData"><code class="xref py py-class docutils literal notranslate"><span class="pre">SnpData</span></code></a> (or a NumPy array)) – SNP values to standardize</p></li>
<li><p><strong>block_size</strong> (<em>None</em>) – <em>Not used</em></p></li>
<li><p><strong>return_trained</strong> (<em>bool</em>) – If true, returns a second value containing a constant standardizer trained on this data.</p></li>
<li><p><strong>force_python_only</strong> (<em>bool</em>) – optional – If False (default), may use outside library code. If True, requests that the read
be done without outside library code.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="#pysnptools.snpreader.SnpData" title="pysnptools.snpreader.SnpData"><code class="xref py py-class docutils literal notranslate"><span class="pre">SnpData</span></code></a> (or a NumPy array), (optional) constant <a class="reference internal" href="#pysnptools.standardizer.Standardizer" title="pysnptools.standardizer.Standardizer"><code class="xref py py-class docutils literal notranslate"><span class="pre">Standardizer</span></code></a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="standardizer-unit">
<h3><code class="xref py py-class docutils literal notranslate"><span class="pre">standardizer.Unit</span></code><a class="headerlink" href="#standardizer-unit" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt id="pysnptools.standardizer.Unit">
<em class="property">class </em><code class="sig-prename descclassname">pysnptools.standardizer.</code><code class="sig-name descname">Unit</code><a class="headerlink" href="#pysnptools.standardizer.Unit" title="Permalink to this definition">¶</a></dt>
<dd><p>A <a class="reference internal" href="#pysnptools.standardizer.Standardizer" title="pysnptools.standardizer.Standardizer"><code class="xref py py-class docutils literal notranslate"><span class="pre">Standardizer</span></code></a> to unit standardize SNP data. For each sid, the mean of the values is zero with standard deviation 1.
NaN values are then filled with zero, the mean (consequently, if there are NaN values, the final standard deviation will not be zero.</p>
<p>See <a class="reference internal" href="#pysnptools.standardizer.Standardizer" title="pysnptools.standardizer.Standardizer"><code class="xref py py-class docutils literal notranslate"><span class="pre">Standardizer</span></code></a> for more information about standardization.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">print_function</span> <span class="c1">#Python 2 &amp; 3 compatibility</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.standardizer</span> <span class="k">import</span> <span class="n">Unit</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.snpreader</span> <span class="k">import</span> <span class="n">Bed</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.util</span> <span class="k">import</span> <span class="n">example_file</span> <span class="c1"># Download and return local file name</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bedfile</span> <span class="o">=</span> <span class="n">example_file</span><span class="p">(</span><span class="s2">&quot;tests/datasets/all_chr.maf0.001.N300.*&quot;</span><span class="p">,</span><span class="s2">&quot;*.bed&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snpdata1</span> <span class="o">=</span> <span class="n">Bed</span><span class="p">(</span><span class="n">bedfile</span><span class="p">,</span><span class="n">count_A1</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">standardize</span><span class="p">(</span><span class="n">Unit</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0:.6f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">snpdata1</span><span class="o">.</span><span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]))</span>
<span class="go">0.229416</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="standardizer-beta">
<h3><code class="xref py py-class docutils literal notranslate"><span class="pre">standardizer.Beta</span></code><a class="headerlink" href="#standardizer-beta" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt id="pysnptools.standardizer.Beta">
<em class="property">class </em><code class="sig-prename descclassname">pysnptools.standardizer.</code><code class="sig-name descname">Beta</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">a</span></em>, <em class="sig-param"><span class="n">b</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.standardizer.Beta" title="Permalink to this definition">¶</a></dt>
<dd><p>A <a class="reference internal" href="#pysnptools.standardizer.Standardizer" title="pysnptools.standardizer.Standardizer"><code class="xref py py-class docutils literal notranslate"><span class="pre">Standardizer</span></code></a> to beta standardize SNP data.</p>
<p>See <a class="reference internal" href="#pysnptools.standardizer.Standardizer" title="pysnptools.standardizer.Standardizer"><code class="xref py py-class docutils literal notranslate"><span class="pre">Standardizer</span></code></a> for more information about standardization.</p>
<dl class="simple">
<dt><strong>Constructor:</strong></dt><dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> (<em>float</em>) – The <em>a</em> parameter of the beta distribution</p></li>
<li><p><strong>b</strong> (<em>float</em>) – The <em>b</em> parameter of the beta distribution</p></li>
</ul>
</dd>
</dl>
</dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">print_function</span> <span class="c1">#Python 2 &amp; 3 compatibility</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.standardizer</span> <span class="k">import</span> <span class="n">Beta</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.snpreader</span> <span class="k">import</span> <span class="n">Bed</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.util</span> <span class="k">import</span> <span class="n">example_file</span> <span class="c1"># Download and return local file name</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bedfile</span> <span class="o">=</span> <span class="n">example_file</span><span class="p">(</span><span class="s2">&quot;tests/datasets/all_chr.maf0.001.N300.*&quot;</span><span class="p">,</span><span class="s2">&quot;*.bed&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snpdata1</span> <span class="o">=</span> <span class="n">Bed</span><span class="p">(</span><span class="n">bedfile</span><span class="p">,</span><span class="n">count_A1</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">standardize</span><span class="p">(</span><span class="n">Beta</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">25</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0:.6f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">snpdata1</span><span class="o">.</span><span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]))</span>
<span class="go">0.680802</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="standardizer-identity">
<h3><code class="xref py py-class docutils literal notranslate"><span class="pre">standardizer.Identity</span></code><a class="headerlink" href="#standardizer-identity" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt id="pysnptools.standardizer.Identity">
<em class="property">class </em><code class="sig-prename descclassname">pysnptools.standardizer.</code><code class="sig-name descname">Identity</code><a class="headerlink" href="#pysnptools.standardizer.Identity" title="Permalink to this definition">¶</a></dt>
<dd><p>A <a class="reference internal" href="#pysnptools.standardizer.Standardizer" title="pysnptools.standardizer.Standardizer"><code class="xref py py-class docutils literal notranslate"><span class="pre">Standardizer</span></code></a> that does nothing to SNP data.</p>
<p>See <a class="reference internal" href="#pysnptools.standardizer.Standardizer" title="pysnptools.standardizer.Standardizer"><code class="xref py py-class docutils literal notranslate"><span class="pre">Standardizer</span></code></a> for more information about standardization.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">print_function</span> <span class="c1">#Python 2 &amp; 3 compatibility</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.standardizer</span> <span class="k">import</span> <span class="n">Identity</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.snpreader</span> <span class="k">import</span> <span class="n">Bed</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.util</span> <span class="k">import</span> <span class="n">example_file</span> <span class="c1"># Download and return local file name</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bedfile</span> <span class="o">=</span> <span class="n">example_file</span><span class="p">(</span><span class="s2">&quot;tests/datasets/all_chr.maf0.001.N300.*&quot;</span><span class="p">,</span><span class="s2">&quot;*.bed&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snpdata1</span> <span class="o">=</span> <span class="n">Bed</span><span class="p">(</span><span class="n">bedfile</span><span class="p">,</span><span class="n">count_A1</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">snpdata1</span><span class="o">.</span><span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="go">2.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snpdata1</span> <span class="o">=</span> <span class="n">snpdata1</span><span class="o">.</span><span class="n">standardize</span><span class="p">(</span><span class="n">Identity</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">snpdata1</span><span class="o">.</span><span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="go">2.0</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="standardizer-diagkton">
<h3><code class="xref py py-class docutils literal notranslate"><span class="pre">standardizer.DiagKtoN</span></code><a class="headerlink" href="#standardizer-diagkton" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt id="pysnptools.standardizer.DiagKtoN">
<em class="property">class </em><code class="sig-prename descclassname">pysnptools.standardizer.</code><code class="sig-name descname">DiagKtoN</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">deprecated_iid_count</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.standardizer.DiagKtoN" title="Permalink to this definition">¶</a></dt>
<dd><p>Both a <a class="reference internal" href="#pysnptools.standardizer.Standardizer" title="pysnptools.standardizer.Standardizer"><code class="xref py py-class docutils literal notranslate"><span class="pre">Standardizer</span></code></a> and a A <a class="reference internal" href="#pysnptools.kernelstandardizer.KernelStandardizer" title="pysnptools.kernelstandardizer.KernelStandardizer"><code class="xref py py-class docutils literal notranslate"><span class="pre">KernelStandardizer</span></code></a>.</p>
<p>When applied to a <a class="reference internal" href="#pysnptools.snpreader.SnpData" title="pysnptools.snpreader.SnpData"><code class="xref py py-class docutils literal notranslate"><span class="pre">SnpData</span></code></a>, it multiplies the SNP values by the square root of a factor such that a kernel
constructed from the SNP values will have a diagonal that sums to iid_count. This class thus
standardizes the kernel before it is even constructed.</p>
<p>When applied to a <a class="reference internal" href="#pysnptools.kernelreader.KernelData" title="pysnptools.kernelreader.KernelData"><code class="xref py py-class docutils literal notranslate"><span class="pre">KernelData</span></code></a>, it multiplies the kernel values by the a factor such that a kernel
will have a diagonal that sums to iid_count.</p>
<p>See <a class="reference internal" href="#pysnptools.standardizer.Standardizer" title="pysnptools.standardizer.Standardizer"><code class="xref py py-class docutils literal notranslate"><span class="pre">Standardizer</span></code></a> for more information about standardization.</p>
<dl class="simple">
<dt><strong>Constructor:</strong></dt><dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>deprecated_iid_count</strong> (<em>int</em>) (optional) – Deprecated.</p></li>
</ul>
</dd>
</dl>
</dd>
</dl>
<p>Example of DiagKtoN to <a class="reference internal" href="#pysnptools.snpreader.SnpData" title="pysnptools.snpreader.SnpData"><code class="xref py py-class docutils literal notranslate"><span class="pre">SnpData</span></code></a>:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">print_function</span> <span class="c1">#Python 2 &amp; 3 compatibility</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.standardizer</span> <span class="k">import</span> <span class="n">DiagKtoN</span><span class="p">,</span> <span class="n">Unit</span><span class="p">,</span> <span class="n">Identity</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.snpreader</span> <span class="k">import</span> <span class="n">Bed</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.util</span> <span class="k">import</span> <span class="n">example_file</span> <span class="c1"># Download and return local file name</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bedfile</span> <span class="o">=</span> <span class="n">example_file</span><span class="p">(</span><span class="s2">&quot;tests/datasets/all_chr.maf0.001.N300.*&quot;</span><span class="p">,</span><span class="s2">&quot;*.bed&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snpdata1</span> <span class="o">=</span> <span class="n">Bed</span><span class="p">(</span><span class="n">bedfile</span><span class="p">,</span><span class="n">count_A1</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">standardize</span><span class="p">(</span><span class="n">Unit</span><span class="p">())</span><span class="o">.</span><span class="n">standardize</span><span class="p">(</span><span class="n">DiagKtoN</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kernel1</span> <span class="o">=</span> <span class="n">snpdata1</span><span class="o">.</span><span class="n">read_kernel</span><span class="p">(</span><span class="n">Identity</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0:.6f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">kernel1</span><span class="o">.</span><span class="n">val</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()))</span>
<span class="go">300.000000</span>
</pre></div>
</div>
<p>Example of DiagKtoN to <a class="reference internal" href="#pysnptools.kernelreader.KernelData" title="pysnptools.kernelreader.KernelData"><code class="xref py py-class docutils literal notranslate"><span class="pre">KernelData</span></code></a>:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.standardizer</span> <span class="k">import</span> <span class="n">DiagKtoN</span><span class="p">,</span> <span class="n">Unit</span><span class="p">,</span> <span class="n">Identity</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.snpreader</span> <span class="k">import</span> <span class="n">Bed</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.util</span> <span class="k">import</span> <span class="n">example_file</span> <span class="c1"># Download and return local file name</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bedfile</span> <span class="o">=</span> <span class="n">example_file</span><span class="p">(</span><span class="s2">&quot;tests/datasets/all_chr.maf0.001.N300.*&quot;</span><span class="p">,</span><span class="s2">&quot;*.bed&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snpdata1</span> <span class="o">=</span> <span class="n">Bed</span><span class="p">(</span><span class="n">bedfile</span><span class="p">,</span><span class="n">count_A1</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">standardize</span><span class="p">(</span><span class="n">Unit</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kernel1</span> <span class="o">=</span> <span class="n">snpdata1</span><span class="o">.</span><span class="n">read_kernel</span><span class="p">(</span><span class="n">DiagKtoN</span><span class="p">(),</span><span class="n">block_size</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0:.6f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">kernel1</span><span class="o">.</span><span class="n">val</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()))</span>
<span class="go">300.000000</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="standardizer-unittrained">
<h3><code class="xref py py-class docutils literal notranslate"><span class="pre">standardizer.UnitTrained</span></code><a class="headerlink" href="#standardizer-unittrained" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt id="pysnptools.standardizer.UnitTrained">
<em class="property">class </em><code class="sig-prename descclassname">pysnptools.standardizer.</code><code class="sig-name descname">UnitTrained</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">sid</span></em>, <em class="sig-param"><span class="n">stats</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.standardizer.UnitTrained" title="Permalink to this definition">¶</a></dt>
<dd><p>A <a class="reference internal" href="#pysnptools.standardizer.Standardizer" title="pysnptools.standardizer.Standardizer"><code class="xref py py-class docutils literal notranslate"><span class="pre">Standardizer</span></code></a> to unit standardize one set of SNP data based on the mean and stddev of another set of SNP data.
NaN values are then filled with zero.</p>
<p>See <a class="reference internal" href="#pysnptools.standardizer.Standardizer" title="pysnptools.standardizer.Standardizer"><code class="xref py py-class docutils literal notranslate"><span class="pre">Standardizer</span></code></a> for more information about standardization.</p>
<dl class="simple">
<dt><strong>Constructor:</strong></dt><dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>stats</strong> (<em>ndarray of float</em>) – The mean and stddev of each sid</p></li>
</ul>
</dd>
</dl>
</dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">print_function</span> <span class="c1">#Python 2 &amp; 3 compatibility</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.standardizer</span> <span class="k">import</span> <span class="n">Unit</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.snpreader</span> <span class="k">import</span> <span class="n">Bed</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.util</span> <span class="k">import</span> <span class="n">example_file</span> <span class="c1"># Download and return local file name</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bedfile</span> <span class="o">=</span> <span class="n">example_file</span><span class="p">(</span><span class="s2">&quot;tests/datasets/all_chr.maf0.001.N300.*&quot;</span><span class="p">,</span><span class="s2">&quot;*.bed&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">train</span> <span class="o">=</span> <span class="n">Bed</span><span class="p">(</span><span class="n">bedfile</span><span class="p">,</span><span class="n">count_A1</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="mi">1</span><span class="p">:,:]</span><span class="o">.</span><span class="n">read</span><span class="p">()</span> <span class="c1"># read SNP values for all but the first iid</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_</span><span class="p">,</span> <span class="n">unittrained</span> <span class="o">=</span> <span class="n">train</span><span class="o">.</span><span class="n">standardize</span><span class="p">(</span><span class="n">Unit</span><span class="p">(),</span><span class="n">return_trained</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1">#Unit standardize and remember the mean and stddev of each sid</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">unittrained</span><span class="o">.</span><span class="n">stats</span><span class="p">[:</span><span class="mi">5</span><span class="p">,:])</span> <span class="c1">#Print the means and stddev of the first five sids</span>
<span class="go">[[...1.94983278  0.21828988]</span>
<span class="go"> [...1.96989967  0.17086341]</span>
<span class="go"> [...1.84280936  0.39057474]</span>
<span class="go"> [...1.99665552  0.0577347 ]</span>
<span class="go"> [...1.97658863  0.15120608]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">test</span> <span class="o">=</span> <span class="n">Bed</span><span class="p">(</span><span class="n">bedfile</span><span class="p">,</span><span class="n">count_A1</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="mi">0</span><span class="p">,:]</span><span class="o">.</span><span class="n">read</span><span class="p">()</span> <span class="c1"># read SNP values for the first iid</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">test</span> <span class="o">=</span> <span class="n">test</span><span class="o">.</span><span class="n">standardize</span><span class="p">(</span><span class="n">unittrained</span><span class="p">)</span> <span class="c1"># Use the mean and stddev of the train data to unit standardize the test data.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0:.6f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">test</span><span class="o">.</span><span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]))</span>
<span class="go">0.229819</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="standardizer-diagktontrained">
<h3><code class="xref py py-class docutils literal notranslate"><span class="pre">standardizer.DiagKtoNTrained</span></code><a class="headerlink" href="#standardizer-diagktontrained" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt id="pysnptools.standardizer.DiagKtoNTrained">
<em class="property">class </em><code class="sig-prename descclassname">pysnptools.standardizer.</code><code class="sig-name descname">DiagKtoNTrained</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">factor</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.standardizer.DiagKtoNTrained" title="Permalink to this definition">¶</a></dt>
<dd><p>Both a <a class="reference internal" href="#pysnptools.standardizer.Standardizer" title="pysnptools.standardizer.Standardizer"><code class="xref py py-class docutils literal notranslate"><span class="pre">Standardizer</span></code></a> and a A <a class="reference internal" href="#pysnptools.kernelstandardizer.KernelStandardizer" title="pysnptools.kernelstandardizer.KernelStandardizer"><code class="xref py py-class docutils literal notranslate"><span class="pre">KernelStandardizer</span></code></a>.</p>
<p>When applied to a <a class="reference internal" href="#pysnptools.snpreader.SnpData" title="pysnptools.snpreader.SnpData"><code class="xref py py-class docutils literal notranslate"><span class="pre">SnpData</span></code></a>, DiagKtoN standardizes one set of SNP data based on another set of SNP data.</p>
<p>When applied to a <a class="reference internal" href="#pysnptools.kernelreader.KernelData" title="pysnptools.kernelreader.KernelData"><code class="xref py py-class docutils literal notranslate"><span class="pre">KernelData</span></code></a>, DiagKtoN standardizes one kernel data based on another kernel data.</p>
<p>See <a class="reference internal" href="#pysnptools.standardizer.Standardizer" title="pysnptools.standardizer.Standardizer"><code class="xref py py-class docutils literal notranslate"><span class="pre">Standardizer</span></code></a> for more information about standardization.</p>
<dl class="simple">
<dt><strong>Constructor:</strong></dt><dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>factor</strong> (<em>float</em>) – The number what when multiplied into the kernel values will make the diagonal of the kernel values to  sum to iid_count.</p></li>
</ul>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</div>
</div>
<div class="section" id="kernelstandardizer-module">
<h2><code class="xref py py-mod docutils literal notranslate"><span class="pre">kernelstandardizer</span></code> Module<a class="headerlink" href="#kernelstandardizer-module" title="Permalink to this headline">¶</a></h2>
<div class="section" id="kernelstandardizer-kernelstandardizer">
<h3><code class="xref py py-class docutils literal notranslate"><span class="pre">kernelstandardizer.KernelStandardizer</span></code><a class="headerlink" href="#kernelstandardizer-kernelstandardizer" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt id="pysnptools.kernelstandardizer.KernelStandardizer">
<em class="property">class </em><code class="sig-prename descclassname">pysnptools.kernelstandardizer.</code><code class="sig-name descname">KernelStandardizer</code><a class="headerlink" href="#pysnptools.kernelstandardizer.KernelStandardizer" title="Permalink to this definition">¶</a></dt>
<dd><p>A KernelStandardizer is a class such as <a class="reference internal" href="#pysnptools.kernelstandardizer.DiagKtoN" title="pysnptools.kernelstandardizer.DiagKtoN"><code class="xref py py-class docutils literal notranslate"><span class="pre">DiagKtoN</span></code></a> and <a class="reference internal" href="#pysnptools.kernelstandardizer.Identity" title="pysnptools.kernelstandardizer.Identity"><code class="xref py py-class docutils literal notranslate"><span class="pre">Identity</span></code></a> to be used by the <a class="reference internal" href="#pysnptools.kernelreader.KernelData.standardize" title="pysnptools.kernelreader.KernelData.standardize"><code class="xref py py-meth docutils literal notranslate"><span class="pre">KernelData.standardize()</span></code></a> to standardize Kernel data.
It always works in-place <em>and</em> returns the <a class="reference internal" href="#pysnptools.kernelreader.KernelData" title="pysnptools.kernelreader.KernelData"><code class="xref py py-class docutils literal notranslate"><span class="pre">KernelData</span></code></a> on which it works.</p>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<p>Read and standardize Kernel data.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">print_function</span> <span class="c1">#Python 2 &amp; 3 compatibility</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">six.moves</span> <span class="k">import</span> <span class="nb">range</span> <span class="c1">#Python 2 &amp; 3 compatibility</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.kernelstandardizer</span> <span class="k">import</span> <span class="n">DiagKtoN</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.kernelreader</span> <span class="k">import</span> <span class="n">KernelNpz</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.util</span> <span class="k">import</span> <span class="n">example_file</span> <span class="c1"># Download and return local file name</span>
<span class="gp">&gt;&gt;&gt; </span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kernel_file</span> <span class="o">=</span> <span class="n">example_file</span><span class="p">(</span><span class="s1">&#39;pysnptools/examples/toydata.kernel.npz&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kerneldata1</span> <span class="o">=</span> <span class="n">KernelNpz</span><span class="p">(</span><span class="n">kernel_file</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">kerneldata1</span><span class="o">.</span><span class="n">val</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
<span class="go">5000000.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kerneldata1</span> <span class="o">=</span> <span class="n">kerneldata1</span><span class="o">.</span><span class="n">standardize</span><span class="p">(</span><span class="n">DiagKtoN</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">kerneldata1</span><span class="o">.</span><span class="n">val</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
<span class="go">500.0</span>
</pre></div>
</div>
<p>Can also return a constant kernel standardizer that be applied to other <a class="reference internal" href="#pysnptools.kernelreader.KernelData" title="pysnptools.kernelreader.KernelData"><code class="xref py py-class docutils literal notranslate"><span class="pre">KernelData</span></code></a>.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">kernel_whole</span> <span class="o">=</span> <span class="n">KernelNpz</span><span class="p">(</span><span class="n">kernel_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">train_idx</span><span class="p">,</span> <span class="n">test_idx</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="n">kernel_whole</span><span class="o">.</span><span class="n">iid_count</span><span class="p">),</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>  <span class="c1">#test on the first 10, train on the rest</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kernel_train</span><span class="p">,</span> <span class="n">trained_standardizer</span> <span class="o">=</span> <span class="n">DiagKtoN</span><span class="p">()</span><span class="o">.</span><span class="n">standardize</span><span class="p">(</span><span class="n">kernel_whole</span><span class="p">[</span><span class="n">train_idx</span><span class="p">]</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span><span class="n">return_trained</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0:.6f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">kernel_train</span><span class="o">.</span><span class="n">val</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()))</span>
<span class="go">490.000000</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0:.6f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">trained_standardizer</span><span class="o">.</span><span class="n">factor</span><span class="p">))</span>
<span class="go">0.000100</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kernel_whole_test</span> <span class="o">=</span> <span class="n">kernel_whole</span><span class="p">[:,</span><span class="n">test_idx</span><span class="p">]</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">standardize</span><span class="p">(</span><span class="n">trained_standardizer</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0:.6f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">kernel_whole_test</span><span class="o">.</span><span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]))</span>
<span class="go">0.992217</span>
</pre></div>
</div>
<p>Details of Methods &amp; Properties:</p>
<dl class="py method">
<dt id="pysnptools.kernelstandardizer.KernelStandardizer.standardize">
<code class="sig-name descname">standardize</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">kerneldata</span></em>, <em class="sig-param"><span class="n">return_trained</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">force_python_only</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.kernelstandardizer.KernelStandardizer.standardize" title="Permalink to this definition">¶</a></dt>
<dd><p>Applies standardization, in place, to <a class="reference internal" href="#pysnptools.kernelreader.KernelData" title="pysnptools.kernelreader.KernelData"><code class="xref py py-class docutils literal notranslate"><span class="pre">KernelData</span></code></a>. For convenience also returns the <code class="xref py py-class docutils literal notranslate"><span class="pre">KernelData</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>snps</strong> (<a class="reference internal" href="#pysnptools.kernelreader.KernelData" title="pysnptools.kernelreader.KernelData"><code class="xref py py-class docutils literal notranslate"><span class="pre">KernelData</span></code></a>) – kernel values to standardize</p></li>
<li><p><strong>return_trained</strong> (<em>bool</em>) – If true, returns a second value containing a constant <a class="reference internal" href="#pysnptools.kernelstandardizer.KernelStandardizer" title="pysnptools.kernelstandardizer.KernelStandardizer"><code class="xref py py-class docutils literal notranslate"><span class="pre">KernelStandardizer</span></code></a> trained on this data.</p></li>
<li><p><strong>force_python_only</strong> (<em>bool</em>) – optional – If False (default), may use outside library code. If True, requests that the read
be done without outside library code.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="#pysnptools.kernelreader.KernelData" title="pysnptools.kernelreader.KernelData"><code class="xref py py-class docutils literal notranslate"><span class="pre">KernelData</span></code></a>, (optional) constant <a class="reference internal" href="#pysnptools.kernelstandardizer.KernelStandardizer" title="pysnptools.kernelstandardizer.KernelStandardizer"><code class="xref py py-class docutils literal notranslate"><span class="pre">KernelStandardizer</span></code></a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="kernelstandardizer-diagkton">
<h3><code class="xref py py-class docutils literal notranslate"><span class="pre">kernelstandardizer.DiagKtoN</span></code><a class="headerlink" href="#kernelstandardizer-diagkton" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt id="pysnptools.kernelstandardizer.DiagKtoN">
<em class="property">class </em><code class="sig-prename descclassname">pysnptools.kernelstandardizer.</code><code class="sig-name descname">DiagKtoN</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">deprecated_iid_count</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.kernelstandardizer.DiagKtoN" title="Permalink to this definition">¶</a></dt>
<dd><p>Both a <a class="reference internal" href="#pysnptools.standardizer.Standardizer" title="pysnptools.standardizer.Standardizer"><code class="xref py py-class docutils literal notranslate"><span class="pre">Standardizer</span></code></a> and a A <a class="reference internal" href="#pysnptools.kernelstandardizer.KernelStandardizer" title="pysnptools.kernelstandardizer.KernelStandardizer"><code class="xref py py-class docutils literal notranslate"><span class="pre">KernelStandardizer</span></code></a>.</p>
<p>When applied to a <a class="reference internal" href="#pysnptools.snpreader.SnpData" title="pysnptools.snpreader.SnpData"><code class="xref py py-class docutils literal notranslate"><span class="pre">SnpData</span></code></a>, it multiplies the SNP values by the square root of a factor such that a kernel
constructed from the SNP values will have a diagonal that sums to iid_count. This class thus
standardizes the kernel before it is even constructed.</p>
<p>When applied to a <a class="reference internal" href="#pysnptools.kernelreader.KernelData" title="pysnptools.kernelreader.KernelData"><code class="xref py py-class docutils literal notranslate"><span class="pre">KernelData</span></code></a>, it multiplies the kernel values by the a factor such that a kernel
will have a diagonal that sums to iid_count.</p>
<p>See <a class="reference internal" href="#pysnptools.standardizer.Standardizer" title="pysnptools.standardizer.Standardizer"><code class="xref py py-class docutils literal notranslate"><span class="pre">Standardizer</span></code></a> for more information about standardization.</p>
<dl class="simple">
<dt><strong>Constructor:</strong></dt><dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>deprecated_iid_count</strong> (<em>int</em>) (optional) – Deprecated.</p></li>
</ul>
</dd>
</dl>
</dd>
</dl>
<p>Example of DiagKtoN to <a class="reference internal" href="#pysnptools.snpreader.SnpData" title="pysnptools.snpreader.SnpData"><code class="xref py py-class docutils literal notranslate"><span class="pre">SnpData</span></code></a>:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">print_function</span> <span class="c1">#Python 2 &amp; 3 compatibility</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.standardizer</span> <span class="k">import</span> <span class="n">DiagKtoN</span><span class="p">,</span> <span class="n">Unit</span><span class="p">,</span> <span class="n">Identity</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.snpreader</span> <span class="k">import</span> <span class="n">Bed</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.util</span> <span class="k">import</span> <span class="n">example_file</span> <span class="c1"># Download and return local file name</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bedfile</span> <span class="o">=</span> <span class="n">example_file</span><span class="p">(</span><span class="s2">&quot;tests/datasets/all_chr.maf0.001.N300.*&quot;</span><span class="p">,</span><span class="s2">&quot;*.bed&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snpdata1</span> <span class="o">=</span> <span class="n">Bed</span><span class="p">(</span><span class="n">bedfile</span><span class="p">,</span><span class="n">count_A1</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">standardize</span><span class="p">(</span><span class="n">Unit</span><span class="p">())</span><span class="o">.</span><span class="n">standardize</span><span class="p">(</span><span class="n">DiagKtoN</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kernel1</span> <span class="o">=</span> <span class="n">snpdata1</span><span class="o">.</span><span class="n">read_kernel</span><span class="p">(</span><span class="n">Identity</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0:.6f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">kernel1</span><span class="o">.</span><span class="n">val</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()))</span>
<span class="go">300.000000</span>
</pre></div>
</div>
<p>Example of DiagKtoN to <a class="reference internal" href="#pysnptools.kernelreader.KernelData" title="pysnptools.kernelreader.KernelData"><code class="xref py py-class docutils literal notranslate"><span class="pre">KernelData</span></code></a>:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.standardizer</span> <span class="k">import</span> <span class="n">DiagKtoN</span><span class="p">,</span> <span class="n">Unit</span><span class="p">,</span> <span class="n">Identity</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.snpreader</span> <span class="k">import</span> <span class="n">Bed</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.util</span> <span class="k">import</span> <span class="n">example_file</span> <span class="c1"># Download and return local file name</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bedfile</span> <span class="o">=</span> <span class="n">example_file</span><span class="p">(</span><span class="s2">&quot;tests/datasets/all_chr.maf0.001.N300.*&quot;</span><span class="p">,</span><span class="s2">&quot;*.bed&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snpdata1</span> <span class="o">=</span> <span class="n">Bed</span><span class="p">(</span><span class="n">bedfile</span><span class="p">,</span><span class="n">count_A1</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">standardize</span><span class="p">(</span><span class="n">Unit</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kernel1</span> <span class="o">=</span> <span class="n">snpdata1</span><span class="o">.</span><span class="n">read_kernel</span><span class="p">(</span><span class="n">DiagKtoN</span><span class="p">(),</span><span class="n">block_size</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0:.6f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">kernel1</span><span class="o">.</span><span class="n">val</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()))</span>
<span class="go">300.000000</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="kernelstandardizer-diagktontrained">
<h3><code class="xref py py-class docutils literal notranslate"><span class="pre">kernelstandardizer.DiagKtoNTrained</span></code><a class="headerlink" href="#kernelstandardizer-diagktontrained" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt id="pysnptools.kernelstandardizer.DiagKtoNTrained">
<em class="property">class </em><code class="sig-prename descclassname">pysnptools.kernelstandardizer.</code><code class="sig-name descname">DiagKtoNTrained</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">factor</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.kernelstandardizer.DiagKtoNTrained" title="Permalink to this definition">¶</a></dt>
<dd><p>Both a <a class="reference internal" href="#pysnptools.standardizer.Standardizer" title="pysnptools.standardizer.Standardizer"><code class="xref py py-class docutils literal notranslate"><span class="pre">Standardizer</span></code></a> and a A <a class="reference internal" href="#pysnptools.kernelstandardizer.KernelStandardizer" title="pysnptools.kernelstandardizer.KernelStandardizer"><code class="xref py py-class docutils literal notranslate"><span class="pre">KernelStandardizer</span></code></a>.</p>
<p>When applied to a <a class="reference internal" href="#pysnptools.snpreader.SnpData" title="pysnptools.snpreader.SnpData"><code class="xref py py-class docutils literal notranslate"><span class="pre">SnpData</span></code></a>, DiagKtoN standardizes one set of SNP data based on another set of SNP data.</p>
<p>When applied to a <a class="reference internal" href="#pysnptools.kernelreader.KernelData" title="pysnptools.kernelreader.KernelData"><code class="xref py py-class docutils literal notranslate"><span class="pre">KernelData</span></code></a>, DiagKtoN standardizes one kernel data based on another kernel data.</p>
<p>See <a class="reference internal" href="#pysnptools.standardizer.Standardizer" title="pysnptools.standardizer.Standardizer"><code class="xref py py-class docutils literal notranslate"><span class="pre">Standardizer</span></code></a> for more information about standardization.</p>
<dl class="simple">
<dt><strong>Constructor:</strong></dt><dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>factor</strong> (<em>float</em>) – The number what when multiplied into the kernel values will make the diagonal of the kernel values to  sum to iid_count.</p></li>
</ul>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="kernelstandardizer-identity">
<h3><code class="xref py py-class docutils literal notranslate"><span class="pre">kernelstandardizer.Identity</span></code><a class="headerlink" href="#kernelstandardizer-identity" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt id="pysnptools.kernelstandardizer.Identity">
<em class="property">class </em><code class="sig-prename descclassname">pysnptools.kernelstandardizer.</code><code class="sig-name descname">Identity</code><a class="headerlink" href="#pysnptools.kernelstandardizer.Identity" title="Permalink to this definition">¶</a></dt>
<dd><p>A <a class="reference internal" href="#pysnptools.kernelstandardizer.KernelStandardizer" title="pysnptools.kernelstandardizer.KernelStandardizer"><code class="xref py py-class docutils literal notranslate"><span class="pre">KernelStandardizer</span></code></a> that does nothing to kernel data.</p>
<p>See <a class="reference internal" href="#pysnptools.kernelstandardizer.KernelStandardizer" title="pysnptools.kernelstandardizer.KernelStandardizer"><code class="xref py py-class docutils literal notranslate"><span class="pre">KernelStandardizer</span></code></a> for more information about standardization.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.kernelstandardizer</span> <span class="k">import</span> <span class="n">Identity</span> <span class="k">as</span> <span class="n">KS_Identity</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.kernelreader</span> <span class="k">import</span> <span class="n">KernelNpz</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.util</span> <span class="k">import</span> <span class="n">example_file</span> <span class="c1"># Download and return local file name</span>
<span class="gp">&gt;&gt;&gt; </span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kernel_file</span> <span class="o">=</span> <span class="n">example_file</span><span class="p">(</span><span class="s1">&#39;pysnptools/examples/toydata.kernel.npz&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kerneldata1</span> <span class="o">=</span> <span class="n">KernelNpz</span><span class="p">(</span><span class="n">kernel_file</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">kerneldata1</span><span class="o">.</span><span class="n">val</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
<span class="go">5000000.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kerneldata1</span> <span class="o">=</span> <span class="n">kerneldata1</span><span class="o">.</span><span class="n">standardize</span><span class="p">(</span><span class="n">KS_Identity</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">kerneldata1</span><span class="o">.</span><span class="n">val</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
<span class="go">5000000.0</span>
</pre></div>
</div>
</dd></dl>

</div>
</div>
<div class="section" id="module-pysnptools.pstreader">
<span id="pstreader-module"></span><h2><code class="xref py py-mod docutils literal notranslate"><span class="pre">pstreader</span></code> Module<a class="headerlink" href="#module-pysnptools.pstreader" title="Permalink to this headline">¶</a></h2>
<p>Tools for reading and manipulating matrix data along with row and column ids and properties.</p>
<div class="section" id="pstreader-pstreader">
<h3><code class="xref py py-class docutils literal notranslate"><span class="pre">pstreader.PstReader</span></code><a class="headerlink" href="#pstreader-pstreader" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt id="pysnptools.pstreader.PstReader">
<em class="property">class </em><code class="sig-prename descclassname">pysnptools.pstreader.</code><code class="sig-name descname">PstReader</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.pstreader.PstReader" title="Permalink to this definition">¶</a></dt>
<dd><p>A PstReader is one of three things:</p>
<ul>
<li><p>A <a class="reference internal" href="#pysnptools.pstreader.PstData" title="pysnptools.pstreader.PstData"><code class="xref py py-class docutils literal notranslate"><span class="pre">PstData</span></code></a> class that holds matrix data in memory:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.pstreader</span> <span class="k">import</span> <span class="n">PstData</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data1</span> <span class="o">=</span> <span class="n">PstData</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">],</span><span class="n">col</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">,</span><span class="s1">&#39;z&#39;</span><span class="p">],</span><span class="n">val</span><span class="o">=</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],[</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span><span class="mi">6</span><span class="p">]],</span><span class="n">row_property</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="s1">&#39;C&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">type</span><span class="p">(</span><span class="n">data1</span><span class="o">.</span><span class="n">val</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span> <span class="c1"># The val property is an ndarray of values</span>
<span class="go">&#39;ndarray&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data1</span><span class="o">.</span><span class="n">row_count</span> <span class="c1">#prints the number of rows in this in-memory data</span>
<span class="go">3</span>
</pre></div>
</div>
</li>
<li><p>A class such as <a class="reference internal" href="#pysnptools.pstreader.PstNpz" title="pysnptools.pstreader.PstNpz"><code class="xref py py-class docutils literal notranslate"><span class="pre">PstNpz</span></code></a> for you to specify data in file. For example,</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.pstreader</span> <span class="k">import</span> <span class="n">PstNpz</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.util</span> <span class="k">import</span> <span class="n">example_file</span> <span class="c1"># Download and return local file name</span>
<span class="gp">&gt;&gt;&gt; </span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pstnpz_file</span> <span class="o">=</span> <span class="n">example_file</span><span class="p">(</span><span class="s1">&#39;tests/datasets/all_chr.maf0.001.N300.pst.npz&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">on_disk</span> <span class="o">=</span> <span class="n">PstNpz</span><span class="p">(</span><span class="n">pstnpz_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">on_disk</span><span class="p">)</span> <span class="c1"># prints specification for reading from file</span>
<span class="go">PstNpz(&#39;...tests/datasets/all_chr.maf0.001.N300.pst.npz&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">on_disk</span><span class="o">.</span><span class="n">col_count</span> <span class="c1"># prints the number of columns (but doesn&#39;t read any matrix values)</span>
<span class="go">1015</span>
</pre></div>
</div>
</li>
<li><p>A subset of any PstReader, specified with “[ <em>row_index</em> , <em>col_index</em> ]”, to read just some values.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.pstreader</span> <span class="k">import</span> <span class="n">PstNpz</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.util</span> <span class="k">import</span> <span class="n">example_file</span> <span class="c1"># Download and return local file name</span>
<span class="gp">&gt;&gt;&gt; </span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pstnpz_file</span> <span class="o">=</span> <span class="n">example_file</span><span class="p">(</span><span class="s1">&#39;tests/datasets/all_chr.maf0.001.N300.pst.npz&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">on_disk</span> <span class="o">=</span> <span class="n">PstNpz</span><span class="p">(</span><span class="n">pstnpz_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">subset_on_disk</span> <span class="o">=</span> <span class="n">on_disk</span><span class="p">[[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],::</span><span class="mi">2</span><span class="p">]</span> <span class="c1"># specification for a subset of the data on disk. No values are read yet.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">subset_on_disk</span><span class="o">.</span><span class="n">col_count</span><span class="p">)</span> <span class="c1"># prints the number of columns in this subset (but still doesn&#39;t read any values)</span>
<span class="go">508</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">subset_on_disk</span><span class="p">)</span> <span class="c1">#prints a specification of &#39;subset_on_disk&#39;</span>
<span class="go">PstNpz(...tests/datasets/all_chr.maf0.001.N300.pst.npz&#39;)[[3,4],::2]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data_subset</span> <span class="o">=</span> <span class="n">subset_on_disk</span><span class="o">.</span><span class="n">read</span><span class="p">()</span> <span class="c1"># efficiently (if practical) reads the specified subset of values from the disk</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">data_subset</span><span class="p">)</span> <span class="c1"># prints the specification of the in-memory information</span>
<span class="go">PstData(PstNpz(...tests/datasets/all_chr.maf0.001.N300.pst.npz&#39;)[[3,4],::2])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">int</span><span class="p">(</span><span class="n">data_subset</span><span class="o">.</span><span class="n">val</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span><span class="nb">int</span><span class="p">(</span><span class="n">data_subset</span><span class="o">.</span><span class="n">val</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="c1"># The dimensions of the ndarray of values</span>
<span class="go">(2, 508)</span>
</pre></div>
</div>
</li>
</ul>
<p>The PstReaders Classes</p>
<blockquote>
<div><table class="docutils align-default">
<colgroup>
<col style="width: 30%" />
<col style="width: 30%" />
<col style="width: 19%" />
<col style="width: 20%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><em>Class</em></p></td>
<td><p><em>Format</em></p></td>
<td><p><em>Random Access</em></p></td>
<td><p><em>Suffixes</em></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pysnptools.pstreader.PstData" title="pysnptools.pstreader.PstData"><code class="xref py py-class docutils literal notranslate"><span class="pre">PstData</span></code></a></p></td>
<td><p>in-memory floats</p></td>
<td><p>Yes</p></td>
<td><p><em>n/a</em></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pysnptools.pstreader.PstNpz" title="pysnptools.pstreader.PstNpz"><code class="xref py py-class docutils literal notranslate"><span class="pre">PstNpz</span></code></a></p></td>
<td><p>binary, floats</p></td>
<td><p>No</p></td>
<td><p>.pst.npz,.snp.npz,
.kernel.npz</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pysnptools.pstreader.PstHdf5" title="pysnptools.pstreader.PstHdf5"><code class="xref py py-class docutils literal notranslate"><span class="pre">PstHdf5</span></code></a></p></td>
<td><p>binary, floats</p></td>
<td><p>Yes</p></td>
<td><p>.pst.hdf5,.snp.hdf5,
.kernel.hdf5</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pysnptools.pstreader.PstMemMap" title="pysnptools.pstreader.PstMemMap"><code class="xref py py-class docutils literal notranslate"><span class="pre">PstMemMap</span></code></a></p></td>
<td><p>mem-mapped floats</p></td>
<td><p>Yes</p></td>
<td><p>.pst.memmap,.snp.memmap</p></td>
</tr>
<tr class="row-even"><td><p>various <a class="reference internal" href="#pysnptools.snpreader.SnpReader" title="pysnptools.snpreader.SnpReader"><code class="xref py py-class docutils literal notranslate"><span class="pre">SnpReader</span></code></a></p></td>
<td><p>varies</p></td>
<td><p>varies</p></td>
<td><p>varies</p></td>
</tr>
<tr class="row-odd"><td><p>various <a class="reference internal" href="#pysnptools.kernelreader.KernelReader" title="pysnptools.kernelreader.KernelReader"><code class="xref py py-class docutils literal notranslate"><span class="pre">KernelReader</span></code></a></p></td>
<td><p>varies</p></td>
<td><p>varies</p></td>
<td><p>varies</p></td>
</tr>
</tbody>
</table>
<blockquote>
<div><p>A <a class="reference internal" href="#pysnptools.snpreader.SnpReader" title="pysnptools.snpreader.SnpReader"><code class="xref py py-class docutils literal notranslate"><span class="pre">SnpReader</span></code></a> and <a class="reference internal" href="#pysnptools.kernelreader.KernelReader" title="pysnptools.kernelreader.KernelReader"><code class="xref py py-class docutils literal notranslate"><span class="pre">KernelReader</span></code></a> are each a kind of <a class="reference internal" href="#pysnptools.pstreader.PstReader" title="pysnptools.pstreader.PstReader"><code class="xref py py-class docutils literal notranslate"><span class="pre">PstReader</span></code></a>. They have some restrictions summarized here:
================================== =============== ============ ============ ==================== ====================
<em>Class</em>                            <em>val type</em>      <em>row type</em>   <em>col type</em>   <em>row_property type</em>  <em>col_property type</em>
<a class="reference internal" href="#pysnptools.pstreader.PstReader" title="pysnptools.pstreader.PstReader"><code class="xref py py-class docutils literal notranslate"><span class="pre">PstReader</span></code></a>                float           any          any          any                  any     
<a class="reference internal" href="#pysnptools.snpreader.SnpReader" title="pysnptools.snpreader.SnpReader"><code class="xref py py-class docutils literal notranslate"><span class="pre">SnpReader</span></code></a>                float           str,str      str          none                 float,float,float
<a class="reference internal" href="#pysnptools.kernelreader.KernelReader" title="pysnptools.kernelreader.KernelReader"><code class="xref py py-class docutils literal notranslate"><span class="pre">KernelReader</span></code></a>             float           str,str      str,str      none                 none
================================== =============== ============ ============ ==================== ====================</p>
<p>For convenience, they allow additional ways to access rows and columns.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 30%" />
<col style="width: 13%" />
<col style="width: 11%" />
<col style="width: 11%" />
<col style="width: 18%" />
<col style="width: 18%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><em>Class</em></p></td>
<td><p><em>val name</em></p></td>
<td><p><em>row name</em></p></td>
<td><p><em>col name</em></p></td>
<td><p><em>row_property name</em></p></td>
<td><p><em>col_property name</em></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pysnptools.pstreader.PstReader" title="pysnptools.pstreader.PstReader"><code class="xref py py-class docutils literal notranslate"><span class="pre">PstReader</span></code></a></p></td>
<td><p>val</p></td>
<td><p>row</p></td>
<td><p>col</p></td>
<td><p>row_property</p></td>
<td><p>col_property</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pysnptools.snpreader.SnpReader" title="pysnptools.snpreader.SnpReader"><code class="xref py py-class docutils literal notranslate"><span class="pre">SnpReader</span></code></a></p></td>
<td><p>val</p></td>
<td><p>iid,row</p></td>
<td><p>sid,col</p></td>
<td><p>none</p></td>
<td><p>col_property,pos</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pysnptools.kernelreader.KernelReader" title="pysnptools.kernelreader.KernelReader"><code class="xref py py-class docutils literal notranslate"><span class="pre">KernelReader</span></code></a></p></td>
<td><p>val</p></td>
<td><p>iid0,row,iid</p></td>
<td><p>iid1,col,iid</p></td>
<td><p>none</p></td>
<td><p>none</p></td>
</tr>
</tbody>
</table>
<dl class="field-list simple">
<dt class="field-odd">Note</dt>
<dd class="field-odd"><p>A <a class="reference internal" href="#pysnptools.kernelreader.KernelReader.iid" title="pysnptools.kernelreader.KernelReader.iid"><code class="xref py py-attr docutils literal notranslate"><span class="pre">KernelReader.iid</span></code></a> may be used when <a class="reference internal" href="#pysnptools.kernelreader.KernelReader.iid0" title="pysnptools.kernelreader.KernelReader.iid0"><code class="xref py py-attr docutils literal notranslate"><span class="pre">KernelReader.iid0</span></code></a> is equal to <a class="reference internal" href="#pysnptools.kernelreader.KernelReader.iid1" title="pysnptools.kernelreader.KernelReader.iid1"><code class="xref py py-attr docutils literal notranslate"><span class="pre">KernelReader.iid1</span></code></a></p>
</dd>
</dl>
</div></blockquote>
</div></blockquote>
<p>Methods &amp; Properties:</p>
<blockquote>
<div><p>Every PstReader, such as <a class="reference internal" href="#pysnptools.pstreader.PstNpz" title="pysnptools.pstreader.PstNpz"><code class="xref py py-class docutils literal notranslate"><span class="pre">PstNpz</span></code></a> and <a class="reference internal" href="#pysnptools.pstreader.PstData" title="pysnptools.pstreader.PstData"><code class="xref py py-class docutils literal notranslate"><span class="pre">PstData</span></code></a>, has these properties: <a class="reference internal" href="#pysnptools.pstreader.PstReader.row" title="pysnptools.pstreader.PstReader.row"><code class="xref py py-attr docutils literal notranslate"><span class="pre">row</span></code></a>, <a class="reference internal" href="#pysnptools.pstreader.PstReader.row_count" title="pysnptools.pstreader.PstReader.row_count"><code class="xref py py-attr docutils literal notranslate"><span class="pre">row_count</span></code></a>, <a class="reference internal" href="#pysnptools.pstreader.PstReader.col" title="pysnptools.pstreader.PstReader.col"><code class="xref py py-attr docutils literal notranslate"><span class="pre">col</span></code></a>, <a class="reference internal" href="#pysnptools.pstreader.PstReader.col_count" title="pysnptools.pstreader.PstReader.col_count"><code class="xref py py-attr docutils literal notranslate"><span class="pre">col_count</span></code></a>,
<a class="reference internal" href="#pysnptools.pstreader.PstReader.row_property" title="pysnptools.pstreader.PstReader.row_property"><code class="xref py py-attr docutils literal notranslate"><span class="pre">row_property</span></code></a>, <a class="reference internal" href="#pysnptools.pstreader.PstReader.col_property" title="pysnptools.pstreader.PstReader.col_property"><code class="xref py py-attr docutils literal notranslate"><span class="pre">col_property</span></code></a> and these methods: <a class="reference internal" href="#pysnptools.pstreader.PstReader.read" title="pysnptools.pstreader.PstReader.read"><code class="xref py py-meth docutils literal notranslate"><span class="pre">read()</span></code></a>, <a class="reference internal" href="#pysnptools.pstreader.PstReader.row_to_index" title="pysnptools.pstreader.PstReader.row_to_index"><code class="xref py py-meth docutils literal notranslate"><span class="pre">row_to_index()</span></code></a>, <a class="reference internal" href="#pysnptools.pstreader.PstReader.col_to_index" title="pysnptools.pstreader.PstReader.col_to_index"><code class="xref py py-meth docutils literal notranslate"><span class="pre">col_to_index()</span></code></a>. See below for details.</p>
<p><a class="reference internal" href="#pysnptools.pstreader.PstData" title="pysnptools.pstreader.PstData"><code class="xref py py-class docutils literal notranslate"><span class="pre">PstData</span></code></a> is a PstReader so it supports the above properties and methods. In addition, it supports property <a class="reference internal" href="#pysnptools.pstreader.PstData.val" title="pysnptools.pstreader.PstData.val"><code class="xref py py-attr docutils literal notranslate"><span class="pre">PstData.val</span></code></a> and equality testing.
See below for details.</p>
</div></blockquote>
<p>Rows and Cols:</p>
<blockquote>
<div><p>Example:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">print_function</span> <span class="c1">#Python 2 &amp; 3 compatibility</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.pstreader</span> <span class="k">import</span> <span class="n">PstHdf5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.util</span> <span class="k">import</span> <span class="n">print2</span> <span class="c1">#print bytes strings and Unicode strings the same</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.util</span> <span class="k">import</span> <span class="n">example_file</span> <span class="c1"># Download and return local file name</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hdf5_file</span> <span class="o">=</span> <span class="n">example_file</span><span class="p">(</span><span class="s1">&#39;pysnptools/examples/toydata.iidmajor.snp.hdf5&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">on_disk</span> <span class="o">=</span> <span class="n">PstHdf5</span><span class="p">(</span><span class="n">hdf5_file</span><span class="p">)</span> <span class="c1"># PstHdf5 can load .pst.hdf5, .snp.hdf5, and kernel.hdf5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">print2</span><span class="p">(</span><span class="n">on_disk</span><span class="o">.</span><span class="n">row</span><span class="p">[:</span><span class="mi">3</span><span class="p">])</span> <span class="c1"># print the first three rows</span>
<span class="go">[[&#39;per0&#39; &#39;per0&#39;]</span>
<span class="go"> [&#39;per1&#39; &#39;per1&#39;]</span>
<span class="go"> [&#39;per2&#39; &#39;per2&#39;]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">print2</span><span class="p">(</span><span class="n">on_disk</span><span class="o">.</span><span class="n">col</span><span class="p">[:</span><span class="mi">7</span><span class="p">])</span> <span class="c1"># print the first seven columns</span>
<span class="go">[&#39;null_0&#39; &#39;null_1&#39; &#39;null_2&#39; &#39;null_3&#39; &#39;null_4&#39; &#39;null_5&#39; &#39;null_6&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">print2</span><span class="p">(</span><span class="n">on_disk</span><span class="o">.</span><span class="n">row_to_index</span><span class="p">([[</span><span class="sa">b</span><span class="s1">&#39;per2&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;per2&#39;</span><span class="p">],[</span><span class="sa">b</span><span class="s1">&#39;per1&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;per1&#39;</span><span class="p">]]))</span> <span class="c1">#Find the indexes for two rows.</span>
<span class="go">[2 1]</span>
</pre></div>
</div>
</div></blockquote>
<p>When Matrix Data is Read:</p>
<blockquote>
<div><p>Matrix data can be enormous so we generally avoid reading it to the degree practical. Specifically,</p>
<ul>
<li><p>Constructing and printing a PstReader causes no file reading. For example, these commands read no data:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">on_disk</span> <span class="o">=</span> <span class="n">PstHdf5</span><span class="p">(</span><span class="n">hdf5_file</span><span class="p">)</span> <span class="c1"># Construct a PstHdf5 PstReader. No data is read.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">on_disk</span><span class="p">)</span> <span class="c1"># Print the PstHdf5 PstReader specification. No data is read.</span>
<span class="go">PstHdf5(...pysnptools/examples/toydata.iidmajor.snp.hdf5&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">subset_on_disk</span> <span class="o">=</span> <span class="n">on_disk</span><span class="p">[[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],::</span><span class="mi">2</span><span class="p">]</span> <span class="c1"># Construct a subsetting PstReader. No data is read.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">subset_on_disk</span><span class="p">)</span> <span class="c1"># print the subset PstReader. No data is read.</span>
<span class="go">PstHdf5(...pysnptools/examples/toydata.iidmajor.snp.hdf5&#39;)[[3,4],::2]</span>
</pre></div>
</div>
</li>
<li><p>Properties and methods related to the rows and columns (to the degree practical) read only row and col data from the disk,
not value data. Moreover, the row and col data is read from file only once. Consider these commands:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">on_disk</span> <span class="o">=</span> <span class="n">PstHdf5</span><span class="p">(</span><span class="n">hdf5_file</span><span class="p">)</span> <span class="c1"># Construct a PstHdf5 PstReader. No data is read.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">print2</span><span class="p">(</span><span class="n">on_disk</span><span class="o">.</span><span class="n">col</span><span class="p">[:</span><span class="mi">7</span><span class="p">])</span> <span class="c1"># without reading any values data from disk, read the row and col data from disk, cache it, and then print the first seven cols.</span>
<span class="go">[&#39;null_0&#39; &#39;null_1&#39; &#39;null_2&#39; &#39;null_3&#39; &#39;null_4&#39; &#39;null_5&#39; &#39;null_6&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">on_disk</span><span class="o">.</span><span class="n">col_to_index</span><span class="p">([</span><span class="sa">b</span><span class="s1">&#39;null_7&#39;</span><span class="p">,</span><span class="sa">b</span><span class="s1">&#39;null_2&#39;</span><span class="p">]))</span> <span class="c1">#use the cached col information to find the indexes of &#39;null_7&#39; and &#39;null_2&#39;. (No data is read from disk.)</span>
<span class="go">[7 2]</span>
</pre></div>
</div>
</li>
<li><p>The only method that reads values from file (to the degree practical) is <a class="reference internal" href="#pysnptools.pstreader.PstReader.read" title="pysnptools.pstreader.PstReader.read"><code class="xref py py-meth docutils literal notranslate"><span class="pre">read()</span></code></a>. For example:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">on_disk</span> <span class="o">=</span> <span class="n">PstHdf5</span><span class="p">(</span><span class="n">hdf5_file</span><span class="p">)</span> <span class="c1"># Construct a PstHdf5 PstReader. No data is read.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data1</span> <span class="o">=</span> <span class="n">on_disk</span><span class="o">.</span><span class="n">read</span><span class="p">()</span> <span class="c1">#read all the values from disk, creating a new PstData instance that keeps these values in memory</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">data1</span><span class="o">.</span><span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span> <span class="c1"># print the value for the row with index 0 and the col with index 2. (No data is read from disk.)</span>
<span class="go">2.0</span>
</pre></div>
</div>
</li>
<li><p>If you request the values for only a subset of the rows or columns, (to the degree practical) only that subset will be read from disk.
for example:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hdf5_file2</span> <span class="o">=</span> <span class="n">example_file</span><span class="p">(</span><span class="s1">&#39;tests/datasets/all_chr.maf0.001.N300.hdf5&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">on_disk</span> <span class="o">=</span> <span class="n">PstHdf5</span><span class="p">(</span><span class="n">hdf5_file2</span><span class="p">)[[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],::</span><span class="mi">2</span><span class="p">]</span> <span class="c1"># Construct a subsetting PstReader. No data is read.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data_subset</span> <span class="o">=</span> <span class="n">subset_on_disk</span><span class="o">.</span><span class="n">read</span><span class="p">()</span> <span class="c1"># from disk, read the values for the rows with index 3 and 4 AND cols with even numbered indexes.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">data_subset</span><span class="o">.</span><span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span> <span class="c1"># print the value with subset row index 0 and col index 2 (corresponding to row index 3 and col index 4 in the full data). No data is read from disk.</span>
<span class="go">1.0</span>
</pre></div>
</div>
</li>
</ul>
</div></blockquote>
<p>When Matrix Data is Re-Read and Copied:</p>
<blockquote>
<div><p>Every time you call a PstReader’s <a class="reference internal" href="#pysnptools.pstreader.PstReader.read" title="pysnptools.pstreader.PstReader.read"><code class="xref py py-meth docutils literal notranslate"><span class="pre">read()</span></code></a> method, the PstReader re-reads the value data and returns a new in-memory <a class="reference internal" href="#pysnptools.pstreader.PstData" title="pysnptools.pstreader.PstData"><code class="xref py py-class docutils literal notranslate"><span class="pre">PstData</span></code></a>
(with <a class="reference internal" href="#pysnptools.pstreader.PstData.val" title="pysnptools.pstreader.PstData.val"><code class="xref py py-attr docutils literal notranslate"><span class="pre">PstData.val</span></code></a> property containing a new ndarray of the values).</p>
<p>Here is an example of what not to do, because it causes all the matrix value data to be read twice.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">on_disk</span> <span class="o">=</span> <span class="n">PstHdf5</span><span class="p">(</span><span class="n">hdf5_file</span><span class="p">)</span> <span class="c1"># Construct a PstHdf5 PstReader. No data is read.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Not recommended because it inefficiently reads all the values twice.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">on_disk</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span> <span class="c1"># read all values into a new PstData, print a value</span>
<span class="go">2.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">on_disk</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span> <span class="c1"># read all values (again) into a second new PstData, print a value</span>
<span class="go">2.0</span>
</pre></div>
</div>
<p>Here are two efficient alternatives. First, if all values can all fit in memory, read them once into a <a class="reference internal" href="#pysnptools.pstreader.PstData" title="pysnptools.pstreader.PstData"><code class="xref py py-class docutils literal notranslate"><span class="pre">PstData</span></code></a> and then
access that <a class="reference internal" href="#pysnptools.pstreader.PstData" title="pysnptools.pstreader.PstData"><code class="xref py py-class docutils literal notranslate"><span class="pre">PstData</span></code></a> multiple times.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">on_disk</span> <span class="o">=</span> <span class="n">PstHdf5</span><span class="p">(</span><span class="n">hdf5_file</span><span class="p">)</span> <span class="c1"># Construct a PstHdf5 PstReader. No data is read.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data1</span> <span class="o">=</span> <span class="n">on_disk</span><span class="o">.</span><span class="n">read</span><span class="p">()</span> <span class="c1"># read all values into a new PstData</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">data1</span><span class="o">.</span><span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span> <span class="c1"># print a value from data1&#39;s in-memory ndarray</span>
<span class="go">2.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">data1</span><span class="o">.</span><span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span> <span class="c1"># print another value from data1&#39;s in-memory ndarray.</span>
<span class="go">2.0</span>
</pre></div>
</div>
<p>Second, if the value data is too large to fit in memory, use subsetting to read only the values of interest from disk.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">on_disk</span> <span class="o">=</span> <span class="n">PstHdf5</span><span class="p">(</span><span class="n">hdf5_file</span><span class="p">)</span> <span class="c1"># Construct a PstHdf5 PstReader. No data is read.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">on_disk</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span> <span class="c1">#Define the subset of data and read only that subset from disk.</span>
<span class="go">2.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">on_disk</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span> <span class="c1">#Define a second subset of data and read only that subset from disk.</span>
<span class="go">2.0</span>
</pre></div>
</div>
<p>Because the in-memory <a class="reference internal" href="#pysnptools.pstreader.PstData" title="pysnptools.pstreader.PstData"><code class="xref py py-class docutils literal notranslate"><span class="pre">PstData</span></code></a> class is a kind of PstReader, you may read from it, too.
Doing so create a new <a class="reference internal" href="#pysnptools.pstreader.PstData" title="pysnptools.pstreader.PstData"><code class="xref py py-class docutils literal notranslate"><span class="pre">PstData</span></code></a> instance containing a copy of the matrix values in a new ndarray.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">on_disk</span> <span class="o">=</span> <span class="n">PstHdf5</span><span class="p">(</span><span class="n">hdf5_file</span><span class="p">)</span> <span class="c1"># Construct a PstHdf5 PstReader. No data is read.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data1</span> <span class="o">=</span> <span class="n">on_disk</span><span class="o">.</span><span class="n">read</span><span class="p">()</span> <span class="c1"># read all matrix values from disk into a new PstData</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">data1</span><span class="o">.</span><span class="n">val</span> <span class="ow">is</span> <span class="n">data1</span><span class="o">.</span><span class="n">val</span><span class="p">)</span> <span class="c1"># Do the in-memory SNP values use the same memory as themselves? Yes</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data2</span> <span class="o">=</span> <span class="n">data1</span><span class="o">.</span><span class="n">read</span><span class="p">()</span> <span class="c1"># copy all the matrix values into a new ndarray in a new PstData</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">data2</span><span class="o">.</span><span class="n">val</span> <span class="ow">is</span> <span class="n">data1</span><span class="o">.</span><span class="n">val</span><span class="p">)</span> <span class="c1"># Do the two ndarrays of in-memory matrix values use the same memory?</span>
<span class="go">False</span>
</pre></div>
</div>
</div></blockquote>
<p>Avoiding Unwanted ndarray Allocations</p>
<blockquote>
<div><p>You may want a subset of matrix values from an in-memory <a class="reference internal" href="#pysnptools.pstreader.PstData" title="pysnptools.pstreader.PstData"><code class="xref py py-class docutils literal notranslate"><span class="pre">PstData</span></code></a> and you may know that this subset and the original <a class="reference internal" href="#pysnptools.pstreader.PstData" title="pysnptools.pstreader.PstData"><code class="xref py py-class docutils literal notranslate"><span class="pre">PstData</span></code></a>
can safely share the memory of the ndarray of matrix values. For this case, the <a class="reference internal" href="#pysnptools.pstreader.PstReader.read" title="pysnptools.pstreader.PstReader.read"><code class="xref py py-meth docutils literal notranslate"><span class="pre">read()</span></code></a> has optional parameters called view_ok and order. If you override 
the defaults of “view_ok=False,order=’F’” with “view_ok=True,order=’A’, the <a class="reference internal" href="#pysnptools.pstreader.PstReader.read" title="pysnptools.pstreader.PstReader.read"><code class="xref py py-meth docutils literal notranslate"><span class="pre">read()</span></code></a> will, if practical, return a new 
<a class="reference internal" href="#pysnptools.pstreader.PstData" title="pysnptools.pstreader.PstData"><code class="xref py py-class docutils literal notranslate"><span class="pre">PstData</span></code></a> with a ndarray shares memory with the original ndarray.
Use these parameters with care because any change to either ndarray will effect
the others. Also keep in mind that <a class="reference internal" href="#pysnptools.pstreader.PstReader.read" title="pysnptools.pstreader.PstReader.read"><code class="xref py py-meth docutils literal notranslate"><span class="pre">read()</span></code></a> relies on ndarray’s mechanisms to decide whether to actually
share memory and so it may ignore your suggestion and allocate a new ndarray anyway.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">on_disk</span> <span class="o">=</span> <span class="n">PstNpz</span><span class="p">(</span><span class="n">pstnpz_file</span><span class="p">)</span> <span class="c1"># Construct a PstNpz PstReader. No data is read.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data1</span> <span class="o">=</span> <span class="n">on_disk</span><span class="o">.</span><span class="n">read</span><span class="p">()</span> <span class="c1"># read all data from disk into a PstData with a new ndarray</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">column01</span> <span class="o">=</span> <span class="n">data1</span><span class="p">[:,</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">view_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">order</span><span class="o">=</span><span class="s1">&#39;A&#39;</span><span class="p">)</span> <span class="c1">#create PstData with the data from just the first two columns. Sharing memory is OK. The memory may be laid out in any order (that is col-major and row-major are both OK).</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#print(np.may_share_memory(data1.val, column01.val)) # Do the two ndarray&#39;s share memory? They could (but currently they won&#39;t)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">column201</span> <span class="o">=</span> <span class="n">data1</span><span class="p">[:,[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">view_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">order</span><span class="o">=</span><span class="s1">&#39;A&#39;</span><span class="p">)</span> <span class="c1">#create PstData with the data from three columns, permuted. Sharing memory is OK.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">may_share_memory</span><span class="p">(</span><span class="n">data1</span><span class="o">.</span><span class="n">val</span><span class="p">,</span> <span class="n">column201</span><span class="o">.</span><span class="n">val</span><span class="p">))</span> <span class="c1"># Do the two ndarray&#39;s share memory? No, ndarray decided that this indexing was too complex for sharing.</span>
<span class="go">False</span>
</pre></div>
</div>
</div></blockquote>
<p>Creating Subsetting PstReaders with Indexing</p>
<blockquote>
<div><p>You often don’t want to read the matrix values for all rows and cols. You can use indexing to create a subsetting PstReader that
will read only the matrix values of interest.</p>
<p>PstReaders support the indexing formats supported by ndarray plus two generalizations. Here are examples of indexing with an array
of indexes, with slicing, and with an array of Booleans.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">on_disk</span> <span class="o">=</span> <span class="n">PstNpz</span><span class="p">(</span><span class="n">pstnpz_file</span><span class="p">)</span> <span class="c1"># Specify some data on disk in PstNpz format</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">subset_reader_1</span> <span class="o">=</span> <span class="n">on_disk</span><span class="p">[[</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">],:]</span> <span class="c1">#index with an array of indexes (negatives count from end)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">((</span><span class="n">subset_reader_1</span><span class="o">.</span><span class="n">row_count</span><span class="p">,</span> <span class="n">subset_reader_1</span><span class="o">.</span><span class="n">col_count</span><span class="p">))</span>
<span class="go">(2, 1015)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data1</span> <span class="o">=</span> <span class="n">subset_reader_1</span><span class="o">.</span><span class="n">read</span><span class="p">()</span> <span class="c1"># read just the two rows of interest from the disk</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">subset_reader_2</span> <span class="o">=</span> <span class="n">on_disk</span><span class="p">[:,:</span><span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="c1">#index with a slice</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">((</span><span class="n">subset_reader_2</span><span class="o">.</span><span class="n">row_count</span><span class="p">,</span> <span class="n">subset_reader_2</span><span class="o">.</span><span class="n">col_count</span><span class="p">))</span>
<span class="go">(300, 507)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">boolindexes</span> <span class="o">=</span> <span class="p">[</span><span class="n">s</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;23_&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">on_disk</span><span class="o">.</span><span class="n">col</span><span class="p">]</span> <span class="c1"># create a Boolean index of cols that start &#39;23_&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">subset_reader_3</span> <span class="o">=</span> <span class="n">on_disk</span><span class="p">[:,</span><span class="n">boolindexes</span><span class="p">]</span> <span class="c1">#index with array of Booleans</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">((</span><span class="n">subset_reader_3</span><span class="o">.</span><span class="n">row_count</span><span class="p">,</span> <span class="n">subset_reader_3</span><span class="o">.</span><span class="n">col_count</span><span class="p">))</span>
<span class="go">(300, 24)</span>
</pre></div>
</div>
<p>The first generalization over what ndarray offers is full indexing on both the row dimension and the col dimension, in other words,
full multidimensional indexing. For example,</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">on_disk</span> <span class="o">=</span> <span class="n">PstNpz</span><span class="p">(</span><span class="n">pstnpz_file</span><span class="p">)</span> <span class="c1"># Specify some data on disk in PstNpz format</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">subset_reader_4</span> <span class="o">=</span> <span class="n">on_disk</span><span class="p">[[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],:</span><span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="c1"># index on two dimensions at once</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">((</span><span class="n">subset_reader_4</span><span class="o">.</span><span class="n">row_count</span><span class="p">,</span> <span class="n">subset_reader_4</span><span class="o">.</span><span class="n">col_count</span><span class="p">))</span>
<span class="go">(2, 507)</span>
</pre></div>
</div>
<p>The second generalization is indexing on a single integer index.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">on_disk</span> <span class="o">=</span> <span class="n">PstNpz</span><span class="p">(</span><span class="n">pstnpz_file</span><span class="p">)</span> <span class="c1"># Specify some data on disk in PstNpz format</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">subset_reader_5</span> <span class="o">=</span> <span class="n">on_disk</span><span class="p">[</span><span class="mi">5</span><span class="p">,:]</span> <span class="c1">#index with single integer</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">((</span><span class="n">subset_reader_5</span><span class="o">.</span><span class="n">row_count</span><span class="p">,</span> <span class="n">subset_reader_5</span><span class="o">.</span><span class="n">col_count</span><span class="p">))</span>
<span class="go">(1, 1015)</span>
</pre></div>
</div>
<p>Indexing is also useful when you have matrix values in memory via a <a class="reference internal" href="#pysnptools.pstreader.PstData" title="pysnptools.pstreader.PstData"><code class="xref py py-class docutils literal notranslate"><span class="pre">PstData</span></code></a> index and want to copy a subset of those values.
While you could instead index directly on the <cite>.PstData.val</cite> ndarray, by indexing on the <a class="reference internal" href="#pysnptools.pstreader.PstData" title="pysnptools.pstreader.PstData"><code class="xref py py-class docutils literal notranslate"><span class="pre">PstData</span></code></a> instance you
also get row and col information.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">on_disk</span> <span class="o">=</span> <span class="n">PstNpz</span><span class="p">(</span><span class="n">pstnpz_file</span><span class="p">)</span> <span class="c1"># Specify some data on disk in PstNpz format</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data1</span> <span class="o">=</span> <span class="n">on_disk</span><span class="o">.</span><span class="n">read</span><span class="p">()</span> <span class="c1"># read all matrix values into memory</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">print2</span><span class="p">(</span><span class="n">data1</span><span class="o">.</span><span class="n">col</span><span class="p">[:</span><span class="mi">9</span><span class="p">])</span> <span class="c1"># print the first 9 cols</span>
<span class="go">[&#39;1_12&#39; &#39;1_34&#39; &#39;1_10&#39; &#39;1_35&#39; &#39;1_28&#39; &#39;1_25&#39; &#39;1_36&#39; &#39;1_39&#39; &#39;1_4&#39;]</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">data_subset</span> <span class="o">=</span> <span class="n">data1</span><span class="p">[:,::</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">view_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">order</span><span class="o">=</span><span class="s1">&#39;A&#39;</span><span class="p">)</span> <span class="c1"># create a copy or view with every other col</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">print2</span><span class="p">(</span><span class="n">data_subset</span><span class="o">.</span><span class="n">col</span><span class="p">[:</span><span class="mi">9</span><span class="p">])</span> <span class="c1"># print the first 9 cols in the subset</span>
<span class="go">[&#39;1_12&#39; &#39;1_10&#39; &#39;1_28&#39; &#39;1_36&#39; &#39;1_4&#39; &#39;1_11&#39; &#39;1_32&#39; &#39;1_9&#39; &#39;1_17&#39;]</span>
</pre></div>
</div>
<p>You can apply indexing on top of indexing to specify subsets of subsets of data to read. In this example, 
only the column values for every 16th col is actually read from the disk.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># These are just PstReaders, nothing is read from disk yet</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">on_disk</span> <span class="o">=</span> <span class="n">PstNpz</span><span class="p">(</span><span class="n">pstnpz_file</span><span class="p">)</span> <span class="c1"># Specify some data on disk in PstNpz format</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">half_reader</span> <span class="o">=</span> <span class="n">on_disk</span><span class="p">[:,::</span><span class="mi">2</span><span class="p">]</span> <span class="c1"># a reader for half the cols</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">quarter_reader</span> <span class="o">=</span> <span class="n">half_reader</span><span class="p">[:,::</span><span class="mi">2</span><span class="p">]</span> <span class="c1"># a reader for half of half the cols</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sixteenth_reader</span> <span class="o">=</span> <span class="n">quarter_reader</span><span class="p">[:,::</span><span class="mi">2</span><span class="p">][:,::</span><span class="mi">2</span><span class="p">]</span> <span class="c1"># a reader for half of half of half of half the cols</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">sixteenth_reader</span><span class="p">)</span> <span class="c1">#Print the specification of this reader</span>
<span class="go">PstNpz(...tests/datasets/all_chr.maf0.001.N300.pst.npz&#39;)[:,::2][:,::2][:,::2][:,::2]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Now we read from disk. Only values for one col in every 16 will be read.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data_sixteenth</span> <span class="o">=</span> <span class="n">sixteenth_reader</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">data_sixteenth</span><span class="o">.</span><span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="go">2.0</span>
</pre></div>
</div>
</div></blockquote>
<p>The <a class="reference internal" href="#pysnptools.pstreader.PstReader.read" title="pysnptools.pstreader.PstReader.read"><code class="xref py py-meth docutils literal notranslate"><span class="pre">read()</span></code></a> Method</p>
<blockquote>
<div><p>By default the <a class="reference internal" href="#pysnptools.pstreader.PstReader.read" title="pysnptools.pstreader.PstReader.read"><code class="xref py py-meth docutils literal notranslate"><span class="pre">read()</span></code></a> returns a ndarray of scipy.float64 laid out in memory in F-contiguous order (row-index varies the fastest). You may, instead,
ask for scipy.float32 or for C-contiguous order or any order. See <a class="reference internal" href="#pysnptools.pstreader.PstReader.read" title="pysnptools.pstreader.PstReader.read"><code class="xref py py-meth docutils literal notranslate"><span class="pre">read()</span></code></a> for details.</p>
</div></blockquote>
<p>Details of Methods &amp; Properties:</p>
<dl class="py method">
<dt id="pysnptools.pstreader.PstReader.col">
<em class="property">property </em><code class="sig-name descname">col</code><a class="headerlink" href="#pysnptools.pstreader.PstReader.col" title="Permalink to this definition">¶</a></dt>
<dd><p>A ndarray of the cols id. Each id can be anything, for example, a string, an array of two strings, a number, etc.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray (length <a class="reference internal" href="#pysnptools.pstreader.PstReader.col_count" title="pysnptools.pstreader.PstReader.col_count"><code class="xref py py-attr docutils literal notranslate"><span class="pre">col_count</span></code></a>)</p>
</dd>
</dl>
<p>This property (to the degree practical) reads only row and col data from the disk, not matrix value data.
Moreover, the row and col data is read from file only once.</p>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.pstreader</span> <span class="k">import</span> <span class="n">PstData</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data1</span> <span class="o">=</span> <span class="n">PstData</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">],</span><span class="n">col</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">,</span><span class="s1">&#39;z&#39;</span><span class="p">],</span><span class="n">val</span><span class="o">=</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],[</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span><span class="mi">6</span><span class="p">]],</span><span class="n">row_property</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="s1">&#39;C&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">data1</span><span class="o">.</span><span class="n">col</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="c1"># print the last column id.</span>
<span class="go">z</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data2</span> <span class="o">=</span> <span class="n">PstData</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">],</span><span class="n">col</span><span class="o">=</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">]],</span><span class="n">val</span><span class="o">=</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],[</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span><span class="mi">6</span><span class="p">]],</span><span class="n">row_property</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="s1">&#39;C&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">data2</span><span class="o">.</span><span class="n">col</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="c1"># print the last column id.</span>
<span class="go">[2 0]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="pysnptools.pstreader.PstReader.col_count">
<em class="property">property </em><code class="sig-name descname">col_count</code><a class="headerlink" href="#pysnptools.pstreader.PstReader.col_count" title="Permalink to this definition">¶</a></dt>
<dd><p>number of cols</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>integer</p>
</dd>
</dl>
<p>This property (to the degree practical) reads only row and col data from the disk, not matrix value data. Moreover, the row and col data is read from file only once.</p>
</dd></dl>

<dl class="py method">
<dt id="pysnptools.pstreader.PstReader.col_property">
<em class="property">property </em><code class="sig-name descname">col_property</code><a class="headerlink" href="#pysnptools.pstreader.PstReader.col_property" title="Permalink to this definition">¶</a></dt>
<dd><p>A ndarray of the additional information for each col. Each element is a ndarray.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>1- or 2-dimensional ndarray (length <a class="reference internal" href="#pysnptools.pstreader.PstReader.col_count" title="pysnptools.pstreader.PstReader.col_count"><code class="xref py py-attr docutils literal notranslate"><span class="pre">col_count</span></code></a>)</p>
</dd>
</dl>
<p>This property (to the degree practical) reads only row and col data from the disk, not matrix value data. Moreover, the row and col data is read from file only once.</p>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.pstreader</span> <span class="k">import</span> <span class="n">PstNpz</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.util</span> <span class="k">import</span> <span class="n">example_file</span> <span class="c1"># Download and return local file name</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pstnpz_file</span> <span class="o">=</span> <span class="n">example_file</span><span class="p">(</span><span class="s1">&#39;tests/datasets/all_chr.maf0.001.N300.pst.npz&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">on_disk</span> <span class="o">=</span> <span class="n">PstNpz</span><span class="p">(</span><span class="n">pstnpz_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">on_disk</span><span class="o">.</span><span class="n">col_property</span><span class="p">[:</span><span class="mi">3</span><span class="p">])</span> <span class="c1"># print column information for the first three cols: #The &#39;...&#39; is an optional space</span>
<span class="go">[[...1.          0.00800801  0.        ]</span>
<span class="go"> [...1.          0.023023    1.        ]</span>
<span class="go"> [...1.          0.0700701   4.        ]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="pysnptools.pstreader.PstReader.col_to_index">
<code class="sig-name descname">col_to_index</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">list</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.pstreader.PstReader.col_to_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes a list of column ds and returns a list of index numbers</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>list</strong> (<em>list</em>) – list of cols</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>ndarray of int</p>
</dd>
</dl>
<p>This method (to the degree practical) reads only row and col data from the disk, not matrix value data. Moreover, the row and col data is read from file only once.</p>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.pstreader</span> <span class="k">import</span> <span class="n">PstNpz</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.util</span> <span class="k">import</span> <span class="n">example_file</span> <span class="c1"># Download and return local file name</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pstnpz_file</span> <span class="o">=</span> <span class="n">example_file</span><span class="p">(</span><span class="s1">&#39;tests/datasets/all_chr.maf0.001.N300.pst.npz&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">on_disk</span> <span class="o">=</span> <span class="n">PstNpz</span><span class="p">(</span><span class="n">pstnpz_file</span><span class="p">)</span> <span class="c1"># Specify matrix data on disk</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">on_disk</span><span class="o">.</span><span class="n">col_to_index</span><span class="p">([</span><span class="sa">b</span><span class="s1">&#39;1_10&#39;</span><span class="p">,</span><span class="sa">b</span><span class="s1">&#39;1_13&#39;</span><span class="p">]))</span> <span class="c1">#Find the indexes for two cols.</span>
<span class="go">[2 9]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="pysnptools.pstreader.PstReader.read">
<code class="sig-name descname">read</code><span class="sig-paren">(</span><em class="sig-param">order='F'</em>, <em class="sig-param">dtype=&lt;class 'numpy.float64'&gt;</em>, <em class="sig-param">force_python_only=False</em>, <em class="sig-param">view_ok=False</em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.pstreader.PstReader.read" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads the matrix values and returns a <a class="reference internal" href="#pysnptools.pstreader.PstData" title="pysnptools.pstreader.PstData"><code class="xref py py-class docutils literal notranslate"><span class="pre">PstData</span></code></a> (with <a class="reference internal" href="#pysnptools.pstreader.PstData.val" title="pysnptools.pstreader.PstData.val"><code class="xref py py-attr docutils literal notranslate"><span class="pre">PstData.val</span></code></a> property containing a new ndarray of the matrix values).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>order</strong> (<em>string</em><em> or </em><em>None</em>) – {‘F’ (default), ‘C’, ‘A’}, optional – Specify the order of the ndarray. If order is ‘F’ (default),
then the array will be in F-contiguous order (row-index varies the fastest).
If order is ‘C’, then the returned array will be in C-contiguous order (col-index varies the fastest).
If order is ‘A’, then the <a class="reference internal" href="#pysnptools.pstreader.PstData.val" title="pysnptools.pstreader.PstData.val"><code class="xref py py-attr docutils literal notranslate"><span class="pre">PstData.val</span></code></a>
ndarray may be in any order (either C-, Fortran-contiguous).</p></li>
<li><p><strong>dtype</strong> (<em>data-type</em>) – {scipy.float64 (default), scipy.float32}, optional – The data-type for the <a class="reference internal" href="#pysnptools.pstreader.PstData.val" title="pysnptools.pstreader.PstData.val"><code class="xref py py-attr docutils literal notranslate"><span class="pre">PstData.val</span></code></a> ndarray.</p></li>
<li><p><strong>force_python_only</strong> (<em>bool</em>) – optional – If False (default), may use outside library code. If True, requests that the read
be done without outside library code.</p></li>
<li><p><strong>view_ok</strong> (<em>bool</em>) – optional – If False (default), allocates new memory for the <a class="reference internal" href="#pysnptools.pstreader.PstData.val" title="pysnptools.pstreader.PstData.val"><code class="xref py py-attr docutils literal notranslate"><span class="pre">PstData.val</span></code></a>’s ndarray. If True,
if practical and reading from a <a class="reference internal" href="#pysnptools.pstreader.PstData" title="pysnptools.pstreader.PstData"><code class="xref py py-class docutils literal notranslate"><span class="pre">PstData</span></code></a>, will return a new 
<a class="reference internal" href="#pysnptools.pstreader.PstData" title="pysnptools.pstreader.PstData"><code class="xref py py-class docutils literal notranslate"><span class="pre">PstData</span></code></a> with a ndarray shares memory with the original <a class="reference internal" href="#pysnptools.pstreader.PstData" title="pysnptools.pstreader.PstData"><code class="xref py py-class docutils literal notranslate"><span class="pre">PstData</span></code></a>.
Typically, you’ll also wish to use “order=’A’” to increase the chance that sharing will be possible.
Use these parameters with care because any change to either ndarray will effect
the others. Also keep in mind that <a class="reference internal" href="#pysnptools.pstreader.PstReader.read" title="pysnptools.pstreader.PstReader.read"><code class="xref py py-meth docutils literal notranslate"><span class="pre">read()</span></code></a> relies on ndarray’s mechanisms to decide whether to actually
share memory and so it may ignore your suggestion and allocate a new ndarray anyway.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="#pysnptools.pstreader.PstData" title="pysnptools.pstreader.PstData"><code class="xref py py-class docutils literal notranslate"><span class="pre">PstData</span></code></a></p>
</dd>
</dl>
<p>Calling the method again causes the matrix values to be re-read and creates a new in-memory <a class="reference internal" href="#pysnptools.pstreader.PstData" title="pysnptools.pstreader.PstData"><code class="xref py py-class docutils literal notranslate"><span class="pre">PstData</span></code></a> with a new ndarray of matrix values.</p>
<p>If you request the values for only a subset of the sids or iids, (to the degree practical) only that subset will be read from disk.</p>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.pstreader</span> <span class="k">import</span> <span class="n">PstHdf5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.util</span> <span class="k">import</span> <span class="n">example_file</span> <span class="c1"># Download and return local file name</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hdf5_file</span> <span class="o">=</span> <span class="n">example_file</span><span class="p">(</span><span class="s1">&#39;pysnptools/examples/toydata.iidmajor.snp.hdf5&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">on_disk</span> <span class="o">=</span> <span class="n">PstHdf5</span><span class="p">(</span><span class="n">hdf5_file</span><span class="p">)</span> <span class="c1"># Specify matrix data on disk</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pstdata1</span> <span class="o">=</span> <span class="n">on_disk</span><span class="o">.</span><span class="n">read</span><span class="p">()</span> <span class="c1"># Read all the matrix data returning a PstData instance</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">pstdata1</span><span class="o">.</span><span class="n">val</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span> <span class="c1"># The PstData instance contains a ndarray of the data.</span>
<span class="go">ndarray</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">subset_pstdata</span> <span class="o">=</span> <span class="n">on_disk</span><span class="p">[:,::</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">read</span><span class="p">()</span> <span class="c1"># From the disk, read matrix values for every other sid</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">subset_pstdata</span><span class="o">.</span><span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span> <span class="c1"># Print the first matrix value in the subset</span>
<span class="go">1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">subsub_pstdata</span> <span class="o">=</span> <span class="n">subset_pstdata</span><span class="p">[:</span><span class="mi">10</span><span class="p">,:]</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="n">view_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1"># Create an in-memory subset of the subset with matrix values for the first ten iids. Share memory if practical.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># print(np.may_share_memory(subset_snpdata.val, subsub_snpdata.val)) # Do the two ndarray&#39;s share memory? They could. Currently they won&#39;t.       </span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="pysnptools.pstreader.PstReader.row">
<em class="property">property </em><code class="sig-name descname">row</code><a class="headerlink" href="#pysnptools.pstreader.PstReader.row" title="Permalink to this definition">¶</a></dt>
<dd><p>A ndarray of the row ids. Each id can be anything, for example, a string, an array of two strings, a number, etc.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray (length <a class="reference internal" href="#pysnptools.pstreader.PstReader.row_count" title="pysnptools.pstreader.PstReader.row_count"><code class="xref py py-attr docutils literal notranslate"><span class="pre">row_count</span></code></a>)</p>
</dd>
</dl>
<p>This property (to the degree practical) reads only row and col data from the disk, not matrix value data.
Moreover, the row and col data is read from file only once.</p>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.pstreader</span> <span class="k">import</span> <span class="n">PstData</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data1</span> <span class="o">=</span> <span class="n">PstData</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">],</span><span class="n">col</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">,</span><span class="s1">&#39;z&#39;</span><span class="p">],</span><span class="n">val</span><span class="o">=</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],[</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span><span class="mi">6</span><span class="p">]],</span><span class="n">row_property</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="s1">&#39;C&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">data1</span><span class="o">.</span><span class="n">row</span><span class="p">[:</span><span class="mi">2</span><span class="p">])</span> <span class="c1"># print the first two row ids</span>
<span class="go">[&#39;a&#39; &#39;b&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data2</span> <span class="o">=</span> <span class="n">PstData</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]],</span><span class="n">col</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">,</span><span class="s1">&#39;z&#39;</span><span class="p">],</span><span class="n">val</span><span class="o">=</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],[</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span><span class="mi">6</span><span class="p">]],</span><span class="n">row_property</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="s1">&#39;C&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">data2</span><span class="o">.</span><span class="n">row</span><span class="p">[:</span><span class="mi">2</span><span class="p">])</span> <span class="c1"># print the first two row ids</span>
<span class="go">[[1 0]</span>
<span class="go"> [2 0]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="pysnptools.pstreader.PstReader.row_count">
<em class="property">property </em><code class="sig-name descname">row_count</code><a class="headerlink" href="#pysnptools.pstreader.PstReader.row_count" title="Permalink to this definition">¶</a></dt>
<dd><p>number of rows</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>integer</p>
</dd>
</dl>
<p>This property (to the degree practical) reads only row and col data from the disk, not matrix value data. Moreover, the row and col data is read from file only once.</p>
</dd></dl>

<dl class="py method">
<dt id="pysnptools.pstreader.PstReader.row_property">
<em class="property">property </em><code class="sig-name descname">row_property</code><a class="headerlink" href="#pysnptools.pstreader.PstReader.row_property" title="Permalink to this definition">¶</a></dt>
<dd><p>A ndarray of the additional information for each row. Each element is a ndarray.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>1- or 2-dimensional ndarray (length <a class="reference internal" href="#pysnptools.pstreader.PstReader.row_count" title="pysnptools.pstreader.PstReader.row_count"><code class="xref py py-attr docutils literal notranslate"><span class="pre">row_count</span></code></a>)</p>
</dd>
</dl>
<p>This property (to the degree practical) reads only row and col data from the disk, not matrix value data. Moreover, the row and col data is read from file only once.</p>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.pstreader</span> <span class="k">import</span> <span class="n">PstData</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data1</span> <span class="o">=</span> <span class="n">PstData</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">],</span><span class="n">col</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">,</span><span class="s1">&#39;z&#39;</span><span class="p">],</span><span class="n">val</span><span class="o">=</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],[</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span><span class="mi">6</span><span class="p">]],</span><span class="n">row_property</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="s1">&#39;C&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">data1</span><span class="o">.</span><span class="n">row_property</span><span class="p">[:</span><span class="mi">2</span><span class="p">])</span> <span class="c1"># print the first two row property values</span>
<span class="go">[&#39;A&#39; &#39;B&#39;]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="pysnptools.pstreader.PstReader.row_to_index">
<code class="sig-name descname">row_to_index</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">list</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.pstreader.PstReader.row_to_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes a list of row ids and returns a list of index numbers</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>list</strong> – list of rows</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>ndarray of int</p>
</dd>
</dl>
<p>This method (to the degree practical) reads only row and col data from the disk, not matrix value data. Moreover, the row and col data is read from file only once.</p>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.pstreader</span> <span class="k">import</span> <span class="n">PstNpz</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.util</span> <span class="k">import</span> <span class="n">example_file</span> <span class="c1"># Download and return local file name</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pstnpz_file</span> <span class="o">=</span> <span class="n">example_file</span><span class="p">(</span><span class="s1">&#39;tests/datasets/all_chr.maf0.001.N300.pst.npz&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">on_disk</span> <span class="o">=</span> <span class="n">PstNpz</span><span class="p">(</span><span class="n">pstnpz_file</span><span class="p">)</span> <span class="c1"># Specify matrix data on disk</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">on_disk</span><span class="o">.</span><span class="n">row_to_index</span><span class="p">([[</span><span class="sa">b</span><span class="s1">&#39;POP1&#39;</span><span class="p">,</span><span class="sa">b</span><span class="s1">&#39;44&#39;</span><span class="p">],[</span><span class="sa">b</span><span class="s1">&#39;POP1&#39;</span><span class="p">,</span><span class="sa">b</span><span class="s1">&#39;12&#39;</span><span class="p">]]))</span> <span class="c1">#Find the indexes for two rows.</span>
<span class="go">[2 1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="pysnptools.pstreader.PstReader.shape">
<em class="property">property </em><code class="sig-name descname">shape</code><a class="headerlink" href="#pysnptools.pstreader.PstReader.shape" title="Permalink to this definition">¶</a></dt>
<dd><p>number of rows and number of cols</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple of two integers</p>
</dd>
</dl>
<p>This property (to the degree practical) reads only row and col data from the disk, not matrix value data. Moreover, the row and col data is read from file only once.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="pstreader-pstdata">
<h3><code class="xref py py-class docutils literal notranslate"><span class="pre">pstreader.PstData</span></code><a class="headerlink" href="#pstreader-pstdata" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt id="pysnptools.pstreader.PstData">
<em class="property">class </em><code class="sig-prename descclassname">pysnptools.pstreader.</code><code class="sig-name descname">PstData</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">row</span></em>, <em class="sig-param"><span class="n">col</span></em>, <em class="sig-param"><span class="n">val</span></em>, <em class="sig-param"><span class="n">row_property</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">col_property</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">name</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">parent_string</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">copyinputs_function</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.pstreader.PstData" title="Permalink to this definition">¶</a></dt>
<dd><p>A <a class="reference internal" href="#pysnptools.pstreader.PstReader" title="pysnptools.pstreader.PstReader"><code class="xref py py-class docutils literal notranslate"><span class="pre">PstReader</span></code></a> for holding values in-memory, along with related row and col information.
It is usually created by calling the <a class="reference internal" href="#pysnptools.pstreader.PstReader.read" title="pysnptools.pstreader.PstReader.read"><code class="xref py py-meth docutils literal notranslate"><span class="pre">PstReader.read()</span></code></a> method on another <a class="reference internal" href="#pysnptools.pstreader.PstReader" title="pysnptools.pstreader.PstReader"><code class="xref py py-class docutils literal notranslate"><span class="pre">PstReader</span></code></a>, for example, <a class="reference internal" href="#pysnptools.pstreader.PstNpz" title="pysnptools.pstreader.PstNpz"><code class="xref py py-class docutils literal notranslate"><span class="pre">PstNpz</span></code></a>. It can also be constructed directly.</p>
<p>See <a class="reference internal" href="#pysnptools.pstreader.PstReader" title="pysnptools.pstreader.PstReader"><code class="xref py py-class docutils literal notranslate"><span class="pre">PstReader</span></code></a> for details and examples.</p>
<dl>
<dt><strong>Constructor:</strong></dt><dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>row</strong> (an array of anything) – The <a class="reference internal" href="#pysnptools.pstreader.PstReader.row" title="pysnptools.pstreader.PstReader.row"><code class="xref py py-attr docutils literal notranslate"><span class="pre">PstReader.row</span></code></a> information</p></li>
<li><p><strong>col</strong> (an array of anything) – The <a class="reference internal" href="#pysnptools.pstreader.PstReader.col" title="pysnptools.pstreader.PstReader.col"><code class="xref py py-attr docutils literal notranslate"><span class="pre">PstReader.col</span></code></a> information</p></li>
<li><p><strong>val</strong> (a 2-D array of floats) – The values</p></li>
<li><p><strong>row_property</strong> (optional, an array of anything) – Additional information associated with each row.</p></li>
<li><p><strong>col_property</strong> (optional, an array of anything) – Additional information associated with each col.</p></li>
<li><p><strong>name</strong> (optional, string) – Information to be display about the origin of this data</p></li>
<li><p><strong>copyinputs_function</strong> (optional, function) – <em>Used internally by optional clustering code</em></p></li>
</ul>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">print_function</span> <span class="c1">#Python 2 &amp; 3 compatibility</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.pstreader</span> <span class="k">import</span> <span class="n">PstData</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pstdata</span> <span class="o">=</span> <span class="n">PstData</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="p">[[</span><span class="s1">&#39;fam0&#39;</span><span class="p">,</span><span class="s1">&#39;iid0&#39;</span><span class="p">],[</span><span class="s1">&#39;fam0&#39;</span><span class="p">,</span><span class="s1">&#39;iid1&#39;</span><span class="p">]],</span> <span class="n">col</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;snp334&#39;</span><span class="p">,</span><span class="s1">&#39;snp349&#39;</span><span class="p">,</span><span class="s1">&#39;snp921&#39;</span><span class="p">],</span> <span class="n">val</span><span class="o">=</span><span class="p">[[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">2.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">2.</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">pstdata</span><span class="o">.</span><span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">pstdata</span><span class="o">.</span><span class="n">row_count</span><span class="p">,</span> <span class="n">pstdata</span><span class="o">.</span><span class="n">col_count</span><span class="p">)</span>
<span class="go">2.0 2 3</span>
</pre></div>
</div>
</dd>
</dl>
<p><strong>Equality:</strong></p>
<blockquote>
<div><p>Two PstData objects are equal if their five arrays (<a class="reference internal" href="#pysnptools.pstreader.PstData.val" title="pysnptools.pstreader.PstData.val"><code class="xref py py-attr docutils literal notranslate"><span class="pre">PstData.val</span></code></a>, <a class="reference internal" href="#pysnptools.pstreader.PstReader.row" title="pysnptools.pstreader.PstReader.row"><code class="xref py py-attr docutils literal notranslate"><span class="pre">PstReader.row</span></code></a>, <a class="reference internal" href="#pysnptools.pstreader.PstReader.col" title="pysnptools.pstreader.PstReader.col"><code class="xref py py-attr docutils literal notranslate"><span class="pre">PstReader.col</span></code></a>, <a class="reference internal" href="#pysnptools.pstreader.PstReader.row_property" title="pysnptools.pstreader.PstReader.row_property"><code class="xref py py-attr docutils literal notranslate"><span class="pre">PstReader.row_property</span></code></a>, and <a class="reference internal" href="#pysnptools.pstreader.PstReader.col_property" title="pysnptools.pstreader.PstReader.col_property"><code class="xref py py-attr docutils literal notranslate"><span class="pre">PstReader.col_property</span></code></a>) arrays are equal.
(Their ‘name’ does not need to be the same).  
If either <a class="reference internal" href="#pysnptools.pstreader.PstData.val" title="pysnptools.pstreader.PstData.val"><code class="xref py py-attr docutils literal notranslate"><span class="pre">PstData.val</span></code></a> contains NaN, the objects will not be equal. However, <a class="reference internal" href="#pysnptools.pstreader.PstData.allclose" title="pysnptools.pstreader.PstData.allclose"><code class="xref py py-meth docutils literal notranslate"><span class="pre">PstData.allclose()</span></code></a> can be used to treat NaN as regular values.
Any NaN’s in the other four arrays are treated as regular values.</p>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.pstreader</span> <span class="k">import</span> <span class="n">PstData</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pstdata1</span> <span class="o">=</span> <span class="n">PstData</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="p">[[</span><span class="s1">&#39;fam0&#39;</span><span class="p">,</span><span class="s1">&#39;iid0&#39;</span><span class="p">],[</span><span class="s1">&#39;fam0&#39;</span><span class="p">,</span><span class="s1">&#39;iid1&#39;</span><span class="p">]],</span> <span class="n">col</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;snp334&#39;</span><span class="p">,</span><span class="s1">&#39;snp349&#39;</span><span class="p">,</span><span class="s1">&#39;snp921&#39;</span><span class="p">],</span> <span class="n">val</span><span class="o">=</span><span class="p">[[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">2.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">2.</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pstdata2</span> <span class="o">=</span> <span class="n">PstData</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="p">[[</span><span class="s1">&#39;fam0&#39;</span><span class="p">,</span><span class="s1">&#39;iid0&#39;</span><span class="p">],[</span><span class="s1">&#39;fam0&#39;</span><span class="p">,</span><span class="s1">&#39;iid1&#39;</span><span class="p">]],</span> <span class="n">col</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;snp334&#39;</span><span class="p">,</span><span class="s1">&#39;snp349&#39;</span><span class="p">,</span><span class="s1">&#39;snp921&#39;</span><span class="p">],</span> <span class="n">val</span><span class="o">=</span><span class="p">[[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">2.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">2.</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">pstdata1</span> <span class="o">==</span> <span class="n">pstdata2</span><span class="p">)</span> <span class="c1">#True, because all the arrays have the same values.</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">pstdata1</span><span class="o">.</span><span class="n">val</span> <span class="ow">is</span> <span class="n">pstdata2</span><span class="o">.</span><span class="n">val</span><span class="p">)</span> <span class="c1">#False, because the two arrays have different memory.</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pstdata3</span> <span class="o">=</span> <span class="n">PstData</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">],</span> <span class="n">col</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;snp334&#39;</span><span class="p">,</span><span class="s1">&#39;snp349&#39;</span><span class="p">,</span><span class="s1">&#39;snp921&#39;</span><span class="p">],</span> <span class="n">val</span><span class="o">=</span><span class="p">[[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">2.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">2.</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pstdata4</span> <span class="o">=</span> <span class="n">PstData</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="p">[[</span><span class="s1">&#39;fam0&#39;</span><span class="p">,</span><span class="s1">&#39;iid0&#39;</span><span class="p">],[</span><span class="s1">&#39;fam0&#39;</span><span class="p">,</span><span class="s1">&#39;iid1&#39;</span><span class="p">]],</span> <span class="n">col</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;snp334&#39;</span><span class="p">,</span><span class="s1">&#39;snp349&#39;</span><span class="p">,</span><span class="s1">&#39;snp921&#39;</span><span class="p">],</span> <span class="n">val</span><span class="o">=</span><span class="p">[[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">2.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">2.</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">pstdata3</span> <span class="o">==</span> <span class="n">pstdata4</span><span class="p">)</span> <span class="c1">#False, because the rows have different ids.</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pstdata5</span> <span class="o">=</span> <span class="n">PstData</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="p">[[</span><span class="s1">&#39;fam0&#39;</span><span class="p">,</span><span class="s1">&#39;iid0&#39;</span><span class="p">],[</span><span class="s1">&#39;fam0&#39;</span><span class="p">,</span><span class="s1">&#39;iid1&#39;</span><span class="p">]],</span> <span class="n">col</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;snp334&#39;</span><span class="p">,</span><span class="s1">&#39;snp349&#39;</span><span class="p">,</span><span class="s1">&#39;snp921&#39;</span><span class="p">],</span> <span class="n">val</span><span class="o">=</span><span class="p">[[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">2.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pstdata6</span> <span class="o">=</span> <span class="n">PstData</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="p">[[</span><span class="s1">&#39;fam0&#39;</span><span class="p">,</span><span class="s1">&#39;iid0&#39;</span><span class="p">],[</span><span class="s1">&#39;fam0&#39;</span><span class="p">,</span><span class="s1">&#39;iid1&#39;</span><span class="p">]],</span> <span class="n">col</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;snp334&#39;</span><span class="p">,</span><span class="s1">&#39;snp349&#39;</span><span class="p">,</span><span class="s1">&#39;snp921&#39;</span><span class="p">],</span> <span class="n">val</span><span class="o">=</span><span class="p">[[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">2.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">pstdata5</span> <span class="o">==</span> <span class="n">pstdata6</span><span class="p">)</span> <span class="c1">#False, because the val&#39;s contain NaN</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">pstdata5</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">pstdata6</span><span class="p">))</span> <span class="c1">#True, if we consider the NaN as regular values, all the arrays have the same values.</span>
<span class="go">True</span>
</pre></div>
</div>
</div></blockquote>
<p><strong>Methods beyond</strong> <a class="reference internal" href="#pysnptools.pstreader.PstReader" title="pysnptools.pstreader.PstReader"><code class="xref py py-class docutils literal notranslate"><span class="pre">PstReader</span></code></a></p>
<dl class="py method">
<dt id="pysnptools.pstreader.PstData.allclose">
<code class="sig-name descname">allclose</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">value</span></em>, <em class="sig-param"><span class="n">equal_nan</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.pstreader.PstData.allclose" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>value</strong> (<a class="reference internal" href="#pysnptools.pstreader.PstData" title="pysnptools.pstreader.PstData"><code class="xref py py-class docutils literal notranslate"><span class="pre">PstData</span></code></a>) – Other object with which to compare.</p></li>
<li><p><strong>equal_nan</strong> (<em>bool</em>) – (Default: True) Tells if NaN in <a class="reference internal" href="#pysnptools.pstreader.PstData.val" title="pysnptools.pstreader.PstData.val"><code class="xref py py-attr docutils literal notranslate"><span class="pre">PstData.val</span></code></a> should be treated as regular values when testing equality.</p></li>
</ul>
</dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pstdata5</span> <span class="o">=</span> <span class="n">PstData</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="p">[[</span><span class="s1">&#39;fam0&#39;</span><span class="p">,</span><span class="s1">&#39;iid0&#39;</span><span class="p">],[</span><span class="s1">&#39;fam0&#39;</span><span class="p">,</span><span class="s1">&#39;iid1&#39;</span><span class="p">]],</span> <span class="n">col</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;snp334&#39;</span><span class="p">,</span><span class="s1">&#39;snp349&#39;</span><span class="p">,</span><span class="s1">&#39;snp921&#39;</span><span class="p">],</span> <span class="n">val</span><span class="o">=</span><span class="p">[[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">2.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pstdata6</span> <span class="o">=</span> <span class="n">PstData</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="p">[[</span><span class="s1">&#39;fam0&#39;</span><span class="p">,</span><span class="s1">&#39;iid0&#39;</span><span class="p">],[</span><span class="s1">&#39;fam0&#39;</span><span class="p">,</span><span class="s1">&#39;iid1&#39;</span><span class="p">]],</span> <span class="n">col</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;snp334&#39;</span><span class="p">,</span><span class="s1">&#39;snp349&#39;</span><span class="p">,</span><span class="s1">&#39;snp921&#39;</span><span class="p">],</span> <span class="n">val</span><span class="o">=</span><span class="p">[[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">2.</span><span class="p">,</span><span class="mf">0.</span><span class="p">],[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">pstdata5</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">pstdata6</span><span class="p">))</span> <span class="c1">#True, if we consider the NaN as regular values, all the arrays have the same values.</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">pstdata5</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">pstdata6</span><span class="p">,</span><span class="n">equal_nan</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span> <span class="c1">#False, if we consider the NaN as special values, all the arrays are not equal.</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="pysnptools.pstreader.PstData.val">
<em class="property">property </em><code class="sig-name descname">val</code><a class="headerlink" href="#pysnptools.pstreader.PstData.val" title="Permalink to this definition">¶</a></dt>
<dd><p>The 2D NumPy array of floats that represents the values.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.pstreader</span> <span class="k">import</span> <span class="n">PstNpz</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">fastlmm.util</span> <span class="k">import</span> <span class="n">example_file</span>
<span class="gp">&gt;&gt;&gt; </span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pstnpz_file</span> <span class="o">=</span> <span class="n">example_file</span><span class="p">(</span><span class="s1">&#39;pysnptools/examples/toydata.pst.npz&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pstdata</span> <span class="o">=</span> <span class="n">PstNpz</span><span class="p">(</span><span class="n">pstnpz_file</span><span class="p">)[:</span><span class="mi">5</span><span class="p">,:]</span><span class="o">.</span><span class="n">read</span><span class="p">()</span> <span class="c1">#read data for first 5 rows</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">pstdata</span><span class="o">.</span><span class="n">val</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">100</span><span class="p">])</span> <span class="c1">#print one of the values</span>
<span class="go">2.0</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="pstreader-psthdf5">
<h3><code class="xref py py-class docutils literal notranslate"><span class="pre">pstreader.PstHdf5</span></code><a class="headerlink" href="#pstreader-psthdf5" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt id="pysnptools.pstreader.PstHdf5">
<em class="property">class </em><code class="sig-prename descclassname">pysnptools.pstreader.</code><code class="sig-name descname">PstHdf5</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.pstreader.PstHdf5" title="Permalink to this definition">¶</a></dt>
<dd><p>A <a class="reference internal" href="#pysnptools.pstreader.PstReader" title="pysnptools.pstreader.PstReader"><code class="xref py py-class docutils literal notranslate"><span class="pre">PstReader</span></code></a> for reading *.pst.hdf5 files from disk.</p>
<p>See <a class="reference internal" href="#pysnptools.pstreader.PstReader" title="pysnptools.pstreader.PstReader"><code class="xref py py-class docutils literal notranslate"><span class="pre">PstReader</span></code></a> for general examples of using PstReaders.</p>
<p>The general HDF5 format is described in <a class="reference external" href="http://www.hdfgroup.org/HDF5/">http://www.hdfgroup.org/HDF5/</a>. The PstHdf5 format stores
val, row, col, row_property, and col_property information in Hdf5 format.</p>
<dl>
<dt><strong>Constructor:</strong></dt><dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>string</em>) – The PstHdf5 file to read.</p></li>
</ul>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">print_function</span> <span class="c1">#Python 2 &amp; 3 compatibility</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.pstreader</span> <span class="k">import</span> <span class="n">PstHdf5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.util</span> <span class="k">import</span> <span class="n">example_file</span> <span class="c1"># Download and return local file name</span>
<span class="gp">&gt;&gt;&gt; </span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">psthdf5_file</span> <span class="o">=</span> <span class="n">example_file</span><span class="p">(</span><span class="s1">&#39;pysnptools/examples/toydata.iidmajor.snp.hdf5&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">on_disk</span> <span class="o">=</span> <span class="n">PstHdf5</span><span class="p">(</span><span class="n">psthdf5_file</span><span class="p">)</span> <span class="c1"># PstHdf5 can load .pst.hdf5, .snp.hdf5, and kernel.hdf5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">on_disk</span><span class="o">.</span><span class="n">row_count</span><span class="p">)</span>
<span class="go">500</span>
</pre></div>
</div>
</dd>
</dl>
<p><strong>Methods beyond</strong> <a class="reference internal" href="#pysnptools.pstreader.PstReader" title="pysnptools.pstreader.PstReader"><code class="xref py py-class docutils literal notranslate"><span class="pre">PstReader</span></code></a></p>
<dl class="py method">
<dt id="pysnptools.pstreader.PstHdf5.write">
<em class="property">static </em><code class="sig-name descname">write</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span></em>, <em class="sig-param"><span class="n">pstdata</span></em>, <em class="sig-param"><span class="n">hdf5_dtype</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">col_major</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.pstreader.PstHdf5.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes a <a class="reference internal" href="#pysnptools.pstreader.PstData" title="pysnptools.pstreader.PstData"><code class="xref py py-class docutils literal notranslate"><span class="pre">PstData</span></code></a> to PstHdf5 format and returns the <a class="reference internal" href="#pysnptools.pstreader.PstHdf5" title="pysnptools.pstreader.PstHdf5"><code class="xref py py-class docutils literal notranslate"><span class="pre">PstHdf5</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>string</em>) – the name of the file to create</p></li>
<li><p><strong>pstdata</strong> (<a class="reference internal" href="#pysnptools.pstreader.PstData" title="pysnptools.pstreader.PstData"><code class="xref py py-class docutils literal notranslate"><span class="pre">PstData</span></code></a>) – The in-memory data that should be written to disk.</p></li>
<li><p><strong>hdf5_dtype</strong> (<em>string</em>) – None (use the .val’s dtype) or a Hdf5 dtype, e.g. ‘f8’,’f4’,etc.</p></li>
<li><p><strong>col_major</strong> (<em>bool</em>) – Tells if vals should be stored on disk in col_major (default) or row_major format.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="#pysnptools.pstreader.PstHdf5" title="pysnptools.pstreader.PstHdf5"><code class="xref py py-class docutils literal notranslate"><span class="pre">PstHdf5</span></code></a></p>
</dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.pstreader</span> <span class="k">import</span> <span class="n">PstData</span><span class="p">,</span> <span class="n">PstHdf5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pysnptools.util</span> <span class="k">as</span> <span class="nn">pstutil</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data1</span> <span class="o">=</span> <span class="n">PstData</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">],</span><span class="n">col</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">,</span><span class="s1">&#39;z&#39;</span><span class="p">],</span><span class="n">val</span><span class="o">=</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],[</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span><span class="mi">6</span><span class="p">]],</span><span class="n">row_property</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="s1">&#39;C&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pstutil</span><span class="o">.</span><span class="n">create_directory_if_necessary</span><span class="p">(</span><span class="s2">&quot;tempdir/tiny.pst.hdf5&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">PstHdf5</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;tempdir/tiny.pst.hdf5&quot;</span><span class="p">,</span><span class="n">data1</span><span class="p">)</span>          <span class="c1"># Write data in PstHdf5 format</span>
<span class="go">PstHdf5(&#39;tempdir/tiny.pst.hdf5&#39;)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="pstreader-pstnpz">
<h3><code class="xref py py-class docutils literal notranslate"><span class="pre">pstreader.PstNpz</span></code><a class="headerlink" href="#pstreader-pstnpz" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt id="pysnptools.pstreader.PstNpz">
<em class="property">class </em><code class="sig-prename descclassname">pysnptools.pstreader.</code><code class="sig-name descname">PstNpz</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.pstreader.PstNpz" title="Permalink to this definition">¶</a></dt>
<dd><p>A <a class="reference internal" href="#pysnptools.pstreader.PstReader" title="pysnptools.pstreader.PstReader"><code class="xref py py-class docutils literal notranslate"><span class="pre">PstReader</span></code></a> for reading *.pst.npz files from disk.</p>
<p>See <a class="reference internal" href="#pysnptools.pstreader.PstReader" title="pysnptools.pstreader.PstReader"><code class="xref py py-class docutils literal notranslate"><span class="pre">PstReader</span></code></a> for general examples of using PstReaders.</p>
<p>The general NPZ format is described in <a class="reference external" href="http://docs.scipy.org/doc/numpy/reference/generated/numpy.savez.html">http://docs.scipy.org/doc/numpy/reference/generated/numpy.savez.html</a>. The PstNpz format stores
val, row, col, row_property, and col_property information in NPZ format.</p>
<dl>
<dt><strong>Constructor:</strong></dt><dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>string</em>) – The PstNpz file to read.</p></li>
</ul>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">print_function</span> <span class="c1">#Python 2 &amp; 3 compatibility</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.pstreader</span> <span class="k">import</span> <span class="n">PstNpz</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.util</span> <span class="k">import</span> <span class="n">example_file</span> <span class="c1"># Download and return local file name</span>
<span class="gp">&gt;&gt;&gt; </span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pstnpz_file</span> <span class="o">=</span> <span class="n">example_file</span><span class="p">(</span><span class="s1">&#39;tests/datasets/little.pst.npz&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data_on_disk</span> <span class="o">=</span> <span class="n">PstNpz</span><span class="p">(</span><span class="n">pstnpz_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">data_on_disk</span><span class="o">.</span><span class="n">row_count</span><span class="p">)</span>
<span class="go">300</span>
</pre></div>
</div>
</dd>
</dl>
<p><strong>Methods beyond</strong> <code class="xref py py-class docutils literal notranslate"><span class="pre">NpzReader</span></code></p>
<dl class="py method">
<dt id="pysnptools.pstreader.PstNpz.write">
<em class="property">static </em><code class="sig-name descname">write</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span></em>, <em class="sig-param"><span class="n">pstdata</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.pstreader.PstNpz.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes a <a class="reference internal" href="#pysnptools.pstreader.PstData" title="pysnptools.pstreader.PstData"><code class="xref py py-class docutils literal notranslate"><span class="pre">PstData</span></code></a> to PstNpz format and returns the <a class="reference internal" href="#pysnptools.pstreader.PstNpz" title="pysnptools.pstreader.PstNpz"><code class="xref py py-class docutils literal notranslate"><span class="pre">PstNpz</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>string</em>) – the name of the file to create</p></li>
<li><p><strong>pstdata</strong> (<a class="reference internal" href="#pysnptools.pstreader.PstData" title="pysnptools.pstreader.PstData"><code class="xref py py-class docutils literal notranslate"><span class="pre">PstData</span></code></a>) – The in-memory data that should be written to disk.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="#pysnptools.pstreader.PstNpz" title="pysnptools.pstreader.PstNpz"><code class="xref py py-class docutils literal notranslate"><span class="pre">PstNpz</span></code></a></p>
</dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.pstreader</span> <span class="k">import</span> <span class="n">PstData</span><span class="p">,</span> <span class="n">PstNpz</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pysnptools.util</span> <span class="k">as</span> <span class="nn">pstutil</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data1</span> <span class="o">=</span> <span class="n">PstData</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">],</span><span class="n">col</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">,</span><span class="s1">&#39;z&#39;</span><span class="p">],</span><span class="n">val</span><span class="o">=</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],[</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span><span class="mi">6</span><span class="p">]],</span><span class="n">row_property</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="s1">&#39;C&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pstutil</span><span class="o">.</span><span class="n">create_directory_if_necessary</span><span class="p">(</span><span class="s2">&quot;tempdir/tiny.pst.npz&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">PstNpz</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;tempdir/tiny.pst.npz&quot;</span><span class="p">,</span><span class="n">data1</span><span class="p">)</span>          <span class="c1"># Write data in PstNz format</span>
<span class="go">PstNpz(&#39;tempdir/tiny.pst.npz&#39;)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="pstreader-pstmemmap">
<h3><code class="xref py py-class docutils literal notranslate"><span class="pre">pstreader.PstMemMap</span></code><a class="headerlink" href="#pstreader-pstmemmap" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt id="pysnptools.pstreader.PstMemMap">
<em class="property">class </em><code class="sig-prename descclassname">pysnptools.pstreader.</code><code class="sig-name descname">PstMemMap</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.pstreader.PstMemMap" title="Permalink to this definition">¶</a></dt>
<dd><p>A <a class="reference internal" href="#pysnptools.pstreader.PstData" title="pysnptools.pstreader.PstData"><code class="xref py py-class docutils literal notranslate"><span class="pre">PstData</span></code></a> that keeps its data in a memory-mapped file. This allows data large than fits in main memory.</p>
<p>See <a class="reference internal" href="#pysnptools.pstreader.PstData" title="pysnptools.pstreader.PstData"><code class="xref py py-class docutils literal notranslate"><span class="pre">PstData</span></code></a> for general examples of using PstData.</p>
<dl>
<dt><strong>Constructor:</strong></dt><dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>filename</strong> (<em>string</em>) – The <em>*.pst.memmap</em> file to read.</p>
</dd>
</dl>
<p>Also see <a class="reference internal" href="#pysnptools.pstreader.PstMemMap.empty" title="pysnptools.pstreader.PstMemMap.empty"><code class="xref py py-meth docutils literal notranslate"><span class="pre">PstMemMap.empty()</span></code></a> and <a class="reference internal" href="#pysnptools.pstreader.PstMemMap.write" title="pysnptools.pstreader.PstMemMap.write"><code class="xref py py-meth docutils literal notranslate"><span class="pre">PstMemMap.write()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.pstreader</span> <span class="k">import</span> <span class="n">PstMemMap</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">print_function</span> <span class="c1">#Python 2 &amp; 3 compatibility</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.util</span> <span class="k">import</span> <span class="n">example_file</span> <span class="c1"># Download and return local file name</span>
<span class="gp">&gt;&gt;&gt; </span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pst_mem_map_file</span> <span class="o">=</span> <span class="n">example_file</span><span class="p">(</span><span class="s1">&#39;pysnptools/examples/tiny.pst.memmap&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pst_mem_map</span> <span class="o">=</span> <span class="n">PstMemMap</span><span class="p">(</span><span class="n">pst_mem_map_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">pst_mem_map</span><span class="o">.</span><span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">pst_mem_map</span><span class="o">.</span><span class="n">row_count</span><span class="p">,</span> <span class="n">pst_mem_map</span><span class="o">.</span><span class="n">col_count</span><span class="p">)</span>
<span class="go">2.0 3 2</span>
</pre></div>
</div>
</dd>
</dl>
<p><strong>Methods beyond</strong> <a class="reference internal" href="#pysnptools.pstreader.PstReader" title="pysnptools.pstreader.PstReader"><code class="xref py py-class docutils literal notranslate"><span class="pre">PstReader</span></code></a></p>
<dl class="py method">
<dt id="pysnptools.pstreader.PstMemMap.empty">
<em class="property">static </em><code class="sig-name descname">empty</code><span class="sig-paren">(</span><em class="sig-param">row</em>, <em class="sig-param">col</em>, <em class="sig-param">filename</em>, <em class="sig-param">row_property=None</em>, <em class="sig-param">col_property=None</em>, <em class="sig-param">order='F'</em>, <em class="sig-param">dtype=&lt;class 'numpy.float64'&gt;</em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.pstreader.PstMemMap.empty" title="Permalink to this definition">¶</a></dt>
<dd><p>Create an empty <a class="reference internal" href="#pysnptools.pstreader.PstMemMap" title="pysnptools.pstreader.PstMemMap"><code class="xref py py-class docutils literal notranslate"><span class="pre">PstMemMap</span></code></a> on disk.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>row</strong> (<em>an array of anything</em>) – The <a class="reference internal" href="#pysnptools.pstreader.PstReader.row" title="pysnptools.pstreader.PstReader.row"><code class="xref py py-attr docutils literal notranslate"><span class="pre">PstReader.row</span></code></a> information</p></li>
<li><p><strong>col</strong> (<em>an array of anything</em>) – The <a class="reference internal" href="#pysnptools.pstreader.PstReader.col" title="pysnptools.pstreader.PstReader.col"><code class="xref py py-attr docutils literal notranslate"><span class="pre">PstReader.col</span></code></a> information</p></li>
<li><p><strong>filename</strong> (<em>string</em>) – name of memory-mapped file to create</p></li>
<li><p><strong>row_property</strong> (<em>an array of anything</em>) – optional – The additional <a class="reference internal" href="#pysnptools.pstreader.PstReader.row_property" title="pysnptools.pstreader.PstReader.row_property"><code class="xref py py-attr docutils literal notranslate"><span class="pre">PstReader.row_property</span></code></a> information associated with each row. Default: None</p></li>
<li><p><strong>col_property</strong> (<em>an array of anything</em>) – optional – The additional <a class="reference internal" href="#pysnptools.pstreader.PstReader.col_property" title="pysnptools.pstreader.PstReader.col_property"><code class="xref py py-attr docutils literal notranslate"><span class="pre">PstReader.col_property</span></code></a> information associated with each col. Default: None</p></li>
<li><p><strong>order</strong> (<em>string</em><em> or </em><em>None</em>) – {‘F’ (default), ‘C’}, optional – Specify the order of the ndarray.</p></li>
<li><p><strong>dtype</strong> (<em>data-type</em>) – {scipy.float64 (default), scipy.float32}, optional – The data-type for the <a class="reference internal" href="#pysnptools.pstreader.PstMemMap.val" title="pysnptools.pstreader.PstMemMap.val"><code class="xref py py-attr docutils literal notranslate"><span class="pre">PstMemMap.val</span></code></a> ndarray.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="#pysnptools.pstreader.PstMemMap" title="pysnptools.pstreader.PstMemMap"><code class="xref py py-class docutils literal notranslate"><span class="pre">PstMemMap</span></code></a></p>
</dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pysnptools.util</span> <span class="k">as</span> <span class="nn">pstutil</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.pstreader</span> <span class="k">import</span> <span class="n">PstMemMap</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filename</span> <span class="o">=</span> <span class="s2">&quot;tempdir/tiny.pst.memmap&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pstutil</span><span class="o">.</span><span class="n">create_directory_if_necessary</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pst_mem_map</span> <span class="o">=</span> <span class="n">PstMemMap</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">],</span><span class="n">col</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">,</span><span class="s1">&#39;z&#39;</span><span class="p">],</span><span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span><span class="n">row_property</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="s1">&#39;C&#39;</span><span class="p">],</span><span class="n">order</span><span class="o">=</span><span class="s2">&quot;F&quot;</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pst_mem_map</span><span class="o">.</span><span class="n">val</span><span class="p">[:,:]</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],[</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span><span class="mi">6</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pst_mem_map</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="pysnptools.pstreader.PstMemMap.filename">
<em class="property">property </em><code class="sig-name descname">filename</code><a class="headerlink" href="#pysnptools.pstreader.PstMemMap.filename" title="Permalink to this definition">¶</a></dt>
<dd><p>The name of the memory-mapped file</p>
</dd></dl>

<dl class="py method">
<dt id="pysnptools.pstreader.PstMemMap.flush">
<code class="sig-name descname">flush</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.pstreader.PstMemMap.flush" title="Permalink to this definition">¶</a></dt>
<dd><p>Flush <a class="reference internal" href="#pysnptools.pstreader.PstMemMap.val" title="pysnptools.pstreader.PstMemMap.val"><code class="xref py py-attr docutils literal notranslate"><span class="pre">PstMemMap.val</span></code></a> to disk and close the file. (If values or properties are accessed again, the file will be reopened.)</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pysnptools.util</span> <span class="k">as</span> <span class="nn">pstutil</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.pstreader</span> <span class="k">import</span> <span class="n">PstMemMap</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filename</span> <span class="o">=</span> <span class="s2">&quot;tempdir/tiny.pst.memmap&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pstutil</span><span class="o">.</span><span class="n">create_directory_if_necessary</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pst_mem_map</span> <span class="o">=</span> <span class="n">PstMemMap</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">],</span><span class="n">col</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">,</span><span class="s1">&#39;z&#39;</span><span class="p">],</span><span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span><span class="n">row_property</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="s1">&#39;C&#39;</span><span class="p">],</span><span class="n">order</span><span class="o">=</span><span class="s2">&quot;F&quot;</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pst_mem_map</span><span class="o">.</span><span class="n">val</span><span class="p">[:,:]</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],[</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span><span class="mi">6</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pst_mem_map</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="pysnptools.pstreader.PstMemMap.offset">
<em class="property">property </em><code class="sig-name descname">offset</code><a class="headerlink" href="#pysnptools.pstreader.PstMemMap.offset" title="Permalink to this definition">¶</a></dt>
<dd><p>The byte position in the file where the memory-mapped values start.</p>
</dd></dl>

<dl class="py method">
<dt id="pysnptools.pstreader.PstMemMap.val">
<em class="property">property </em><code class="sig-name descname">val</code><a class="headerlink" href="#pysnptools.pstreader.PstMemMap.val" title="Permalink to this definition">¶</a></dt>
<dd><p>The 2D NumPy memmap array of floats that represents the values.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.pstreader</span> <span class="k">import</span> <span class="n">PstMemMap</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.util</span> <span class="k">import</span> <span class="n">example_file</span> <span class="c1"># Download and return local file name</span>
<span class="gp">&gt;&gt;&gt; </span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pst_mem_map_file</span> <span class="o">=</span> <span class="n">example_file</span><span class="p">(</span><span class="s1">&#39;pysnptools/examples/tiny.pst.memmap&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pst_mem_map</span> <span class="o">=</span> <span class="n">PstMemMap</span><span class="p">(</span><span class="n">pst_mem_map_file</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">pst_mem_map</span><span class="o">.</span><span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="go">2.0</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="pysnptools.pstreader.PstMemMap.write">
<em class="property">static </em><code class="sig-name descname">write</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span></em>, <em class="sig-param"><span class="n">pstdata</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.pstreader.PstMemMap.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes a <a class="reference internal" href="#pysnptools.pstreader.PstData" title="pysnptools.pstreader.PstData"><code class="xref py py-class docutils literal notranslate"><span class="pre">PstData</span></code></a> to <a class="reference internal" href="#pysnptools.pstreader.PstMemMap" title="pysnptools.pstreader.PstMemMap"><code class="xref py py-class docutils literal notranslate"><span class="pre">PstMemMap</span></code></a> format and returns the <a class="reference internal" href="#pysnptools.pstreader.PstMemMap" title="pysnptools.pstreader.PstMemMap"><code class="xref py py-class docutils literal notranslate"><span class="pre">PstMemMap</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>string</em>) – the name of the file to create</p></li>
<li><p><strong>pstdata</strong> (<a class="reference internal" href="#pysnptools.pstreader.PstData" title="pysnptools.pstreader.PstData"><code class="xref py py-class docutils literal notranslate"><span class="pre">PstData</span></code></a>) – The in-memory data that should be written to disk.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="#pysnptools.pstreader.PstMemMap" title="pysnptools.pstreader.PstMemMap"><code class="xref py py-class docutils literal notranslate"><span class="pre">PstMemMap</span></code></a></p>
</dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pysnptools.util</span> <span class="k">as</span> <span class="nn">pstutil</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.pstreader</span> <span class="k">import</span> <span class="n">PstData</span><span class="p">,</span> <span class="n">PstMemMap</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data1</span> <span class="o">=</span> <span class="n">PstData</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">],</span><span class="n">col</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">,</span><span class="s1">&#39;z&#39;</span><span class="p">],</span><span class="n">val</span><span class="o">=</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],[</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span><span class="mi">6</span><span class="p">]],</span><span class="n">row_property</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="s1">&#39;C&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pstutil</span><span class="o">.</span><span class="n">create_directory_if_necessary</span><span class="p">(</span><span class="s2">&quot;tempdir/tiny.pst.memmap&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">PstMemMap</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;tempdir/tiny.pst.memmap&quot;</span><span class="p">,</span><span class="n">data1</span><span class="p">)</span>      <span class="c1"># Write data1 in PstMemMap format</span>
<span class="go">PstMemMap(&#39;tempdir/tiny.pst.memmap&#39;)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</div>
</div>
<div class="section" id="util-module">
<h2><code class="xref py py-mod docutils literal notranslate"><span class="pre">util</span></code> Module<a class="headerlink" href="#util-module" title="Permalink to this headline">¶</a></h2>
<div class="section" id="module-pysnptools.util">
<span id="util"></span><h3><code class="xref py py-mod docutils literal notranslate"><span class="pre">util</span></code><a class="headerlink" href="#module-pysnptools.util" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt id="pysnptools.util.create_directory_if_necessary">
<code class="sig-prename descclassname">pysnptools.util.</code><code class="sig-name descname">create_directory_if_necessary</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">name</span></em>, <em class="sig-param"><span class="n">isfile</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">robust</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.create_directory_if_necessary" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a directory for a file if the directory doesn’t already exist.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<em>string</em>) – file or directory name</p></li>
<li><p><strong>isfile</strong> (<em>bool</em>) – If True (default), the name is a file, otherwise it is a directory.</p></li>
<li><p><strong>robust</strong> (<em>bool</em>) – If False (default), will try once to create the directory. If True, will try 25 times.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pysnptools.util.format_delta">
<code class="sig-prename descclassname">pysnptools.util.</code><code class="sig-name descname">format_delta</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">delta_seconds</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.format_delta" title="Permalink to this definition">¶</a></dt>
<dd><p>Format a time delta nicely.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>delta_seconds</strong> (<em>number</em>) – The number of seconds</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>string</p>
</dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">print_function</span> <span class="c1">#Python 2 &amp; 3 compatibility</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.util</span> <span class="k">import</span> <span class="n">format_delta</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">format_delta</span><span class="p">(</span><span class="mf">86403.5</span><span class="p">))</span>
<span class="go">1 day, 0:00:03.500000</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="pysnptools.util.intersect_apply">
<code class="sig-prename descclassname">pysnptools.util.</code><code class="sig-name descname">intersect_apply</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data_list</span></em>, <em class="sig-param"><span class="n">sort_by_dataset</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">intersect_before_standardize</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">is_test</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.intersect_apply" title="Permalink to this definition">¶</a></dt>
<dd><p>Intersects and sorts the iids from a list of datasets, returning new version of the datasets with all the same iids in the same order.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_list</strong> (<em>list</em>) – list of datasets</p></li>
<li><p><strong>sort_by_dataset</strong> (<em>bool</em>) – optional, If True (default), the iids are ordered according to the first non-None dataset.
If False, the order is arbitrary, but consistent.</p></li>
<li><p><strong>intersect_before_standardize</strong> (<em>bool</em>) – optional. Special code for <a class="reference internal" href="#pysnptools.kernelreader.SnpKernel" title="pysnptools.kernelreader.SnpKernel"><code class="xref py py-class docutils literal notranslate"><span class="pre">SnpKernel</span></code></a>, the class that postpones computing a kernel from SNP data. 
If True (default), <a class="reference internal" href="#pysnptools.kernelreader.SnpKernel" title="pysnptools.kernelreader.SnpKernel"><code class="xref py py-class docutils literal notranslate"><span class="pre">SnpKernel</span></code></a> will remove any iids before SNP standardization before computing the kernel.
If False, SNPs will be standardized with all iids, then the kernel will be computed, then any iids will be removed.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>list of datasets</p>
</dd>
</dl>
<p>Here are the dataset formats understood and what is returned for each.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 42%" />
<col style="width: 58%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Dataset Format</p></th>
<th class="head"><p>What is Returned</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>None</p></td>
<td><p>None</p></td>
</tr>
<tr class="row-odd"><td><p>A <a class="reference internal" href="#pysnptools.snpreader.SnpReader" title="pysnptools.snpreader.SnpReader"><code class="xref py py-class docutils literal notranslate"><span class="pre">SnpReader</span></code></a></p></td>
<td><p>A new subsetting <a class="reference internal" href="#pysnptools.snpreader.SnpReader" title="pysnptools.snpreader.SnpReader"><code class="xref py py-class docutils literal notranslate"><span class="pre">SnpReader</span></code></a> with adjusted iid</p></td>
</tr>
<tr class="row-even"><td><p>A <a class="reference internal" href="#pysnptools.kernelreader.KernelReader" title="pysnptools.kernelreader.KernelReader"><code class="xref py py-class docutils literal notranslate"><span class="pre">KernelReader</span></code></a></p></td>
<td><p>A new subsetting <a class="reference internal" href="#pysnptools.kernelreader.KernelReader" title="pysnptools.kernelreader.KernelReader"><code class="xref py py-class docutils literal notranslate"><span class="pre">KernelReader</span></code></a> with adjusted iid</p></td>
</tr>
<tr class="row-odd"><td><p>A dictionary with [‘iid’] and [‘vals’] keys</p></td>
<td><p>The same dictionary but with the iid and vals values adjusted</p></td>
</tr>
<tr class="row-even"><td><p>Tuple of the form (val ndarray, iid list)</p></td>
<td><p>A new tuple with the val ndarray and iid list adjusted</p></td>
</tr>
</tbody>
</table>
<p>If the iids in all the datasets are already the same and in the same order, then the datasets are returned without change.</p>
<p>Notice that only dictionaries are processed in-place. Inputting a <a class="reference internal" href="#pysnptools.snpreader.SnpReader" title="pysnptools.snpreader.SnpReader"><code class="xref py py-class docutils literal notranslate"><span class="pre">SnpReader</span></code></a> and <a class="reference internal" href="#pysnptools.kernelreader.KernelReader" title="pysnptools.kernelreader.KernelReader"><code class="xref py py-class docutils literal notranslate"><span class="pre">KernelReader</span></code></a> returns a new class of the same type (unless its iids
are already ok). Inputting a tuple returns a new tuple (unless its iids are already ok).</p>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">print_function</span> <span class="c1">#Python 2 &amp; 3 compatibility</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.snpreader</span> <span class="k">import</span> <span class="n">Bed</span><span class="p">,</span> <span class="n">Pheno</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.kernelreader</span> <span class="k">import</span> <span class="n">SnpKernel</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.standardizer</span> <span class="k">import</span> <span class="n">Unit</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#Create five datasets in different formats</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ignore_in</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.util</span> <span class="k">import</span> <span class="n">example_file</span> <span class="c1"># Download and return local file name</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bedfile</span> <span class="o">=</span> <span class="n">example_file</span><span class="p">(</span><span class="s2">&quot;tests/datasets/all_chr.maf0.001.N300.*&quot;</span><span class="p">,</span><span class="s2">&quot;*.bed&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">phenofile</span> <span class="o">=</span> <span class="n">example_file</span><span class="p">(</span><span class="s2">&quot;tests/datasets/phenSynthFrom22.23.N300.randcidorder.txt&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">covfile</span> <span class="o">=</span> <span class="n">example_file</span><span class="p">(</span><span class="s2">&quot;tests/datasets/all_chr.maf0.001.covariates.N300.txt&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kernel_in</span> <span class="o">=</span> <span class="n">SnpKernel</span><span class="p">(</span><span class="n">Bed</span><span class="p">(</span><span class="n">bedfile</span><span class="p">,</span><span class="n">count_A1</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span><span class="n">Unit</span><span class="p">())</span> <span class="c1"># Create a kernel from a Bed file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pheno_in</span> <span class="o">=</span> <span class="n">Pheno</span><span class="p">(</span><span class="n">phenofile</span><span class="p">,</span><span class="n">missing</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cov</span> <span class="o">=</span> <span class="n">Pheno</span><span class="p">(</span><span class="n">covfile</span><span class="p">,</span><span class="n">missing</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cov_as_tuple_in</span> <span class="o">=</span> <span class="p">(</span><span class="n">cov</span><span class="o">.</span><span class="n">val</span><span class="p">,</span><span class="n">cov</span><span class="o">.</span><span class="n">iid</span><span class="p">)</span> <span class="c1">#We could do cov directly, but as an example we make it a tuple.</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create five new datasets with consistent iids</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ignore_out</span><span class="p">,</span> <span class="n">kernel_out</span><span class="p">,</span> <span class="n">pheno_out</span><span class="p">,</span> <span class="n">cov_as_tuple_out</span> <span class="o">=</span> <span class="n">intersect_apply</span><span class="p">([</span><span class="n">ignore_in</span><span class="p">,</span> <span class="n">kernel_in</span><span class="p">,</span> <span class="n">pheno_in</span><span class="p">,</span> <span class="n">cov_as_tuple_in</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Print the first five iids from each dataset</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">ignore_out</span><span class="p">,</span> <span class="n">kernel_out</span><span class="o">.</span><span class="n">iid</span><span class="p">[:</span><span class="mi">5</span><span class="p">],</span> <span class="n">pheno_out</span><span class="o">.</span><span class="n">iid</span><span class="p">[:</span><span class="mi">5</span><span class="p">],</span> <span class="n">cov_as_tuple_out</span><span class="p">[</span><span class="mi">1</span><span class="p">][:</span><span class="mi">5</span><span class="p">])</span>
<span class="go">None [[&#39;POP1&#39; &#39;0&#39;]</span>
<span class="go"> [&#39;POP1&#39; &#39;12&#39;]</span>
<span class="go"> [&#39;POP1&#39; &#39;44&#39;]</span>
<span class="go"> [&#39;POP1&#39; &#39;58&#39;]</span>
<span class="go"> [&#39;POP1&#39; &#39;65&#39;]] [[&#39;POP1&#39; &#39;0&#39;]</span>
<span class="go"> [&#39;POP1&#39; &#39;12&#39;]</span>
<span class="go"> [&#39;POP1&#39; &#39;44&#39;]</span>
<span class="go"> [&#39;POP1&#39; &#39;58&#39;]</span>
<span class="go"> [&#39;POP1&#39; &#39;65&#39;]] [[&#39;POP1&#39; &#39;0&#39;]</span>
<span class="go"> [&#39;POP1&#39; &#39;12&#39;]</span>
<span class="go"> [&#39;POP1&#39; &#39;44&#39;]</span>
<span class="go"> [&#39;POP1&#39; &#39;58&#39;]</span>
<span class="go"> [&#39;POP1&#39; &#39;65&#39;]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="pysnptools.util.intersect_ids">
<code class="sig-prename descclassname">pysnptools.util.</code><code class="sig-name descname">intersect_ids</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">idslist</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.intersect_ids" title="Permalink to this definition">¶</a></dt>
<dd><div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version Use: </span><a class="reference internal" href="#pysnptools.util.intersect_apply" title="pysnptools.util.intersect_apply"><code class="xref py py-func docutils literal notranslate"><span class="pre">intersect_apply()</span></code></a> instead.    </p>
</div>
<p>Takes a list of 2d string arrays of family and case ids.
These are intersected.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>indarr, an array of size N x L, where N is the number of
individuals in the intersection, and L is the number of lists in idslist, and which
contains the index to use (in order) such that all people will be identical and in order
across all data sets.</p>
</dd>
</dl>
<p>If one of the lists=None, it is ignored (but still has values reported in indarr, all equal to -1),</p>
</dd></dl>

<dl class="py function">
<dt id="pysnptools.util.log_in_place">
<code class="sig-prename descclassname">pysnptools.util.</code><code class="sig-name descname">log_in_place</code><span class="sig-paren">(</span><em class="sig-param">name</em>, <em class="sig-param">level</em>, <em class="sig-param">time_lambda=&lt;built-in function time&gt;</em>, <em class="sig-param">show_log_diffs=False</em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.log_in_place" title="Permalink to this definition">¶</a></dt>
<dd><p>Create an one-argument function to write messages to. If the logging level
is met, messages will appear. All messages will be on the same line and
will include time.</p>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pysnptools.util</span> <span class="kn">import</span> <span class="n">log_in_place</span>
<span class="kn">from</span> <span class="nn">six.moves</span> <span class="kn">import</span> <span class="nb">range</span>
<span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>

<span class="k">with</span> <span class="n">log_in_place</span><span class="p">(</span><span class="s2">&quot;counting&quot;</span><span class="p">,</span> <span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span> <span class="k">as</span> <span class="n">updater</span><span class="p">:</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">):</span>
        <span class="n">updater</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="o">.</span><span class="mi">1</span><span class="p">)</span> <span class="c1">#typically, some work -- not a delay -- goes here</span>
</pre></div>
</div>
<p>Outputs 100 messages on the same line, ending with something like “counting – time=0:00:09.99, 99”</p>
</dd></dl>

<dl class="py function">
<dt id="pysnptools.util.print2">
<code class="sig-prename descclassname">pysnptools.util.</code><code class="sig-name descname">print2</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">arg</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.print2" title="Permalink to this definition">¶</a></dt>
<dd><p>Make printing under Python3 look the same as under Python2.</p>
</dd></dl>

<dl class="py function">
<dt id="pysnptools.util.sub_matrix">
<code class="sig-prename descclassname">pysnptools.util.</code><code class="sig-name descname">sub_matrix</code><span class="sig-paren">(</span><em class="sig-param">val</em>, <em class="sig-param">row_index_list</em>, <em class="sig-param">col_index_list</em>, <em class="sig-param">order='A'</em>, <em class="sig-param">dtype=&lt;class 'numpy.float64'&gt;</em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.sub_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Efficiently creates a sub-matrix from a 2-D ndarray.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>val</strong> (<em>ndarray</em>) – The ndarray from which to copy.</p></li>
<li><p><strong>row_index_list</strong> (<em>list of integers</em>) – Tells which rows (and in which order) to copy into the sub-matrix</p></li>
<li><p><strong>col_index_list</strong> (<em>list of integers</em>) – Tells which columns (and in which order) to copy into the sub-matrix</p></li>
<li><p><strong>order</strong> (<em>string</em><em> or </em><em>None</em>) – {‘A’ (default), ‘C’, ‘F’}, optional – Specify the order of the sub-matrix to create.
If order is ‘C’, then the returned sub-matrix will be in C-contiguous order (first index varies the fastest).
If order is ‘F’, then the array will be in F-contiguous order (second index varies the fastest).
If order is ‘A’, then sub-matrix may be in any order F or C.</p></li>
<li><p><strong>dtype</strong> (<em>data-type</em>) – {scipy.float64 (default), scipy.float32}, optional – The data-type for sub-matrix created.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>ndarray</p>
</dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">print_function</span> <span class="c1">#Python 2 &amp; 3 compatibility</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pysnptools.util</span> <span class="k">as</span> <span class="nn">pstutil</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="c1"># set seed so that results are deterministic</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span> <span class="c1"># create a 12 x 7 ndarray</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">submatrix</span> <span class="o">=</span> <span class="n">pstutil</span><span class="o">.</span><span class="n">sub_matrix</span><span class="p">(</span><span class="n">matrix</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">11</span><span class="p">],[</span><span class="mi">6</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">submatrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span><span class="nb">int</span><span class="p">(</span><span class="n">submatrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
<span class="go">3 7</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">matrix</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">submatrix</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">])</span> <span class="c1">#The row # 2 is now #1, the column #0 is now #6.</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Note: Behind the scenes, for performance, this function selects and then calls one of 16 C++ helper functions.</p>
</dd></dl>

<dl class="py function">
<dt id="pysnptools.util.weighted_mean">
<code class="sig-prename descclassname">pysnptools.util.</code><code class="sig-name descname">weighted_mean</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ys</span></em>, <em class="sig-param"><span class="n">weights</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.weighted_mean" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ys</strong> (<em>ndarray</em>) – The ndarray of values</p></li>
<li><p><strong>weights</strong> (<em>ndarray</em>) – the weight of each value (unnormalized is fine)</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>the weight mean</p>
</dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ys</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">103.664086</span><span class="p">,</span><span class="mf">89.80645161</span><span class="p">,</span><span class="mf">83.86888046</span><span class="p">,</span><span class="mf">90.54141176</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">2.340862423</span><span class="p">,</span><span class="mf">4.982888433</span><span class="p">,</span><span class="mf">0.17522245</span><span class="p">,</span><span class="mf">0.098562628</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">round</span><span class="p">(</span><span class="n">weighted_mean</span><span class="p">(</span><span class="n">ys</span><span class="p">,</span> <span class="n">weights</span><span class="p">),</span><span class="mi">5</span><span class="p">)</span>
<span class="go">93.9487</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="pysnptools.util.weighted_simple_linear_regression">
<code class="sig-prename descclassname">pysnptools.util.</code><code class="sig-name descname">weighted_simple_linear_regression</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">xs</span></em>, <em class="sig-param"><span class="n">ys</span></em>, <em class="sig-param"><span class="n">weights</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.weighted_simple_linear_regression" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xs</strong> (<em>ndarray</em>) – The ndarray of independent values</p></li>
<li><p><strong>ys</strong> (<em>ndarray</em>) – The ndarray of dependent values</p></li>
<li><p><strong>weights</strong> (<em>ndarray</em>) – the weight of each case (unnormalized is fine)</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>slope, intercept, xmean, ymean</p>
</dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">print_function</span> <span class="c1">#Python 2 &amp; 3 compatibility</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">53.8329911</span><span class="p">,</span><span class="mf">57.49486653</span><span class="p">,</span><span class="mf">60.07392197</span><span class="p">,</span><span class="mf">60.21081451</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ys</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">103.664086</span><span class="p">,</span><span class="mf">89.80645161</span><span class="p">,</span><span class="mf">83.86888046</span><span class="p">,</span><span class="mf">90.54141176</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">2.340862423</span><span class="p">,</span><span class="mf">4.982888433</span><span class="p">,</span><span class="mf">0.17522245</span><span class="p">,</span><span class="mf">0.098562628</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">slope</span><span class="p">,</span> <span class="n">intercept</span><span class="p">,</span> <span class="n">xmean</span><span class="p">,</span> <span class="n">ymean</span> <span class="o">=</span> <span class="n">weighted_simple_linear_regression</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">ys</span><span class="p">,</span> <span class="n">weights</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">slope</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span> <span class="nb">round</span><span class="p">(</span><span class="n">intercept</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span> <span class="nb">round</span><span class="p">(</span><span class="n">xmean</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span> <span class="nb">round</span><span class="p">(</span><span class="n">ymean</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="go">-3.52643 293.05586 56.46133 93.9487</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="pysnptools.util.example_file">
<code class="sig-prename descclassname">pysnptools.util.</code><code class="sig-name descname">example_file</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">pattern</span></em>, <em class="sig-param"><span class="n">endswith</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.example_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the local location of a PySnpTools example file, downloading it
if needed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pattern</strong> – The name of the example file of interest. A 
<a class="reference external" href="https://docs.python.org/3.7/library/fnmatch.html">file name pattern</a>
may be given. All matching files will be downloaded (if needed) and
the name of one will be returned.</p></li>
<li><p><strong>endswith</strong> – The pattern of the file name to return. By default, when
no <cite>endswith</cite> is given, the name of the first matching file will be
returned.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>string</p>
</dd>
</dl>
<p>By default, the local location will be under the system temp directory
(typically controlled with the TEMP environment variable).
Alternatively, the directory can be set with the PYSNPTOOLS_CACHE_HOME
environment variable.</p>
<p>This function knows the MD5 hash of all PySnpTools example files and uses
that content-based hash to decide if a file needs to be downloaded.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.util</span> <span class="k">import</span> <span class="n">example_file</span> <span class="c1"># Download and return local file name</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Download the phenotype file if necessary. Return its local location.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pheno_fn</span> <span class="o">=</span> <span class="n">example_file</span><span class="p">(</span><span class="s2">&quot;pysnptools/examples/toydata.phe&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The local file name is &#39;</span><span class="p">,</span> <span class="n">pheno_fn</span><span class="p">)</span>
<span class="go">The local file name is ...pysnptools/examples/toydata.phe</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Download the bed,bim,&amp;fam files if necessary. Return the location of bed file.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bedfile</span> <span class="o">=</span> <span class="n">example_file</span><span class="p">(</span><span class="s2">&quot;tests/datasets/all_chr.maf0.001.N300.*&quot;</span><span class="p">,</span><span class="s2">&quot;*.bed&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The local file name is &#39;</span><span class="p">,</span> <span class="n">bedfile</span><span class="p">)</span>
<span class="go">The local file name is ...tests/datasets/all_chr.maf0.001.N300.bed</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="pysnptools.util.snp_gen">
<code class="sig-prename descclassname">pysnptools.util.</code><code class="sig-name descname">snp_gen</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fst</span></em>, <em class="sig-param"><span class="n">dfr</span></em>, <em class="sig-param"><span class="n">iid_count</span></em>, <em class="sig-param"><span class="n">sid_count</span></em>, <em class="sig-param"><span class="n">maf_low</span><span class="o">=</span><span class="default_value">0.05</span></em>, <em class="sig-param"><span class="n">maf_high</span><span class="o">=</span><span class="default_value">0.5</span></em>, <em class="sig-param"><span class="n">seed</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">sibs_per_family</span><span class="o">=</span><span class="default_value">10</span></em>, <em class="sig-param"><span class="n">freq_pop_0</span><span class="o">=</span><span class="default_value">0.5</span></em>, <em class="sig-param"><span class="n">chr_count</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">label_with_pop</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.snp_gen" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates a random <a class="reference internal" href="#pysnptools.snpreader.SnpData" title="pysnptools.snpreader.SnpData"><code class="xref py py-class docutils literal notranslate"><span class="pre">SnpData</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fst</strong> (<em>float</em>) – Degree of Population Structure, e.g. 0 (a special case), 0.005, 0.01, 0.05, 0.1</p></li>
<li><p><strong>dfr</strong> (<em>float</em>) – Degree of Family Relatedness, the fraction of individuals belonging to a family, ie. fracSibs, e.g. 0.0, 0.5, 0.6, 0.7, 0.8, 0.9</p></li>
<li><p><strong>iid_count</strong> (<em>int</em>) – The number of individuals to generate. Because of rounding the actual number may be less.</p></li>
<li><p><strong>sid_count</strong> (<em>int</em>) – The number of snps to generate.</p></li>
<li><p><strong>maf_low</strong> (<em>float</em>) – (default .05) lower bound of uniformly-generated Minor allele frequency</p></li>
<li><p><strong>maf_high</strong> (<em>float</em>) – (default .5) upper bound of uniformly-generated Minor allele frequency</p></li>
<li><p><strong>seed</strong> (<em>int</em>) – (default 0) Random seed</p></li>
<li><p><strong>sibs_per_family</strong> (<em>int</em>) – (default 10) number of siblings in each family</p></li>
<li><p><strong>freq_pop_0</strong> (<em>float</em>) – (default .5) Fraction of individuals in population 0 (the rest will be in population 1)</p></li>
<li><p><strong>chr_count</strong> (<em>int</em>) – (default one chromosome per SNP) Number of chromosomes to which SNPs should be assigned. The SNPs will
be assigned as evenly as possible. Chromosome names are integers starting with 1. SNP positions within a chromosome are sequential
integers starting with 1.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="#pysnptools.snpreader.SnpData" title="pysnptools.snpreader.SnpData"><code class="xref py py-class docutils literal notranslate"><span class="pre">SnpData</span></code></a></p>
</dd>
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">print_function</span> <span class="c1">#Python 2 &amp; 3 compatibility</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snpdata</span> <span class="o">=</span> <span class="n">snp_gen</span><span class="p">(</span><span class="n">fst</span><span class="o">=.</span><span class="mi">1</span><span class="p">,</span><span class="n">dfr</span><span class="o">=.</span><span class="mi">5</span><span class="p">,</span><span class="n">iid_count</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span><span class="n">sid_count</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">maf_low</span><span class="o">=.</span><span class="mi">05</span><span class="p">,</span><span class="n">seed</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">snpdata</span><span class="o">.</span><span class="n">iid_count</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">snpdata</span><span class="o">.</span><span class="n">sid_count</span><span class="p">))</span> <span class="c1">#because of rounding got 190 individuals</span>
<span class="go">190 20</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Also See</dt>
<dd class="field-odd"><p><a class="reference internal" href="#pysnptools.snpreader.SnpGen" title="pysnptools.snpreader.SnpGen"><code class="xref py py-class docutils literal notranslate"><span class="pre">snpreader.SnpGen</span></code></a></p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="util-intrangeset">
<h3><code class="xref py py-class docutils literal notranslate"><span class="pre">util.IntRangeSet</span></code><a class="headerlink" href="#util-intrangeset" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt id="pysnptools.util.IntRangeSet">
<em class="property">class </em><code class="sig-prename descclassname">pysnptools.util.</code><code class="sig-name descname">IntRangeSet</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">ranges_inputs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.IntRangeSet" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A class for efficiently manipulating ranges of integers (including negatives and longs) using set operations such as <a class="reference internal" href="#pysnptools.util.IntRangeSet.union" title="pysnptools.util.IntRangeSet.union"><code class="xref py py-meth docutils literal notranslate"><span class="pre">union()</span></code></a>, <a class="reference internal" href="#pysnptools.util.IntRangeSet.intersection" title="pysnptools.util.IntRangeSet.intersection"><code class="xref py py-meth docutils literal notranslate"><span class="pre">intersection()</span></code></a>, and difference.</p>
<p>The class differs from the built-in <em>set</em> class (and from Boolean numpy arrays) because it does not need to store every element in the set, only for every contiguous range of elements.
It differs from other Python interval libraries (that we know of) by being specialized and optimized for integer elements.</p>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<p>Here we take the union (operator “|”) of two IntRangeSets:</p>
<img alt="_images/example1.png" src="_images/example1.png" />
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">print_function</span> <span class="c1">#Python 2 &amp; 3 compatibility</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="s2">&quot;100:500,501:1000&quot;</span><span class="p">)</span> <span class="c1"># a is the set of integers from 100 to 500 (exclusive) and 501 to 1000 (exclusive)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="s2">&quot;-20,400:600&quot;</span><span class="p">)</span>      <span class="c1"># b is the set of integers -20 and the range 400 to 600 (exclusive)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">a</span> <span class="o">|</span> <span class="n">b</span>                           <span class="c1"># c is the union of a and b, namely -20 and 100 to 1000 (exclusive)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
<span class="go">IntRangeSet(&#39;-20,100:1000&#39;)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<p>Suppose we want to find the intron regions of a gene but we are given only the transcription region and the exon regions.</p>
<img alt="_images/example2.png" src="_images/example2.png" />
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.util</span> <span class="k">import</span> <span class="n">IntRangeSet</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">line</span> <span class="o">=</span> <span class="s2">&quot;chr15   29370   37380   29370,32358,36715   30817,32561,37380&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">chr</span><span class="p">,</span><span class="n">trans_start</span><span class="p">,</span><span class="n">trans_last</span><span class="p">,</span><span class="n">exon_starts</span><span class="p">,</span><span class="n">exon_lasts</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span> <span class="c1"># split the line on white space</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">trans_start</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">trans_start</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">trans_stop</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">trans_last</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span> <span class="c1"># add one to convert the inclusive &quot;last&quot; value into a Pythonesque exclusive &quot;stop&quot; value</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">int_range_set</span> <span class="o">=</span> <span class="n">IntRangeSet</span><span class="p">((</span><span class="n">trans_start</span><span class="p">,</span><span class="n">trans_stop</span><span class="p">))</span> <span class="c1"># creates a IntRangeSet from 29370 (inclusive) to 37381 (exclusive)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">int_range_set</span><span class="p">)</span> <span class="c1"># print at any time to see the current value</span>
<span class="go">IntRangeSet(&#39;29370:37381&#39;)</span>
</pre></div>
</div>
<p>Parse the exon start and last lists from strings to lists of integers (converting ‘last’ to ‘stop’)</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">exon_starts</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">start</span><span class="p">)</span> <span class="k">for</span> <span class="n">start</span> <span class="ow">in</span> <span class="n">exon_starts</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">exon_stops</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">last</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span> <span class="k">for</span> <span class="n">last</span> <span class="ow">in</span> <span class="n">exon_lasts</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">exon_starts</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">exon_stops</span><span class="p">)</span>
</pre></div>
</div>
<p>Zip together the two lists to create an iterable of exon_start,exon_stop tuples. Then
‘set subtract’ all these ranges from int_range_set</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">absolute_import</span> <span class="c1">#Python 2 &amp; 3 compatibility</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">six.moves</span> <span class="k">import</span> <span class="nb">range</span> <span class="c1">#Python 2 &amp; 3 compatibility</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">int_range_set</span> <span class="o">-=</span> <span class="nb">zip</span><span class="p">(</span><span class="n">exon_starts</span><span class="p">,</span><span class="n">exon_stops</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">int_range_set</span><span class="p">)</span> <span class="c1"># See what it looks like</span>
<span class="go">IntRangeSet(&#39;30818:32358,32562:36715&#39;)</span>
</pre></div>
</div>
<p>Create the desired output by iterating through each contiguous range of integers</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">start</span><span class="p">,</span> <span class="n">stop</span> <span class="ow">in</span> <span class="n">int_range_set</span><span class="o">.</span><span class="n">ranges</span><span class="p">():</span>
<span class="gp">... </span>   <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{0}</span><span class="s2">   </span><span class="si">{1}</span><span class="s2">     </span><span class="si">{2}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">chr</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
<span class="go">chr15   30818     32357</span>
<span class="go">chr15   32562     36714</span>
</pre></div>
</div>
<p><strong>Ranges Input</strong></p>
<p>The input to the <a class="reference internal" href="#pysnptools.util.IntRangeSet" title="pysnptools.util.IntRangeSet"><code class="xref py py-class docutils literal notranslate"><span class="pre">IntRangeSet</span></code></a> constructor and many of its methods is a <em>ranges input</em>.</p>
<p>A <em>ranges input</em> is one of the following:</p>
<blockquote>
<div><ul class="simple">
<li><p>A comma-separated string of integers or integer ranges, e.g., <code class="docutils literal notranslate"><span class="pre">'100:500,500:1000,2000'</span></code></p></li>
<li><p>An integer or integer expression, e.g., <code class="docutils literal notranslate"><span class="pre">3</span></code></p></li>
<li><p>A tuple of two integers, <em>start</em> and <em>stop</em>, e.g., <code class="docutils literal notranslate"><span class="pre">(2,8)</span></code>. <em>stop</em> is exclusive.</p></li>
<li><p>A slice with non-negative values, e.g. <code class="docutils literal notranslate"><span class="pre">slice(2,8)</span></code></p></li>
<li><p>A <a class="reference internal" href="#pysnptools.util.IntRangeSet" title="pysnptools.util.IntRangeSet"><code class="xref py py-class docutils literal notranslate"><span class="pre">IntRangeSet</span></code></a> (or any class with a <a class="reference internal" href="#pysnptools.util.IntRangeSet.ranges" title="pysnptools.util.IntRangeSet.ranges"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ranges()</span></code></a> method), e.g., <code class="docutils literal notranslate"><span class="pre">IntRangeSet(3)</span></code></p></li>
<li><p>A list or iterable (but not tuple) of <em>ranges inputs</em>, e.g., <code class="docutils literal notranslate"><span class="pre">[1,6,7,(100,200)]</span></code></p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<p>Strings:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="s2">&quot;100:500,500:1000,2000&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;-10:-8,1,2,3:11&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>The ranges in an <em>ranges input</em> can overlap and can be in any order.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="s2">&quot;2000,100:1500,500:1000,2000&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;100:1500,2000&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Integers and Integer Expressions:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="mi">151000000000</span><span class="p">)</span> <span class="c1"># longs are OK</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="mi">3</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># integer expressions are OK</span>
</pre></div>
</div>
<p>A tuple must have exactly two integers. They represent the <em>start</em> (inclusive) and <em>stop</em> (exclusive) integers in a range.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">IntRangeSet</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span> <span class="o">==</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;2:8&#39;</span><span class="p">)</span> <span class="c1"># check &#39;set equality&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="mi">7</span> <span class="ow">in</span> <span class="n">IntRangeSet</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span> <span class="c1"># The integer 7 is an element of the set</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">IntRangeSet</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span> <span class="o">==</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<p>Lists and iterables of <em>ranges inputs</em>:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">IntRangeSet</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,(</span><span class="mi">100</span><span class="p">,</span><span class="mi">200</span><span class="p">)])</span> <span class="o">==</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;1,6:8,100:200&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">100</span><span class="p">))</span> <span class="o">==</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;0:100&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">IntRangeSet</span><span class="p">([</span><span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="mi">200</span><span class="p">),</span><span class="mi">3</span><span class="p">,</span><span class="s1">&#39;1000:2000&#39;</span><span class="p">,[</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">],(</span><span class="mi">20</span><span class="p">,</span><span class="mi">30</span><span class="p">)])</span> <span class="o">==</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;3:5,6,20:30,100:200,1000:2000&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Some methods accept zero or more <em>ranges input</em> as their input. This is called a <em>*ranges_inputs</em>. For example:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">IntRangeSet</span><span class="p">()</span> <span class="c1"># zero ranges inputs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="c1"># one ranges input</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;3:11,5&#39;</span><span class="p">,</span><span class="mi">14</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span> <span class="c1"># Three ranges inputs, a string and two integers.</span>
</pre></div>
</div>
</div></blockquote>
<p><strong>Most Important Methods and Operators</strong></p>
<table class="docutils align-default">
<colgroup>
<col style="width: 38%" />
<col style="width: 38%" />
<col style="width: 24%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><em>Description</em></p></td>
<td><p><em>Method or Operator</em></p></td>
<td><p><em>For Details</em></p></td>
</tr>
<tr class="row-even"><td><p>is a ‘set equal’ to b?</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">==</span> <span class="pre">b</span></code></p></td>
<td><p><a class="reference internal" href="#pysnptools.util.IntRangeSet.__eq__" title="pysnptools.util.IntRangeSet.__eq__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">__eq__()</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p>is a is superset of b?</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">b</span> <span class="pre">in</span> <span class="pre">a</span></code>,
<code class="docutils literal notranslate"><span class="pre">a.issuperset(b)</span></code>,
<code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">&gt;=</span> <span class="pre">b</span></code></p></td>
<td><p><a class="reference internal" href="#pysnptools.util.IntRangeSet.__contains__" title="pysnptools.util.IntRangeSet.__contains__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">__contains__()</span></code></a></p></td>
</tr>
<tr class="row-even"><td><p>is a is subset of b?</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">&lt;=</span> <span class="pre">b</span></code>,
<code class="docutils literal notranslate"><span class="pre">a.issubset(b)</span></code></p></td>
<td><p><a class="reference internal" href="#pysnptools.util.IntRangeSet.__le__" title="pysnptools.util.IntRangeSet.__le__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">__le__()</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p>remove <em>i</em> th smallest element(s)</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">del</span> <span class="pre">a[i]</span></code></p></td>
<td><p><a class="reference internal" href="#pysnptools.util.IntRangeSet.__delitem__" title="pysnptools.util.IntRangeSet.__delitem__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">__delitem__()</span></code></a></p></td>
</tr>
<tr class="row-even"><td><p>get <em>i</em> th smallest element(s)</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">a[i]</span></code></p></td>
<td><p><a class="reference internal" href="#pysnptools.util.IntRangeSet.__getitem__" title="pysnptools.util.IntRangeSet.__getitem__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">__getitem__()</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p>is a not ‘set equal’ to b?</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">!=</span> <span class="pre">b</span></code></p></td>
<td><p><a class="reference internal" href="#pysnptools.util.IntRangeSet.__ne__" title="pysnptools.util.IntRangeSet.__ne__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">__ne__()</span></code></a></p></td>
</tr>
<tr class="row-even"><td><p>is a is proper superset of b?</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">&gt;</span> <span class="pre">b</span></code></p></td>
<td><p><a class="reference internal" href="#pysnptools.util.IntRangeSet.__gt__" title="pysnptools.util.IntRangeSet.__gt__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">__gt__()</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p>is a is proper subset of b?</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">&lt;</span> <span class="pre">b</span></code></p></td>
<td><p><a class="reference internal" href="#pysnptools.util.IntRangeSet.__lt__" title="pysnptools.util.IntRangeSet.__lt__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">__lt__()</span></code></a></p></td>
</tr>
<tr class="row-even"><td><p>union b into a</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">|=</span> <span class="pre">b</span></code>,
<code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">+=</span> <span class="pre">b</span></code>,
<code class="docutils literal notranslate"><span class="pre">a.add(b,c)</span></code>,
<code class="docutils literal notranslate"><span class="pre">a.update(b,c)</span></code></p></td>
<td><p><a class="reference internal" href="#pysnptools.util.IntRangeSet.add" title="pysnptools.util.IntRangeSet.add"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add()</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p>union a and b</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">|</span> <span class="pre">b</span></code>,
<code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">b</span></code>,
<code class="docutils literal notranslate"><span class="pre">a.union(b,c)</span></code></p></td>
<td><p><a class="reference internal" href="#pysnptools.util.IntRangeSet.__or__" title="pysnptools.util.IntRangeSet.__or__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">__or__()</span></code></a></p></td>
</tr>
<tr class="row-even"><td><p>intersect b into a</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">&amp;=</span> <span class="pre">b</span></code>,
<code class="docutils literal notranslate"><span class="pre">a.intersection_update(b,c)</span></code>,</p></td>
<td><p><a class="reference internal" href="#pysnptools.util.IntRangeSet.__iand__" title="pysnptools.util.IntRangeSet.__iand__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">__iand__()</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p>intersect a and b</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">&amp;</span> <span class="pre">b</span></code>,
<code class="docutils literal notranslate"><span class="pre">a.intersection(b,c)</span></code></p></td>
<td><p><a class="reference internal" href="#pysnptools.util.IntRangeSet.intersection" title="pysnptools.util.IntRangeSet.intersection"><code class="xref py py-meth docutils literal notranslate"><span class="pre">intersection()</span></code></a></p></td>
</tr>
<tr class="row-even"><td><p>subtract b from in a</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">-=</span> <span class="pre">b</span></code>,
<code class="docutils literal notranslate"><span class="pre">a.difference_update(b)</span></code>,
<code class="docutils literal notranslate"><span class="pre">a.discard(b)</span></code>,</p></td>
<td><p><a class="reference internal" href="#pysnptools.util.IntRangeSet.__isub__" title="pysnptools.util.IntRangeSet.__isub__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">__isub__()</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p>remove b from a, error if missing</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">a.remove(b)</span></code></p></td>
<td><p><a class="reference internal" href="#pysnptools.util.IntRangeSet.remove" title="pysnptools.util.IntRangeSet.remove"><code class="xref py py-meth docutils literal notranslate"><span class="pre">remove()</span></code></a></p></td>
</tr>
<tr class="row-even"><td><p>a ‘set difference’ b</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">-</span> <span class="pre">b</span></code>,
<code class="docutils literal notranslate"><span class="pre">a.difference(b)</span></code></p></td>
<td><p><a class="reference internal" href="#pysnptools.util.IntRangeSet.__sub__" title="pysnptools.util.IntRangeSet.__sub__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">__sub__()</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p>iterate integers in a, from low</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">for</span> <span class="pre">element</span> <span class="pre">in</span> <span class="pre">a:</span></code></p></td>
<td><p><a class="reference internal" href="#pysnptools.util.IntRangeSet.__iter__" title="pysnptools.util.IntRangeSet.__iter__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">__iter__()</span></code></a></p></td>
</tr>
<tr class="row-even"><td><p>iterate integers in a, from high</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">for</span> <span class="pre">element</span> <span class="pre">in</span> <span class="pre">reverse(a):</span></code></p></td>
<td><p><a class="reference internal" href="#pysnptools.util.IntRangeSet.__reversed__" title="pysnptools.util.IntRangeSet.__reversed__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">__reversed__()</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p>symmetric difference into a</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">^=</span> <span class="pre">b</span></code></p></td>
<td><p><a class="reference internal" href="#pysnptools.util.IntRangeSet.__ixor__" title="pysnptools.util.IntRangeSet.__ixor__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">__ixor__()</span></code></a></p></td>
</tr>
<tr class="row-even"><td><p>a ‘symmetric difference’ b</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">^</span> <span class="pre">b</span></code></p></td>
<td><p><a class="reference internal" href="#pysnptools.util.IntRangeSet.__xor__" title="pysnptools.util.IntRangeSet.__xor__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">__xor__()</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p>count of integer elements in a</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">len(a)</span></code></p></td>
<td><p><a class="reference internal" href="#pysnptools.util.IntRangeSet.__len__" title="pysnptools.util.IntRangeSet.__len__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">__len__()</span></code></a></p></td>
</tr>
<tr class="row-even"><td><p>iterate ranges in a, from low</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">for</span> <span class="pre">start,stop</span> <span class="pre">in</span> <span class="pre">a.ranges():</span></code></p></td>
<td><p><a class="reference internal" href="#pysnptools.util.IntRangeSet.ranges" title="pysnptools.util.IntRangeSet.ranges"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ranges()</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p>count of ranges in a</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">a.ranges_len</span></code></p></td>
<td><p><a class="reference internal" href="#pysnptools.util.IntRangeSet.ranges_len" title="pysnptools.util.IntRangeSet.ranges_len"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ranges_len()</span></code></a></p></td>
</tr>
<tr class="row-even"><td><p>index of range containing b</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">a.ranges_index(b)</span></code></p></td>
<td><p><a class="reference internal" href="#pysnptools.util.IntRangeSet.ranges_index" title="pysnptools.util.IntRangeSet.ranges_index"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ranges_index()</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p>get <em>i</em> th smallest range</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">a.ranges_getitem(i)</span></code></p></td>
<td><p><a class="reference internal" href="#pysnptools.util.IntRangeSet.ranges_getitem" title="pysnptools.util.IntRangeSet.ranges_getitem"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ranges_getitem()</span></code></a></p></td>
</tr>
<tr class="row-even"><td><p>a as a string</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">str(a)</span></code></p></td>
<td><p><a class="reference internal" href="#pysnptools.util.IntRangeSet.__str__" title="pysnptools.util.IntRangeSet.__str__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">__str__()</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p>remove all elements from a</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">a.clear()</span></code></p></td>
<td><p><a class="reference internal" href="#pysnptools.util.IntRangeSet.clear" title="pysnptools.util.IntRangeSet.clear"><code class="xref py py-meth docutils literal notranslate"><span class="pre">clear()</span></code></a></p></td>
</tr>
<tr class="row-even"><td><p>copy a</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">a.copy()</span></code></p></td>
<td><p><a class="reference internal" href="#pysnptools.util.IntRangeSet.copy" title="pysnptools.util.IntRangeSet.copy"><code class="xref py py-meth docutils literal notranslate"><span class="pre">copy()</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p>find index of b in a</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">a.index(b)</span></code></p></td>
<td><p><a class="reference internal" href="#pysnptools.util.IntRangeSet.index" title="pysnptools.util.IntRangeSet.index"><code class="xref py py-meth docutils literal notranslate"><span class="pre">index()</span></code></a></p></td>
</tr>
<tr class="row-even"><td><p>are a and b disjoint?</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">a.isdisjoint(b)</span></code></p></td>
<td><p><a class="reference internal" href="#pysnptools.util.IntRangeSet.isdisjoint" title="pysnptools.util.IntRangeSet.isdisjoint"><code class="xref py py-meth docutils literal notranslate"><span class="pre">isdisjoint()</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p>is a empty?</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">a.isempty(b)</span></code></p></td>
<td><p><a class="reference internal" href="#pysnptools.util.IntRangeSet.isempty" title="pysnptools.util.IntRangeSet.isempty"><code class="xref py py-meth docutils literal notranslate"><span class="pre">isempty()</span></code></a></p></td>
</tr>
<tr class="row-even"><td><p>smallest element of a</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">a.min()</span></code></p></td>
<td><p><a class="reference internal" href="#pysnptools.util.IntRangeSet.min" title="pysnptools.util.IntRangeSet.min"><code class="xref py py-meth docutils literal notranslate"><span class="pre">min()</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p>largest element of a</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">a.max()</span></code></p></td>
<td><p><a class="reference internal" href="#pysnptools.util.IntRangeSet.max" title="pysnptools.util.IntRangeSet.max"><code class="xref py py-meth docutils literal notranslate"><span class="pre">max()</span></code></a></p></td>
</tr>
<tr class="row-even"><td><p>sum of elements in a</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">a.sum()</span></code></p></td>
<td><p><a class="reference internal" href="#pysnptools.util.IntRangeSet.sum" title="pysnptools.util.IntRangeSet.sum"><code class="xref py py-meth docutils literal notranslate"><span class="pre">sum()</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p>remove and return an element</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">a.pop()</span></code></p></td>
<td><p><a class="reference internal" href="#pysnptools.util.IntRangeSet.pop" title="pysnptools.util.IntRangeSet.pop"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pop()</span></code></a></p></td>
</tr>
</tbody>
</table>
<p><strong>Examples, Tips, and Warnings</strong></p>
<p>The argument to a method and the right-hand side of an operator can be a <em>ranges input</em> rather than <a class="reference internal" href="#pysnptools.util.IntRangeSet" title="pysnptools.util.IntRangeSet"><code class="xref py py-class docutils literal notranslate"><span class="pre">IntRangeSet</span></code></a>. For example,</p>
<blockquote>
<div><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">big</span> <span class="o">=</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;-1000:2000&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">big</span> <span class="o">-</span> <span class="s1">&#39;10:20,500&#39;</span><span class="p">)</span> <span class="c1"># We can subtract this string because it is a legal ranges input.</span>
<span class="go">IntRangeSet(&#39;-1000:10,20:500,501:2000&#39;)</span>
</pre></div>
</div>
<p>This even works for equality testing:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">big</span> <span class="o">-</span> <span class="s1">&#39;10:21,500&#39;</span> <span class="o">==</span> <span class="s1">&#39;-1000:10,21:500,501:2000&#39;</span>
</pre></div>
</div>
<p>The Python <em>in</em> operator is backwards from other operators, so the left-hand side can be any <em>ranges input</em>.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="mi">501</span> <span class="ow">in</span> <span class="n">big</span>
</pre></div>
</div>
</div></blockquote>
<p>Like most other Python libraries you specify a range with an inclusive <em>start</em> integer and an exclusive <em>stop</em>.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="mi">7</span> <span class="ow">in</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;4:8&#39;</span><span class="p">))</span> <span class="c1"># includes 7</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="mi">8</span> <span class="ow">in</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;4:8&#39;</span><span class="p">))</span> <span class="c1"># excludes 8</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="mi">8</span> <span class="ow">in</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">7</span><span class="p">)))</span> <span class="c1"># also excludes 8</span>
<span class="go">False</span>
</pre></div>
</div>
<dl>
<dt>Be careful with the <em>ranges inputs</em> specified with tuples. Suppose we want a <a class="reference internal" href="#pysnptools.util.IntRangeSet" title="pysnptools.util.IntRangeSet"><code class="xref py py-class docutils literal notranslate"><span class="pre">IntRangeSet</span></code></a> containing 4,5,6,7.</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">IntRangeSet</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span> <span class="o">==</span> <span class="s1">&#39;4:8&#39;</span> <span class="c1">#OK</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">IntRangeSet</span><span class="p">([(</span><span class="mi">4</span><span class="p">,</span><span class="mi">8</span><span class="p">)])</span> <span class="o">==</span> <span class="s1">&#39;4:8&#39;</span> <span class="c1"># List of a tuple is OK</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;4,8&#39;</span> <span class="c1">#No. This is not a tuple. It is two integer inputs, so we get only 4 and 8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">IntRangeSet</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span><span class="mi">8</span><span class="p">])</span> <span class="o">==</span> <span class="s1">&#39;4,8&#39;</span> <span class="c1">#No. List of two integers, so get only 4 and 8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#Illegal: IntRangeSet((4,8,10)) # tuples must be pairs</span>
</pre></div>
</div>
</dd>
</dl>
<p><strong>Methods and Operators</strong></p>
<dl class="py method">
<dt id="pysnptools.util.IntRangeSet.__contains__">
<code class="sig-name descname">__contains__</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">ranges_inputs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.IntRangeSet.__contains__" title="Permalink to this definition">¶</a></dt>
<dd><p>True exactly when all the ranges input is a subset of the IntRangeSet.</p>
<p>These are the same:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">b</span> <span class="pre">in</span> <span class="pre">a</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">a.issuperset(b)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">&gt;=</span> <span class="pre">b</span></code></p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="mi">3</span> <span class="ow">in</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;0:5,6:11&#39;</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;4:7&#39;</span><span class="p">)</span> <span class="ow">in</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;0:5,6:11&#39;</span><span class="p">))</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="s1">&#39;6:9&#39;</span> <span class="ow">in</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;0:5,6:11&#39;</span><span class="p">)</span> <span class="c1"># The left-hand of &#39;in&#39; can be any ranges input</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;0:5,6:11&#39;</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="s1">&#39;6:9&#39;</span><span class="p">)</span> <span class="c1"># The right-hand of can be any ranges input</span>
<span class="go">True</span>
</pre></div>
</div>
<p>The ‘issuperset’ method also supports unioning multiple ranges inputs.</p>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;0:5,6:11&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">issuperset</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;0:5,6:11&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">issuperset</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">100</span><span class="p">))</span>
<span class="go">False</span>
</pre></div>
</div>
<p>Note: By definition, any set is a superset of itself.</p>
</dd></dl>

<dl class="py method">
<dt id="pysnptools.util.IntRangeSet.__delitem__">
<code class="sig-name descname">__delitem__</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">key</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.IntRangeSet.__delitem__" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove elements from the IntRangeSet by position index. Position index can be specified by an integer with
negative integers counting from the end. Position indexes can also be specified with slices and a ranges input.</p>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<p>Removing with an integer position index:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;100:200,1000&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">del</span> <span class="n">a</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="go">IntRangeSet(&#39;100:102,103:200,1000&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">del</span> <span class="n">a</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="go">IntRangeSet(&#39;100:102,103:200&#39;)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<p>Removing with a slice:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;100:200,1000&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">del</span> <span class="n">a</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="mi">11</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="go">IntRangeSet(&#39;100:102,111:200,1000&#39;)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<p>Removing with a ranges input:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;100:200,1000&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">del</span> <span class="n">a</span><span class="p">[</span><span class="s1">&#39;2:11&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="go">IntRangeSet(&#39;100:102,111:200,1000&#39;)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="pysnptools.util.IntRangeSet.__eq__">
<code class="sig-name descname">__eq__</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">other</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.IntRangeSet.__eq__" title="Permalink to this definition">¶</a></dt>
<dd><p>True exactly when the IntRangeSet on the left is <em>set equivalent</em> to the ranges input on the right.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">==</span> <span class="pre">b</span></code></p></li>
</ul>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;0:10,12&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;0:10,12&#39;</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;0:10,12&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;0:10&#39;</span><span class="p">))</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;0:10,12&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;12,0:5,5:10&#39;</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;0:10,12&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;0:10,12&#39;</span><span class="p">)</span> <span class="c1"># The right-hand can be any ranges input</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="pysnptools.util.IntRangeSet.__ge__">
<code class="sig-name descname">__ge__</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">other</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.IntRangeSet.__ge__" title="Permalink to this definition">¶</a></dt>
<dd><p>See <a class="reference internal" href="#pysnptools.util.IntRangeSet.__contains__" title="pysnptools.util.IntRangeSet.__contains__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">IntRangeSet.__contains__()</span></code></a></p>
</dd></dl>

<dl class="py method">
<dt id="pysnptools.util.IntRangeSet.__getitem__">
<code class="sig-name descname">__getitem__</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">key</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.IntRangeSet.__getitem__" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="docutils literal notranslate"><span class="pre">a[i]</span></code> returns the ith integer in sorted order (origin 0) from a, an IntRangeSet</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;100:200,1000&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
<span class="go">100</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;100:200,1000&#39;</span><span class="p">)[</span><span class="mi">10</span><span class="p">])</span>
<span class="go">110</span>
</pre></div>
</div>
<p>If i is negative, the indexing goes from the end</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;100:200,1000&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="go">1000</span>
</pre></div>
</div>
<p>Python’s standard slice notation may be used and returns IntRangeSets.
(Remember that the Stop number in slice notation is exclusive.)</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;100:200,1000&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="mi">10</span><span class="p">])</span> <span class="c1"># Integers 0 (inclusive) to 10 (exclusive)</span>
<span class="go">IntRangeSet(&#39;100:110&#39;)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;100:200,1000&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="mi">10</span><span class="p">:</span><span class="mi">2</span><span class="p">])</span> <span class="c1"># Integers 0 (inclusive) to 10 (exclusive) with step 2</span>
<span class="go">IntRangeSet(&#39;100,102,104,106,108&#39;)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;100:200,1000&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">3</span><span class="p">:])</span> <span class="c1"># The last three integers in the IntRangeSet.</span>
<span class="go">IntRangeSet(&#39;198:200,1000&#39;)</span>
</pre></div>
</div>
<p>An IntRangeSet can also be accessed with any ranges input.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;100:200,1000&#39;</span><span class="p">)[</span><span class="s1">&#39;0:10,20&#39;</span><span class="p">]</span>
<span class="go">IntRangeSet(&#39;100:110,120&#39;)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="pysnptools.util.IntRangeSet.__gt__">
<code class="sig-name descname">__gt__</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">other</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.IntRangeSet.__gt__" title="Permalink to this definition">¶</a></dt>
<dd><p>True exactly when the IntRangeSet is a proper superset of the ranges.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">&gt;</span> <span class="pre">b</span></code></p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;0:5,6:11&#39;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="s1">&#39;7:10&#39;</span><span class="p">)</span> <span class="c1"># The right-hand can be any ranges input</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Note: By definition, no set is a proper superset of itself.</p>
</dd></dl>

<dl class="py attribute">
<dt id="pysnptools.util.IntRangeSet.__hash__">
<code class="sig-name descname">__hash__</code><em class="property"> = None</em><a class="headerlink" href="#pysnptools.util.IntRangeSet.__hash__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pysnptools.util.IntRangeSet.__iadd__">
<code class="sig-name descname">__iadd__</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">ranges_inputs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.IntRangeSet.__iadd__" title="Permalink to this definition">¶</a></dt>
<dd><p>See <a class="reference internal" href="#pysnptools.util.IntRangeSet.add" title="pysnptools.util.IntRangeSet.add"><code class="xref py py-meth docutils literal notranslate"><span class="pre">IntRangeSet.add()</span></code></a></p>
</dd></dl>

<dl class="py method">
<dt id="pysnptools.util.IntRangeSet.__iand__">
<code class="sig-name descname">__iand__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.IntRangeSet.__iand__" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the IntRangeSet to itself intersected with a input range</p>
<p>These are the same:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">&amp;=</span> <span class="pre">b</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">a.intersection_update(b)</span></code></p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;0:5,6:11&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">&amp;=</span> <span class="s1">&#39;3:8&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="go">IntRangeSet(&#39;3:5,6:8&#39;)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="pysnptools.util.IntRangeSet.__imul__">
<code class="sig-name descname">__imul__</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">n</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.IntRangeSet.__imul__" title="Permalink to this definition">¶</a></dt>
<dd><p>Put produces n copies of a unioned together in a, where a is an IntRangeSet.
Because a is a set, the result will either be an empty IntRangeSet (n is 0 or less) or the original a.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">*=</span> <span class="pre">n</span></code></p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;0:5,6:11&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">*=</span> <span class="mi">5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="c1"># should be unchanged</span>
<span class="go">IntRangeSet(&#39;0:5,6:11&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">*=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="c1"># should be empty</span>
<span class="go">IntRangeSet(&#39;&#39;)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="pysnptools.util.IntRangeSet.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">ranges_inputs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.IntRangeSet.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a <a class="reference internal" href="#pysnptools.util.IntRangeSet" title="pysnptools.util.IntRangeSet"><code class="xref py py-class docutils literal notranslate"><span class="pre">IntRangeSet</span></code></a>.</p>
</dd></dl>

<dl class="py method">
<dt id="pysnptools.util.IntRangeSet.__ior__">
<code class="sig-name descname">__ior__</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">ranges_inputs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.IntRangeSet.__ior__" title="Permalink to this definition">¶</a></dt>
<dd><p>See <a class="reference internal" href="#pysnptools.util.IntRangeSet.add" title="pysnptools.util.IntRangeSet.add"><code class="xref py py-meth docutils literal notranslate"><span class="pre">IntRangeSet.add()</span></code></a></p>
</dd></dl>

<dl class="py method">
<dt id="pysnptools.util.IntRangeSet.__isub__">
<code class="sig-name descname">__isub__</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">ranges_inputs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.IntRangeSet.__isub__" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove the elements of the range inputs from the IntRangeSet</p>
<p>These are the same:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">-=</span> <span class="pre">b</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">a.difference_update(b)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">a.discard(b)</span></code></p></li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">remove</span></code> is almost the same except that it raises a KeyError if any element of b is not in a.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">a.remove(b)</span></code></p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;0:5,6:11&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">-=</span> <span class="s1">&#39;3:7&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="go">IntRangeSet(&#39;0:3,7:11&#39;)</span>
</pre></div>
</div>
<p>The ‘difference_update’, ‘discard’ and ‘remove’ methods also support subtracting multiple ranges inputs.</p>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;0:5,6:11&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">difference_update</span><span class="p">(</span><span class="s1">&#39;3:7&#39;</span><span class="p">,</span><span class="s1">&#39;8:100&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="go">IntRangeSet(&#39;0:3,7&#39;)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="pysnptools.util.IntRangeSet.__iter__">
<code class="sig-name descname">__iter__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.IntRangeSet.__iter__" title="Permalink to this definition">¶</a></dt>
<dd><p>Iterate, in order from smallest to largest, the integer elements of the IntRangeSet</p>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;1:4,10&#39;</span><span class="p">):</span>
<span class="gp">... </span>   <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="go">1</span>
<span class="go">2</span>
<span class="go">3</span>
<span class="go">10</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="pysnptools.util.IntRangeSet.__ixor__">
<code class="sig-name descname">__ixor__</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ranges</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.IntRangeSet.__ixor__" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the IntRangeSet to contains exactly those elements that appear in either itself or the input ranges but not both</p>
<p>These are the same:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">^=</span> <span class="pre">b</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">a.symmetric_difference_update(b)</span></code></p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;0:5,6:11&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">^=</span> <span class="s1">&#39;3:8&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="go">IntRangeSet(&#39;0:3,5,8:11&#39;)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="pysnptools.util.IntRangeSet.__le__">
<code class="sig-name descname">__le__</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ranges</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.IntRangeSet.__le__" title="Permalink to this definition">¶</a></dt>
<dd><p>True exactly when the IntRangeSet is a subset of the ranges.</p>
<p>These are the same:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">&lt;=</span> <span class="pre">b</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">a.issubset(b)</span></code></p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;0:5,6:11&#39;</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="s1">&#39;-1:101&#39;</span><span class="p">)</span> <span class="c1"># The right-hand can be any ranges input</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Note: By definition, any set is a subset of itself.</p>
</dd></dl>

<dl class="py method">
<dt id="pysnptools.util.IntRangeSet.__len__">
<code class="sig-name descname">__len__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.IntRangeSet.__len__" title="Permalink to this definition">¶</a></dt>
<dd><p>The number of integer elements in the IntRangeSet</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;0:10,12&#39;</span><span class="p">)))</span>
<span class="go">11</span>
</pre></div>
</div>
<p>Note: This is computed in time linear in the number of ranges, rather than integer elements.</p>
</dd></dl>

<dl class="py method">
<dt id="pysnptools.util.IntRangeSet.__lt__">
<code class="sig-name descname">__lt__</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ranges</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.IntRangeSet.__lt__" title="Permalink to this definition">¶</a></dt>
<dd><p>True exactly when the IntRangeSet is a proper subset of the ranges.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">&lt;</span> <span class="pre">b</span></code></p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;0:5,6:11&#39;</span><span class="p">)</span> <span class="o">&lt;</span> <span class="s1">&#39;-1:101&#39;</span><span class="p">)</span> <span class="c1"># The right-hand can be any ranges input</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Note: By definition, no set is a proper subset of itself.</p>
</dd></dl>

<dl class="py method">
<dt id="pysnptools.util.IntRangeSet.__mul__">
<code class="sig-name descname">__mul__</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">n</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.IntRangeSet.__mul__" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">*</span> <span class="pre">n</span></code>, produces n shallow copies of a unioned, where a is an IntRangeSet.
Because a is a set, the result will either be an empty IntRangeSet (n is 0 or less) or a copy of
the original IntRangeSet.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">*</span> <span class="pre">n</span></code></p></li>
</ul>
</dd></dl>

<dl class="py method">
<dt id="pysnptools.util.IntRangeSet.__ne__">
<code class="sig-name descname">__ne__</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">other</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.IntRangeSet.__ne__" title="Permalink to this definition">¶</a></dt>
<dd><p><em>False</em> exactly when the IntRangeSet on the left is <em>set equivalent</em> to the ranges input on the right.</p>
<p>These are the same.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">!=</span> <span class="pre">b</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">not</span> <span class="pre">a</span> <span class="pre">==</span> <span class="pre">b</span></code></p></li>
</ul>
</dd></dl>

<dl class="py method">
<dt id="pysnptools.util.IntRangeSet.__or__">
<code class="sig-name descname">__or__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.IntRangeSet.__or__" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the union of a IntRangeSet with zero or more ranges inputs. The original IntRangeSet is not changed.</p>
<p>These are the same:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">|</span> <span class="pre">b</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">+</span> <span class="pre">b</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">a.union(b)</span></code></p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;0:5,6:10&#39;</span><span class="p">)</span> <span class="o">|</span> <span class="mi">5</span><span class="p">)</span>
<span class="go">IntRangeSet(&#39;0:10&#39;)</span>
</pre></div>
</div>
<p>The ‘union’ method also support unioning multiple ranges inputs,</p>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;0:5,6:10&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="s1">&#39;100:200&#39;</span><span class="p">))</span>
<span class="go">IntRangeSet(&#39;0:10,100:200&#39;)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="pysnptools.util.IntRangeSet.__repr__">
<code class="sig-name descname">__repr__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.IntRangeSet.__repr__" title="Permalink to this definition">¶</a></dt>
<dd><p>Use the standard repr(a) function to create a string representation of a, an IntRangeSet.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Hello &quot;</span> <span class="o">+</span> <span class="nb">repr</span><span class="p">(</span><span class="n">IntRangeSet</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">10</span><span class="p">)))</span>
<span class="go">Hello IntRangeSet(&#39;2:5,10&#39;)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="pysnptools.util.IntRangeSet.__reversed__">
<code class="sig-name descname">__reversed__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.IntRangeSet.__reversed__" title="Permalink to this definition">¶</a></dt>
<dd><p>reversed(a) is a generator that produces the integer elements of a in order from largest to smallest.</p>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;1:4,10&#39;</span><span class="p">)):</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="go">10</span>
<span class="go">3</span>
<span class="go">2</span>
<span class="go">1</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="pysnptools.util.IntRangeSet.__str__">
<code class="sig-name descname">__str__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.IntRangeSet.__str__" title="Permalink to this definition">¶</a></dt>
<dd><p>Use the standard str(a) function to create a string representation of a, an IntRangeSet.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Hello &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">IntRangeSet</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">10</span><span class="p">)))</span>
<span class="go">Hello IntRangeSet(&#39;2:5,10&#39;)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="pysnptools.util.IntRangeSet.__sub__">
<code class="sig-name descname">__sub__</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">ranges_inputs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.IntRangeSet.__sub__" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the set difference of a IntRangeSet with zero or more ranges inputs. The original IntRangeSet is not changed.</p>
<p>These are the same:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">-</span> <span class="pre">b</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">a.difference(b)</span></code></p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;0:5,6:11&#39;</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">IntRangeSet(&#39;0,2:5,6:11&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;0:5,6:11&#39;</span><span class="p">)</span> <span class="o">-</span> <span class="s1">&#39;3:100&#39;</span><span class="p">)</span>
<span class="go">IntRangeSet(&#39;0:3&#39;)</span>
</pre></div>
</div>
<p>The ‘difference’ method also supports subtracting multiple input ranges</p>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;0:5,6:11&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">difference</span><span class="p">(</span><span class="s1">&#39;3:100&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="go">IntRangeSet(&#39;0,2&#39;)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="pysnptools.util.IntRangeSet.__xor__">
<code class="sig-name descname">__xor__</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ranges</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.IntRangeSet.__xor__" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a new IntRangeSet set with elements in either the input IntRangeSet or the input range but not both.</p>
<p>These are the same:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">^</span> <span class="pre">b</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">a.symmetric_difference(b)</span></code></p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;0:5,6:11&#39;</span><span class="p">)</span> <span class="o">^</span> <span class="s1">&#39;3:9&#39;</span><span class="p">)</span>
<span class="go">IntRangeSet(&#39;0:3,5,9:11&#39;)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="pysnptools.util.IntRangeSet.add">
<code class="sig-name descname">add</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">ranges_inputs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.IntRangeSet.add" title="Permalink to this definition">¶</a></dt>
<dd><p>Union zero or more ranges inputs into the current IntRangeSet.</p>
<p>These are the same:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">|=</span> <span class="pre">b</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">+=</span> <span class="pre">b</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">a.add(b)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">a.update(b)</span></code></p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;0:5,6:10&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">|=</span> <span class="mi">5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="go">IntRangeSet(&#39;0:10&#39;)</span>
</pre></div>
</div>
<p>The ‘add’ and ‘update’ methods also support unioning multiple ranges inputs,</p>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;0:5,6:10&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;5&#39;</span><span class="p">,</span><span class="s1">&#39;100:200&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="go">IntRangeSet(&#39;0:10,100:200&#39;)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="pysnptools.util.IntRangeSet.clear">
<code class="sig-name descname">clear</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.IntRangeSet.clear" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove all ranges from this IntRangeSet.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;0:10,12&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="go">IntRangeSet(&#39;&#39;)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="pysnptools.util.IntRangeSet.copy">
<code class="sig-name descname">copy</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.IntRangeSet.copy" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a deep copy of a IntRangeSet.</p>
</dd></dl>

<dl class="py method">
<dt id="pysnptools.util.IntRangeSet.count">
<code class="sig-name descname">count</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ranges</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.IntRangeSet.count" title="Permalink to this definition">¶</a></dt>
<dd><p>The number of times that the elements of ranges appears in the IntRangeSet. Because IntRangeSet is 
a set, the number will be either 0 or 1.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;100:110,1000&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s1">&#39;105:107,1000&#39;</span><span class="p">))</span>
<span class="go">1</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="pysnptools.util.IntRangeSet.difference">
<code class="sig-name descname">difference</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">ranges_inputs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.IntRangeSet.difference" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the set difference of a IntRangeSet with zero or more ranges inputs. The original IntRangeSet is not changed.</p>
<p>These are the same:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">-</span> <span class="pre">b</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">a.difference(b)</span></code></p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;0:5,6:11&#39;</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">IntRangeSet(&#39;0,2:5,6:11&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;0:5,6:11&#39;</span><span class="p">)</span> <span class="o">-</span> <span class="s1">&#39;3:100&#39;</span><span class="p">)</span>
<span class="go">IntRangeSet(&#39;0:3&#39;)</span>
</pre></div>
</div>
<p>The ‘difference’ method also supports subtracting multiple input ranges</p>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;0:5,6:11&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">difference</span><span class="p">(</span><span class="s1">&#39;3:100&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="go">IntRangeSet(&#39;0,2&#39;)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="pysnptools.util.IntRangeSet.difference_update">
<code class="sig-name descname">difference_update</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">ranges_inputs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.IntRangeSet.difference_update" title="Permalink to this definition">¶</a></dt>
<dd><p>See <a class="reference internal" href="#pysnptools.util.IntRangeSet.__isub__" title="pysnptools.util.IntRangeSet.__isub__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">IntRangeSet.__isub__()</span></code></a></p>
</dd></dl>

<dl class="py method">
<dt id="pysnptools.util.IntRangeSet.discard">
<code class="sig-name descname">discard</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">ranges_inputs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.IntRangeSet.discard" title="Permalink to this definition">¶</a></dt>
<dd><p>See <a class="reference internal" href="#pysnptools.util.IntRangeSet.__isub__" title="pysnptools.util.IntRangeSet.__isub__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">IntRangeSet.__isub__()</span></code></a></p>
</dd></dl>

<dl class="py method">
<dt id="pysnptools.util.IntRangeSet.index">
<code class="sig-name descname">index</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">other</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.IntRangeSet.index" title="Permalink to this definition">¶</a></dt>
<dd><p>If x is an integer, returns the index of x in a, where a is an IntRangeSet.
If x is an ranges input, returns an IntRangeSet of index of every integer in x.
Raises an IndexError is x not in a.</p>
<p><code class="docutils literal notranslate"><span class="pre">*</span> <span class="pre">a.index(x)</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;100:110,1000&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="mi">109</span><span class="p">))</span>
<span class="go">9</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;100:110,1000&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;109,100:104&#39;</span><span class="p">))</span>
<span class="go">IntRangeSet(&#39;0:4,9&#39;)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="pysnptools.util.IntRangeSet.intersection">
<code class="sig-name descname">intersection</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.IntRangeSet.intersection" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the intersection of a IntRangeSet and zero or more ranges inputs. The original IntRangeSet is not changed.</p>
<p>These are the same:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">&amp;</span> <span class="pre">b</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">a.intersection(b)</span></code></p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;0:5,6:11&#39;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="s1">&#39;3:8&#39;</span><span class="p">)</span>
<span class="go">IntRangeSet(&#39;3:5,6:8&#39;)</span>
</pre></div>
</div>
<p>The ‘intersection’ method also support intersecting multiple ranges inputs,</p>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;0:5,6:11&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="s1">&#39;3:8&#39;</span><span class="p">,</span><span class="s1">&#39;4:7&#39;</span><span class="p">))</span>
<span class="go">IntRangeSet(&#39;4,6&#39;)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="pysnptools.util.IntRangeSet.intersection_update">
<code class="sig-name descname">intersection_update</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.IntRangeSet.intersection_update" title="Permalink to this definition">¶</a></dt>
<dd><p>See <a class="reference internal" href="#pysnptools.util.IntRangeSet.__iand__" title="pysnptools.util.IntRangeSet.__iand__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">IntRangeSet.__iand__()</span></code></a></p>
</dd></dl>

<dl class="py method">
<dt id="pysnptools.util.IntRangeSet.isdisjoint">
<code class="sig-name descname">isdisjoint</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ranges</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.IntRangeSet.isdisjoint" title="Permalink to this definition">¶</a></dt>
<dd><p>True exactly when the two sets have no integer elements in common.</p>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;100:110,1000&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">isdisjoint</span><span class="p">(</span><span class="s1">&#39;900:2000&#39;</span><span class="p">))</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;100:110,1000&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">isdisjoint</span><span class="p">(</span><span class="s1">&#39;1900:2000&#39;</span><span class="p">))</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="pysnptools.util.IntRangeSet.isempty">
<em class="property">property </em><code class="sig-name descname">isempty</code><a class="headerlink" href="#pysnptools.util.IntRangeSet.isempty" title="Permalink to this definition">¶</a></dt>
<dd><p>True exactly when the IntRangeSet is empty.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">IntRangeSet</span><span class="p">()</span><span class="o">.</span><span class="n">isempty</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">IntRangeSet</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">isempty</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="pysnptools.util.IntRangeSet.issubset">
<code class="sig-name descname">issubset</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ranges</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.IntRangeSet.issubset" title="Permalink to this definition">¶</a></dt>
<dd><p>True exactly when the IntRangeSet is a subset of the ranges.</p>
<p>These are the same:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">&lt;=</span> <span class="pre">b</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">a.issubset(b)</span></code></p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;0:5,6:11&#39;</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="s1">&#39;-1:101&#39;</span><span class="p">)</span> <span class="c1"># The right-hand can be any ranges input</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Note: By definition, any set is a subset of itself.</p>
</dd></dl>

<dl class="py method">
<dt id="pysnptools.util.IntRangeSet.issuperset">
<code class="sig-name descname">issuperset</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">ranges_inputs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.IntRangeSet.issuperset" title="Permalink to this definition">¶</a></dt>
<dd><p>True exactly when all the ranges input is a subset of the IntRangeSet.</p>
<p>These are the same:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">b</span> <span class="pre">in</span> <span class="pre">a</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">a.issuperset(b)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">&gt;=</span> <span class="pre">b</span></code></p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="mi">3</span> <span class="ow">in</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;0:5,6:11&#39;</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;4:7&#39;</span><span class="p">)</span> <span class="ow">in</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;0:5,6:11&#39;</span><span class="p">))</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="s1">&#39;6:9&#39;</span> <span class="ow">in</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;0:5,6:11&#39;</span><span class="p">)</span> <span class="c1"># The left-hand of &#39;in&#39; can be any ranges input</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;0:5,6:11&#39;</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="s1">&#39;6:9&#39;</span><span class="p">)</span> <span class="c1"># The right-hand of can be any ranges input</span>
<span class="go">True</span>
</pre></div>
</div>
<p>The ‘issuperset’ method also supports unioning multiple ranges inputs.</p>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;0:5,6:11&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">issuperset</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;0:5,6:11&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">issuperset</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">100</span><span class="p">))</span>
<span class="go">False</span>
</pre></div>
</div>
<p>Note: By definition, any set is a superset of itself.</p>
</dd></dl>

<dl class="py method">
<dt id="pysnptools.util.IntRangeSet.max">
<code class="sig-name descname">max</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.IntRangeSet.max" title="Permalink to this definition">¶</a></dt>
<dd><p>The largest integer element in the IntRangeSet</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;0:10,12&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
<span class="go">12</span>
</pre></div>
</div>
<p>Note: This is more efficient than max(IntRangeSet(‘0:10,12’)) because is computed
in constant time rather than in time linear to the number of integer elements.</p>
</dd></dl>

<dl class="py method">
<dt id="pysnptools.util.IntRangeSet.min">
<code class="sig-name descname">min</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.IntRangeSet.min" title="Permalink to this definition">¶</a></dt>
<dd><p>The smallest integer element in the IntRangeSet</p>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;0:10,12&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">min</span><span class="p">())</span>
<span class="go">0</span>
</pre></div>
</div>
<p>Note: This is more efficient than <code class="docutils literal notranslate"><span class="pre">min(IntRangeSet('0:10,12'))</span></code> because is computed
in constant time rather than in time linear to the number of integer elements.</p>
</dd></dl>

<dl class="py method">
<dt id="pysnptools.util.IntRangeSet.pop">
<code class="sig-name descname">pop</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.IntRangeSet.pop" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove and return the largest integer element from the IntRangeSet. Raises KeyError if the IntRangeSet is empty.</p>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;0:5,6:11&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">pop</span><span class="p">())</span>
<span class="go">10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="go">IntRangeSet(&#39;0:5,6:10&#39;)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="pysnptools.util.IntRangeSet.ranges">
<code class="sig-name descname">ranges</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.IntRangeSet.ranges" title="Permalink to this definition">¶</a></dt>
<dd><p>Iterate, in order, the ranges of a IntRangeSet as (start,stop) tuples.</p>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">start</span><span class="p">,</span><span class="n">stop</span> <span class="ow">in</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;0:10,100:200&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">ranges</span><span class="p">():</span>
<span class="gp">... </span>      <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;start is </span><span class="si">{0}</span><span class="s2">, stop is </span><span class="si">{1}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">start</span><span class="p">,</span><span class="n">stop</span><span class="p">))</span>
<span class="go">start is 0, stop is 10</span>
<span class="go">start is 100, stop is 200</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="pysnptools.util.IntRangeSet.ranges_getitem">
<code class="sig-name descname">ranges_getitem</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">index</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.IntRangeSet.ranges_getitem" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the index-th range in the collection of ranges</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;-30:-20,0:10,12&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">ranges_getitem</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="go">(0, 10)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="pysnptools.util.IntRangeSet.ranges_index">
<code class="sig-name descname">ranges_index</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">element</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.IntRangeSet.ranges_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the ranges index of range containing the element</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">int_range_set</span> <span class="o">=</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;-30:-20,0:10,12&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">index</span> <span class="o">=</span> <span class="n">int_range_set</span><span class="o">.</span><span class="n">ranges_index</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">int_range_set</span><span class="o">.</span><span class="n">ranges_getitem</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
<span class="go">(0, 10)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="pysnptools.util.IntRangeSet.ranges_len">
<em class="property">property </em><code class="sig-name descname">ranges_len</code><a class="headerlink" href="#pysnptools.util.IntRangeSet.ranges_len" title="Permalink to this definition">¶</a></dt>
<dd><p>The number of contiguous ranges in the IntRangeSet</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;0:10,12&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">ranges_len</span><span class="p">)</span>
<span class="go">2</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="pysnptools.util.IntRangeSet.remove">
<code class="sig-name descname">remove</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">ranges_inputs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.IntRangeSet.remove" title="Permalink to this definition">¶</a></dt>
<dd><p>See <code class="xref py py-meth docutils literal notranslate"><span class="pre">IntRangeSet__isub__()</span></code></p>
</dd></dl>

<dl class="py method">
<dt id="pysnptools.util.IntRangeSet.sum">
<code class="sig-name descname">sum</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.IntRangeSet.sum" title="Permalink to this definition">¶</a></dt>
<dd><p>The sum of the integer elements in the IntRangeSet</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;0:10,12&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
<span class="go">57</span>
</pre></div>
</div>
<p>Note: This is more efficient than <code class="docutils literal notranslate"><span class="pre">sum(IntRangeSet('0:10,12'))</span></code> because is computed
in time linear in the number of ranges, rather than integer elements.</p>
</dd></dl>

<dl class="py method">
<dt id="pysnptools.util.IntRangeSet.symmetric_difference">
<code class="sig-name descname">symmetric_difference</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ranges</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.IntRangeSet.symmetric_difference" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a new IntRangeSet set with elements in either the input IntRangeSet or the input range but not both.</p>
<p>These are the same:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">^</span> <span class="pre">b</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">a.symmetric_difference(b)</span></code></p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;0:5,6:11&#39;</span><span class="p">)</span> <span class="o">^</span> <span class="s1">&#39;3:9&#39;</span><span class="p">)</span>
<span class="go">IntRangeSet(&#39;0:3,5,9:11&#39;)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="pysnptools.util.IntRangeSet.symmetric_difference_update">
<code class="sig-name descname">symmetric_difference_update</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ranges</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.IntRangeSet.symmetric_difference_update" title="Permalink to this definition">¶</a></dt>
<dd><p>See <a class="reference internal" href="#pysnptools.util.IntRangeSet.__ixor__" title="pysnptools.util.IntRangeSet.__ixor__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">IntRangeSet.__ixor__()</span></code></a></p>
</dd></dl>

<dl class="py method">
<dt id="pysnptools.util.IntRangeSet.union">
<code class="sig-name descname">union</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.IntRangeSet.union" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the union of a IntRangeSet with zero or more ranges inputs. The original IntRangeSet is not changed.</p>
<p>These are the same:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">|</span> <span class="pre">b</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">+</span> <span class="pre">b</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">a.union(b)</span></code></p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;0:5,6:10&#39;</span><span class="p">)</span> <span class="o">|</span> <span class="mi">5</span><span class="p">)</span>
<span class="go">IntRangeSet(&#39;0:10&#39;)</span>
</pre></div>
</div>
<p>The ‘union’ method also support unioning multiple ranges inputs,</p>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;0:5,6:10&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="s1">&#39;100:200&#39;</span><span class="p">))</span>
<span class="go">IntRangeSet(&#39;0:10,100:200&#39;)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="pysnptools.util.IntRangeSet.update">
<code class="sig-name descname">update</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">ranges_inputs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.IntRangeSet.update" title="Permalink to this definition">¶</a></dt>
<dd><p>Union zero or more ranges inputs into the current IntRangeSet.</p>
<p>These are the same:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">|=</span> <span class="pre">b</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">+=</span> <span class="pre">b</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">a.add(b)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">a.update(b)</span></code></p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;0:5,6:10&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">|=</span> <span class="mi">5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="go">IntRangeSet(&#39;0:10&#39;)</span>
</pre></div>
</div>
<p>The ‘add’ and ‘update’ methods also support unioning multiple ranges inputs,</p>
<dl class="field-list simple">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">IntRangeSet</span><span class="p">(</span><span class="s1">&#39;0:5,6:10&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;5&#39;</span><span class="p">,</span><span class="s1">&#39;100:200&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="go">IntRangeSet(&#39;0:10,100:200&#39;)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-pysnptools.util.pheno">
<span id="util-pheno"></span><h3><code class="xref py py-mod docutils literal notranslate"><span class="pre">util.pheno</span></code><a class="headerlink" href="#module-pysnptools.util.pheno" title="Permalink to this headline">¶</a></h3>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version Use: </span><a class="reference internal" href="#pysnptools.snpreader.Pheno" title="pysnptools.snpreader.Pheno"><code class="xref py py-class docutils literal notranslate"><span class="pre">Pheno</span></code></a> instead.    </p>
</div>
<dl class="py function">
<dt id="pysnptools.util.pheno.loadOnePhen">
<code class="sig-prename descclassname">pysnptools.util.pheno.</code><code class="sig-name descname">loadOnePhen</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span></em>, <em class="sig-param"><span class="n">i_pheno</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">missing</span><span class="o">=</span><span class="default_value">'-9'</span></em>, <em class="sig-param"><span class="n">vectorize</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.pheno.loadOnePhen" title="Permalink to this definition">¶</a></dt>
<dd><div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version Use: </span><a class="reference internal" href="#pysnptools.snpreader.Pheno" title="pysnptools.snpreader.Pheno"><code class="xref py py-class docutils literal notranslate"><span class="pre">Pheno</span></code></a> instead.    </p>
</div>
<p>Load one column of a phenotype file. Remove any rows with missing data</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>string</em>) – name of the file</p></li>
<li><p><strong>i_pheno</strong> (<em>int</em>) – column to return (default ‘0’, the first column)</p></li>
<li><p><strong>missing</strong> (<em>string</em>) – value to threat as missing</p></li>
<li><p><strong>vectorize</strong> (<em>bool</em>) – if true, return a 1-D vector rather than a 2-D array</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>An output dictionary</p>
</dd>
</dl>
<p>The output dictionary looks like:</p>
<ul class="simple">
<li><p>‘header’ : [1] array phenotype namesv (only if header line is specified in file),</p></li>
<li><p>‘vals’   : [N*1] array of phenotype-data,</p></li>
<li><p>‘iid’    : [N*2] array of family IDs and case IDs</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt id="pysnptools.util.pheno.loadPhen">
<code class="sig-prename descclassname">pysnptools.util.pheno.</code><code class="sig-name descname">loadPhen</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span></em>, <em class="sig-param"><span class="n">missing</span><span class="o">=</span><span class="default_value">'-9'</span></em>, <em class="sig-param"><span class="n">famid</span><span class="o">=</span><span class="default_value">'FID'</span></em>, <em class="sig-param"><span class="n">sampid</span><span class="o">=</span><span class="default_value">'ID'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.pheno.loadPhen" title="Permalink to this definition">¶</a></dt>
<dd><div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version Use: </span><a class="reference internal" href="#pysnptools.snpreader.Pheno" title="pysnptools.snpreader.Pheno"><code class="xref py py-class docutils literal notranslate"><span class="pre">Pheno</span></code></a> instead.    </p>
</div>
<p>Load a phenotype or covariate file. Covariates have the same file format.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>string</em>) – name of the file</p></li>
<li><p><strong>missing</strong> (<em>string</em>) – value to threat as missing</p></li>
<li><p><strong>vectorize</strong> (<em>bool</em>) – if true, return a 1-D vector rather than a 2-D array</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>An output dictionary</p>
</dd>
</dl>
<p>The output dictionary looks like:</p>
<ul class="simple">
<li><p>‘header’ : [1] array phenotype names (only if header line is specified in file),</p></li>
<li><p>‘vals’   : [N*1] array of phenotype-data,</p></li>
<li><p>‘iid’    : [N*2] array of family IDs and case IDs</p></li>
</ul>
</dd></dl>

</div>
</div>
<div class="section" id="module-pysnptools.util.mapreduce1">
<span id="util-mapreduce1-module"></span><h2><code class="xref py py-mod docutils literal notranslate"><span class="pre">util.mapreduce1</span></code> Module<a class="headerlink" href="#module-pysnptools.util.mapreduce1" title="Permalink to this headline">¶</a></h2>
<div class="section" id="util-mapreduce1">
<h3><code class="xref py py-mod docutils literal notranslate"><span class="pre">util.mapreduce1</span></code><a class="headerlink" href="#util-mapreduce1" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt id="pysnptools.util.mapreduce1.map_reduce">
<code class="sig-prename descclassname">pysnptools.util.mapreduce1.</code><code class="sig-name descname">map_reduce</code><span class="sig-paren">(</span><em class="sig-param">input_seq</em>, <em class="sig-param">mapper=&lt;function _identity&gt;</em>, <em class="sig-param">reducer=&lt;class 'list'&gt;</em>, <em class="sig-param">input_files=None</em>, <em class="sig-param">output_files=None</em>, <em class="sig-param">name=None</em>, <em class="sig-param">runner=None</em>, <em class="sig-param">nested=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.mapreduce1.map_reduce" title="Permalink to this definition">¶</a></dt>
<dd><p>Runs a function on sequence of inputs and runs a second function on the results. Can be nested and clusterized.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_seq</strong> (<em>a sequence</em>) – a sequence of inputs. The sequence must support the len function and be indexable. e.g. a list, xrange(100)</p></li>
<li><p><strong>mapper</strong> (<em>a function</em>) – A function to apply to each set of inputs (optional). Defaults to the identity function.</p></li>
<li><p><strong>reducer</strong> (<em>a function that takes a sequence</em>) – A function to turn the results from the mapper to a single value (optional). Defaults to creating a list of the results.</p></li>
<li><p><strong>input_files</strong> (<em>a list</em>) – An optional list that tells what input files are needed. The list can contain the names of files (strings), None (ignored), or
objects such as <a class="reference internal" href="#pysnptools.snpreader.SnpReader" title="pysnptools.snpreader.SnpReader"><code class="xref py py-class docutils literal notranslate"><span class="pre">SnpReader</span></code></a>’s that can self-report their input files.</p></li>
<li><p><strong>output_files</strong> (<em>a list</em>) – An optional list that tells what output files will be produced. The list can contain the names of files (strings), None (ignored), or
objects such as <a class="reference internal" href="#pysnptools.snpreader.SnpReader" title="pysnptools.snpreader.SnpReader"><code class="xref py py-class docutils literal notranslate"><span class="pre">SnpReader</span></code></a>’s that can self-report their output files.</p></li>
<li><p><strong>name</strong> (<em>a string</em>) – A name to be displayed if this work is done on a cluster.</p></li>
<li><p><strong>runner</strong> (<a class="reference internal" href="#pysnptools.util.mapreduce1.runner.Runner" title="pysnptools.util.mapreduce1.runner.Runner"><code class="xref py py-class docutils literal notranslate"><span class="pre">Runner</span></code></a>) – a <a class="reference internal" href="#pysnptools.util.mapreduce1.runner.Runner" title="pysnptools.util.mapreduce1.runner.Runner"><code class="xref py py-class docutils literal notranslate"><span class="pre">Runner</span></code></a>, optional: Tells how to run locally, multi-processor, or on a cluster.
If not given, the function is run locally.</p></li>
<li><p><strong>nested</strong> (<em>a function</em>) – a mapper function that is itself a map_reduce. Some runners can efficiently clusterize such nested mappers.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>The results from the reducer.</p>
</dd>
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<p>Square the numbers 0 to 99 and report their sum, locally:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.util.mapreduce1</span> <span class="k">import</span> <span class="n">map_reduce</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">six.moves</span> <span class="k">import</span> <span class="nb">range</span> <span class="c1">#Python 2 &amp; 3 compatibility</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">map_reduce</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">),</span> 
<span class="gp">... </span>       <span class="n">mapper</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">*</span><span class="n">x</span><span class="p">,</span>
<span class="gp">... </span>       <span class="n">reducer</span><span class="o">=</span><span class="nb">sum</span><span class="p">)</span>
<span class="go">328350</span>
</pre></div>
</div>
<p>Compute it again, this time run on four processors:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.util.mapreduce1.runner</span> <span class="k">import</span> <span class="n">LocalMultiProc</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">six.moves</span> <span class="k">import</span> <span class="nb">range</span> <span class="c1">#Python 2 &amp; 3 compatibility</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">map_reduce</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">),</span>
<span class="gp">... </span>       <span class="n">mapper</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">*</span><span class="n">x</span><span class="p">,</span>
<span class="gp">... </span>       <span class="n">reducer</span><span class="o">=</span><span class="nb">sum</span><span class="p">,</span>
<span class="gp">... </span>       <span class="n">runner</span><span class="o">=</span><span class="n">LocalMultiProc</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<span class="go">328350</span>
</pre></div>
</div>
<p>Compute it using named functions, again using four processors:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">holder1</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">runner</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">mapper1</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="n">x</span><span class="o">*</span><span class="n">x</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">reducer1</span><span class="p">(</span><span class="n">sequence</span><span class="p">):</span>
<span class="gp">... </span>       <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span><span class="n">sequence</span><span class="p">)</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">map_reduce</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">),</span><span class="n">mapper</span><span class="o">=</span><span class="n">mapper1</span><span class="p">,</span><span class="n">reducer</span><span class="o">=</span><span class="n">reducer1</span><span class="p">,</span><span class="n">runner</span><span class="o">=</span><span class="n">runner</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">holder1</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="n">LocalMultiProc</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<span class="go">328350</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="util-mapreduce1-runner-runner">
<h3><code class="xref py py-class docutils literal notranslate"><span class="pre">util.mapreduce1.runner.Runner</span></code><a class="headerlink" href="#util-mapreduce1-runner-runner" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt id="pysnptools.util.mapreduce1.runner.Runner">
<em class="property">class </em><code class="sig-prename descclassname">pysnptools.util.mapreduce1.runner.</code><code class="sig-name descname">Runner</code><a class="headerlink" href="#pysnptools.util.mapreduce1.runner.Runner" title="Permalink to this definition">¶</a></dt>
<dd><p>A Runner is an object that tells a <a class="reference internal" href="#pysnptools.util.mapreduce1.map_reduce" title="pysnptools.util.mapreduce1.map_reduce"><code class="xref py py-func docutils literal notranslate"><span class="pre">map_reduce()</span></code></a> how to run on a local machine or cluster. Examples include
<a class="reference internal" href="#pysnptools.util.mapreduce1.runner.Local" title="pysnptools.util.mapreduce1.runner.Local"><code class="xref py py-class docutils literal notranslate"><span class="pre">Local</span></code></a> and <a class="reference internal" href="#pysnptools.util.mapreduce1.runner.LocalMultiProc" title="pysnptools.util.mapreduce1.runner.LocalMultiProc"><code class="xref py py-class docutils literal notranslate"><span class="pre">LocalMultiProc</span></code></a>.</p>
</dd></dl>

</div>
<div class="section" id="util-mapreduce1-runner-local">
<h3><code class="xref py py-class docutils literal notranslate"><span class="pre">util.mapreduce1.runner.Local</span></code><a class="headerlink" href="#util-mapreduce1-runner-local" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt id="pysnptools.util.mapreduce1.runner.Local">
<em class="property">class </em><code class="sig-prename descclassname">pysnptools.util.mapreduce1.runner.</code><code class="sig-name descname">Local</code><span class="sig-paren">(</span><em class="sig-param">mkl_num_threads=None</em>, <em class="sig-param">logging_handler=&lt;StreamHandler &lt;stdout&gt; (NOTSET)&gt;</em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.mapreduce1.runner.Local" title="Permalink to this definition">¶</a></dt>
<dd><p>A <a class="reference internal" href="#pysnptools.util.mapreduce1.runner.Runner" title="pysnptools.util.mapreduce1.runner.Runner"><code class="xref py py-class docutils literal notranslate"><span class="pre">Runner</span></code></a> that runs a <a class="reference internal" href="#pysnptools.util.mapreduce1.map_reduce" title="pysnptools.util.mapreduce1.map_reduce"><code class="xref py py-func docutils literal notranslate"><span class="pre">map_reduce()</span></code></a> locally. To save memory, it will feed the results of the mapper to the reducer as those results are computed.</p>
<dl>
<dt><strong>Constructor:</strong></dt><dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mkl_num_threads</strong> (<em>number</em>) – (default None) Limit on the number threads used by the NumPy MKL library.</p></li>
</ul>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>logging_handler</strong> (<em>stream</em>) –  (default stdout) Where to output logging messages.</p></li>
</ul>
</dd>
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">six.moves</span> <span class="k">import</span> <span class="nb">range</span> <span class="c1">#Python 2 &amp; 3 compatibility</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.util.mapreduce1</span> <span class="k">import</span> <span class="n">map_reduce</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.util.mapreduce1.runner</span> <span class="k">import</span> <span class="n">Local</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">holder1</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">runner</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">mapper1</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="n">x</span><span class="o">*</span><span class="n">x</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">reducer1</span><span class="p">(</span><span class="n">sequence</span><span class="p">):</span>
<span class="gp">... </span>       <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span><span class="n">sequence</span><span class="p">)</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">map_reduce</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">),</span><span class="n">mapper</span><span class="o">=</span><span class="n">mapper1</span><span class="p">,</span><span class="n">reducer</span><span class="o">=</span><span class="n">reducer1</span><span class="p">,</span><span class="n">runner</span><span class="o">=</span><span class="n">runner</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">holder1</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="n">Local</span><span class="p">())</span>
<span class="go">328350</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="util-mapreduce1-runner-localmultiproc">
<h3><code class="xref py py-class docutils literal notranslate"><span class="pre">util.mapreduce1.runner.LocalMultiProc</span></code><a class="headerlink" href="#util-mapreduce1-runner-localmultiproc" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt id="pysnptools.util.mapreduce1.runner.LocalMultiProc">
<em class="property">class </em><code class="sig-prename descclassname">pysnptools.util.mapreduce1.runner.</code><code class="sig-name descname">LocalMultiProc</code><span class="sig-paren">(</span><em class="sig-param">taskcount</em>, <em class="sig-param">mkl_num_threads=None</em>, <em class="sig-param">just_one_process=False</em>, <em class="sig-param">logging_handler=&lt;StreamHandler &lt;stdout&gt; (NOTSET)&gt;</em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.mapreduce1.runner.LocalMultiProc" title="Permalink to this definition">¶</a></dt>
<dd><p>A <a class="reference internal" href="#pysnptools.util.mapreduce1.runner.Runner" title="pysnptools.util.mapreduce1.runner.Runner"><code class="xref py py-class docutils literal notranslate"><span class="pre">Runner</span></code></a> that runs a <a class="reference internal" href="#pysnptools.util.mapreduce1.map_reduce" title="pysnptools.util.mapreduce1.map_reduce"><code class="xref py py-func docutils literal notranslate"><span class="pre">map_reduce()</span></code></a> as multiple processes on a single machine.</p>
<dl>
<dt><strong>Constructor:</strong></dt><dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>taskcount</strong> (<em>number</em>) – The number of processes to run on.</p></li>
</ul>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>mkl_num_threads</strong> (<em>number</em>) – (default None) Limit on the number threads used by the NumPy MKL library.</p></li>
</ul>
</dd>
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>just_one_process</strong> (<em>bool</em>) – (default False) Divide the work for multiple processes, but runs sequentially on one process. Can be useful for debugging.</p></li>
</ul>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>logging_handler</strong> (<em>stream</em>) –  (default stdout) Where to output logging messages.</p></li>
</ul>
</dd>
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.util.mapreduce1</span> <span class="k">import</span> <span class="n">map_reduce</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.util.mapreduce1.runner</span> <span class="k">import</span> <span class="n">LocalMultiProc</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">six.moves</span> <span class="k">import</span> <span class="nb">range</span> <span class="c1">#Python 2 &amp; 3 compatibility</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">holder1</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">runner</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">mapper1</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="n">x</span><span class="o">*</span><span class="n">x</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">reducer1</span><span class="p">(</span><span class="n">sequence</span><span class="p">):</span>
<span class="gp">... </span>       <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span><span class="n">sequence</span><span class="p">)</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">map_reduce</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">),</span><span class="n">mapper</span><span class="o">=</span><span class="n">mapper1</span><span class="p">,</span><span class="n">reducer</span><span class="o">=</span><span class="n">reducer1</span><span class="p">,</span><span class="n">runner</span><span class="o">=</span><span class="n">runner</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">holder1</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="n">LocalMultiProc</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<span class="go">328350</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="util-mapreduce1-runner-localmultithread">
<h3><code class="xref py py-class docutils literal notranslate"><span class="pre">util.mapreduce1.runner.LocalMultiThread</span></code><a class="headerlink" href="#util-mapreduce1-runner-localmultithread" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt id="pysnptools.util.mapreduce1.runner.LocalMultiThread">
<em class="property">class </em><code class="sig-prename descclassname">pysnptools.util.mapreduce1.runner.</code><code class="sig-name descname">LocalMultiThread</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">taskcount</span></em>, <em class="sig-param"><span class="n">mkl_num_threads</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">just_one_process</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.mapreduce1.runner.LocalMultiThread" title="Permalink to this definition">¶</a></dt>
<dd><p>A <a class="reference internal" href="#pysnptools.util.mapreduce1.runner.Runner" title="pysnptools.util.mapreduce1.runner.Runner"><code class="xref py py-class docutils literal notranslate"><span class="pre">Runner</span></code></a> that runs a <a class="reference internal" href="#pysnptools.util.mapreduce1.map_reduce" title="pysnptools.util.mapreduce1.map_reduce"><code class="xref py py-func docutils literal notranslate"><span class="pre">map_reduce()</span></code></a> as multiple threads on a single machine.</p>
<p>Note that Python has problems running some programs efficiently on multiple threads. (Search ‘python global interpreter lock’ for details.)
If this <a class="reference internal" href="#pysnptools.util.mapreduce1.runner.Runner" title="pysnptools.util.mapreduce1.runner.Runner"><code class="xref py py-class docutils literal notranslate"><span class="pre">Runner</span></code></a> doesn’t work, consider <a class="reference internal" href="#pysnptools.util.mapreduce1.runner.LocalMultiProc" title="pysnptools.util.mapreduce1.runner.LocalMultiProc"><code class="xref py py-class docutils literal notranslate"><span class="pre">LocalMultiProc</span></code></a> instead.</p>
<dl>
<dt><strong>Constructor:</strong></dt><dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>taskcount</strong> (<em>number</em>) – The number of threads to run on.</p></li>
</ul>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>mkl_num_threads</strong> (<em>number</em>) – (default None) Limit on the number threads used by the NumPy MKL library.</p></li>
</ul>
</dd>
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>just_one_process</strong> (<em>bool</em>) – (default False) Divide the work for multiple threads, but sequentially on one thread. Can be useful for debugging.</p></li>
</ul>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.util.mapreduce1</span> <span class="k">import</span> <span class="n">map_reduce</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.util.mapreduce1.runner</span> <span class="k">import</span> <span class="n">LocalMultiThread</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">six.moves</span> <span class="k">import</span> <span class="nb">range</span> <span class="c1">#Python 2 &amp; 3 compatibility</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">holder1</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">runner</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">mapper1</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="n">x</span><span class="o">*</span><span class="n">x</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">reducer1</span><span class="p">(</span><span class="n">sequence</span><span class="p">):</span>
<span class="gp">... </span>       <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span><span class="n">sequence</span><span class="p">)</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">map_reduce</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">),</span><span class="n">mapper</span><span class="o">=</span><span class="n">mapper1</span><span class="p">,</span><span class="n">reducer</span><span class="o">=</span><span class="n">reducer1</span><span class="p">,</span><span class="n">runner</span><span class="o">=</span><span class="n">runner</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">holder1</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="n">LocalMultiThread</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<span class="go">328350</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="util-mapreduce1-runner-localinparts">
<h3><code class="xref py py-class docutils literal notranslate"><span class="pre">util.mapreduce1.runner.LocalInParts</span></code><a class="headerlink" href="#util-mapreduce1-runner-localinparts" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt id="pysnptools.util.mapreduce1.runner.LocalInParts">
<em class="property">class </em><code class="sig-prename descclassname">pysnptools.util.mapreduce1.runner.</code><code class="sig-name descname">LocalInParts</code><span class="sig-paren">(</span><em class="sig-param">taskindex</em>, <em class="sig-param">taskcount</em>, <em class="sig-param">mkl_num_threads=None</em>, <em class="sig-param">result_file=None</em>, <em class="sig-param">run_dir='.'</em>, <em class="sig-param">temp_dir=None</em>, <em class="sig-param">logging_handler=&lt;StreamHandler &lt;stdout&gt; (NOTSET)&gt;</em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.mapreduce1.runner.LocalInParts" title="Permalink to this definition">¶</a></dt>
<dd><p>A <a class="reference internal" href="#pysnptools.util.mapreduce1.runner.Runner" title="pysnptools.util.mapreduce1.runner.Runner"><code class="xref py py-class docutils literal notranslate"><span class="pre">Runner</span></code></a> that runs one piece of a <a class="reference internal" href="#pysnptools.util.mapreduce1.map_reduce" title="pysnptools.util.mapreduce1.map_reduce"><code class="xref py py-func docutils literal notranslate"><span class="pre">map_reduce()</span></code></a> job locally. Partial results are saved to disk.
Clustering runners and <a class="reference internal" href="#pysnptools.util.mapreduce1.runner.LocalMultiProc" title="pysnptools.util.mapreduce1.runner.LocalMultiProc"><code class="xref py py-class docutils literal notranslate"><span class="pre">LocalMultiProc</span></code></a> use this runner internally.</p>
<dl>
<dt><strong>Constructor:</strong></dt><dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>taskindex</strong> (<em>number</em>) – Which piece of work to run. When 0 to <strong>taskcount</strong>-1, does map work. When <strong>taskcount</strong>, does the reduce work.</p></li>
<li><p><strong>taskcount</strong> (<em>number</em>) – The number of pieces into which to divide the work.</p></li>
<li><p><strong>mkl_num_threads</strong> (<em>number</em>) – (default None) Limit on the number threads used by the NumPy MKL library.</p></li>
<li><p><strong>result_file</strong> (<em>string</em>) – (default None) Where to pickle the final results. If no file is given, the final results are returned, but not saved to a file.</p></li>
<li><p><strong>result_dir</strong> (<em>string</em>) – (default None) The directory for any result_file. Defaults to the current working directory.</p></li>
<li><p><strong>temp_dir</strong> (<em>string</em>) – (default None) The directory for partial results. Defaults to the <strong>result_dir</strong>/.working_directory.{map_reduce’s Name}.</p></li>
<li><p><strong>logging_handler</strong> (<em>stream</em>) –  (default stdout) Where to output logging messages.</p></li>
</ul>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.util.mapreduce1</span> <span class="k">import</span> <span class="n">map_reduce</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.util.mapreduce1.runner</span> <span class="k">import</span> <span class="n">LocalInParts</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">six.moves</span> <span class="k">import</span> <span class="nb">range</span> <span class="c1">#Python 2 &amp; 3 compatibility</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">holder1</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">runner</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">mapper1</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="n">x</span><span class="o">*</span><span class="n">x</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">reducer1</span><span class="p">(</span><span class="n">sequence</span><span class="p">):</span>
<span class="gp">... </span>       <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span><span class="n">sequence</span><span class="p">)</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">map_reduce</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">),</span><span class="n">mapper</span><span class="o">=</span><span class="n">mapper1</span><span class="p">,</span><span class="n">reducer</span><span class="o">=</span><span class="n">reducer1</span><span class="p">,</span><span class="n">runner</span><span class="o">=</span><span class="n">runner</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">holder1</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="n">LocalInParts</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span> <span class="c1">#Run part 0 of 4 and save partial results to disk as &#39;0.4.p&#39;.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">holder1</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="n">LocalInParts</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span> <span class="c1">#Run part 1 of 4 and save partial results to disk as &#39;1.4.p&#39;.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">holder1</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="n">LocalInParts</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span> <span class="c1">#Run part 2 of 4 and save partial results to disk as &#39;2.4.p&#39;.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">holder1</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="n">LocalInParts</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span> <span class="c1">#Run part 3 of 4 and save partial results to disk as &#39;3.4.p&#39;.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">holder1</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="n">LocalInParts</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span> <span class="c1">#Read the all partial results and then apply the reduce function and return the result.</span>
<span class="go">328350</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

</div>
</div>
<div class="section" id="module-pysnptools.util.filecache">
<span id="util-filecache-module"></span><h2><code class="xref py py-mod docutils literal notranslate"><span class="pre">util.filecache</span></code> Module<a class="headerlink" href="#module-pysnptools.util.filecache" title="Permalink to this headline">¶</a></h2>
<p>Tools for reading and writing files, locally or across clusters.</p>
<dl class="py function">
<dt id="pysnptools.util.filecache.ip_address">
<code class="sig-prename descclassname">pysnptools.util.filecache.</code><code class="sig-name descname">ip_address</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.filecache.ip_address" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the ip address of this computer.</p>
</dd></dl>

<dl class="py function">
<dt id="pysnptools.util.filecache.ip_address_pid">
<code class="sig-prename descclassname">pysnptools.util.filecache.</code><code class="sig-name descname">ip_address_pid</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.filecache.ip_address_pid" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the ip address of this computer and process id of the executing process.</p>
</dd></dl>

<div class="section" id="util-filecache-filecache">
<h3><code class="xref py py-class docutils literal notranslate"><span class="pre">util.filecache.FileCache</span></code><a class="headerlink" href="#util-filecache-filecache" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt id="pysnptools.util.filecache.FileCache">
<em class="property">class </em><code class="sig-prename descclassname">pysnptools.util.filecache.</code><code class="sig-name descname">FileCache</code><a class="headerlink" href="#pysnptools.util.filecache.FileCache" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>A FileCache is class such as <a class="reference internal" href="#pysnptools.util.filecache.LocalCache" title="pysnptools.util.filecache.LocalCache"><code class="xref py py-class docutils literal notranslate"><span class="pre">LocalCache</span></code></a> or <a class="reference internal" href="#pysnptools.util.filecache.PeerToPeer" title="pysnptools.util.filecache.PeerToPeer"><code class="xref py py-class docutils literal notranslate"><span class="pre">PeerToPeer</span></code></a> such that</dt><dd><ul class="simple">
<li><p>for reading, copies a (possibly remote) file to a local disk. (If the local file already exists 
and is up-to-date, retrieval is typically skipped.)</p></li>
<li><p>for writing, copies a newly-written local file to (possibly remote) storage.</p></li>
<li><p>provides an assortment of file- and directory-related commands.</p></li>
</ul>
</dd>
</dl>
<dl class="field-list">
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p>Suppose all machines in a cluster can read &amp; write the storage at ‘peertopeer1/common’.
Also, suppose that ‘peertopeer1/192.168.1.105’ is stored locally
on machine 192.168.1.105 but readable other machines in the cluster 
(and so on for all the machines and their IP addresses).</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.util.filecache</span> <span class="k">import</span> <span class="n">PeerToPeer</span><span class="p">,</span> <span class="n">ip_address</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">id_and_path_function</span><span class="p">():</span>
<span class="gp">... </span>    <span class="n">ip</span> <span class="o">=</span> <span class="n">ip_address</span><span class="p">()</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">ip</span><span class="p">,</span> <span class="s1">&#39;peertopeer1/</span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ip</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">file_cache</span> <span class="o">=</span> <span class="n">PeerToPeer</span><span class="p">(</span><span class="n">common_directory</span><span class="o">=</span><span class="s1">&#39;peertopeer1/common&#39;</span><span class="p">,</span><span class="n">id_and_path_function</span><span class="o">=</span><span class="n">id_and_path_function</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">file_cache</span>
<span class="go">PeerToPeer(&#39;peertopeer1/common&#39;,id_and_path_function=...&#39;)</span>
</pre></div>
</div>
<p>Remove anything already in remote storage</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">file_cache</span><span class="o">.</span><span class="n">rmtree</span><span class="p">()</span>
</pre></div>
</div>
<p>Create a random SNP file and store it remotely.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.snpreader</span> <span class="k">import</span> <span class="n">SnpGen</span><span class="p">,</span> <span class="n">Dense</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">snp_gen</span> <span class="o">=</span> <span class="n">SnpGen</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="mi">123</span><span class="p">,</span><span class="n">iid_count</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span><span class="n">sid_count</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">file_cache</span><span class="o">.</span><span class="n">open_write</span><span class="p">(</span><span class="s1">&#39;r123.100x500.dense.txt&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">local_filename</span><span class="p">:</span>
<span class="gp">... </span>   <span class="n">dense1</span> <span class="o">=</span> <span class="n">Dense</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">local_filename</span><span class="p">,</span><span class="n">snp_gen</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">file_cache</span><span class="o">.</span><span class="n">walk</span><span class="p">())</span>
<span class="go">[&#39;r123.100x500.dense.txt&#39;]</span>
</pre></div>
</div>
<p>Copy back from remote storage (if needed) and then read SNP data from local file.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">print_function</span> <span class="c1">#Python 2 &amp; 3 compatibility</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">file_cache</span><span class="o">.</span><span class="n">open_read</span><span class="p">(</span><span class="s1">&#39;r123.100x500.dense.txt&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">local_filename</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">dense2</span> <span class="o">=</span> <span class="n">Dense</span><span class="p">(</span><span class="n">local_filename</span><span class="p">)</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">dense2</span><span class="p">[:</span><span class="mi">3</span><span class="p">,:</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">val</span><span class="p">)</span> <span class="c1">#Read 1st 3 individuals and SNPs</span>
<span class="go">[[ 0. nan nan]</span>
<span class="go"> [ 0.  0. nan]</span>
<span class="go"> [ 0.  0.  0.]]</span>
</pre></div>
</div>
</dd>
</dl>
<p>Given an appropriate module, such as <a class="reference internal" href="#pysnptools.util.filecache.LocalCache" title="pysnptools.util.filecache.LocalCache"><code class="xref py py-class docutils literal notranslate"><span class="pre">LocalCache</span></code></a> or <a class="reference internal" href="#pysnptools.util.filecache.PeerToPeer" title="pysnptools.util.filecache.PeerToPeer"><code class="xref py py-class docutils literal notranslate"><span class="pre">PeerToPeer</span></code></a>, the <cite>FileCache</cite> library provides a unified way 
to work with any remote storage scheme. It differs from virtual file systems, such as CIFS VFS, because:</p>
<blockquote>
<div><ul class="simple">
<li><p><cite>FileCache</cite> works with all operating systems and requires no operating system changes.</p></li>
<li><p><cite>FileCache</cite> can take advantage of the highest performance file retrieval methods (e.g. kernel-space file systems, peer-to-peer transfers, tree copies, etc).</p></li>
<li><p><cite>FileCache</cite> can take advantage of the highest performance local read and write storage (e.g. SSDs)</p></li>
<li><p><cite>FileCache</cite> can work on top of CIFS VFS and any other remote storage system with an appropriate module.</p></li>
</ul>
<p>The downside of <cite>FileCache</cite> is that:</p>
<ul class="simple">
<li><p>Writing generally requires two statements (e.g. <a class="reference internal" href="#pysnptools.util.filecache.FileCache.open_write" title="pysnptools.util.filecache.FileCache.open_write"><code class="xref py py-meth docutils literal notranslate"><span class="pre">open_write()</span></code></a>, <a class="reference internal" href="#pysnptools.snpreader.Dense.write" title="pysnptools.snpreader.Dense.write"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Dense.write()</span></code></a>) instead of just one. Likewise,
Reading generally requires two statements (e.g. <a class="reference internal" href="#pysnptools.util.filecache.FileCache.open_read" title="pysnptools.util.filecache.FileCache.open_read"><code class="xref py py-meth docutils literal notranslate"><span class="pre">open_read()</span></code></a>, <a class="reference internal" href="#pysnptools.snpreader.SnpReader.read" title="pysnptools.snpreader.SnpReader.read"><code class="xref py py-meth docutils literal notranslate"><span class="pre">SnpReader.read()</span></code></a>) instead of just one.</p></li>
</ul>
</div></blockquote>
<p>Methods &amp; Properties:</p>
<blockquote>
<div><p>Every <cite>FileCache</cite>, such as <a class="reference internal" href="#pysnptools.util.filecache.LocalCache" title="pysnptools.util.filecache.LocalCache"><code class="xref py py-class docutils literal notranslate"><span class="pre">LocalCache</span></code></a> and <a class="reference internal" href="#pysnptools.util.filecache.PeerToPeer" title="pysnptools.util.filecache.PeerToPeer"><code class="xref py py-class docutils literal notranslate"><span class="pre">PeerToPeer</span></code></a>, has this property:
<a class="reference internal" href="#pysnptools.util.filecache.FileCache.name" title="pysnptools.util.filecache.FileCache.name"><code class="xref py py-attr docutils literal notranslate"><span class="pre">name</span></code></a>, 
and these methods:
<a class="reference internal" href="#pysnptools.util.filecache.FileCache.file_exists" title="pysnptools.util.filecache.FileCache.file_exists"><code class="xref py py-meth docutils literal notranslate"><span class="pre">file_exists()</span></code></a>, <a class="reference internal" href="#pysnptools.util.filecache.FileCache.getmtime" title="pysnptools.util.filecache.FileCache.getmtime"><code class="xref py py-meth docutils literal notranslate"><span class="pre">getmtime()</span></code></a>, <a class="reference internal" href="#pysnptools.util.filecache.FileCache.join" title="pysnptools.util.filecache.FileCache.join"><code class="xref py py-meth docutils literal notranslate"><span class="pre">join()</span></code></a>, <a class="reference internal" href="#pysnptools.util.filecache.FileCache.load" title="pysnptools.util.filecache.FileCache.load"><code class="xref py py-meth docutils literal notranslate"><span class="pre">load()</span></code></a>, <a class="reference internal" href="#pysnptools.util.filecache.FileCache.open_read" title="pysnptools.util.filecache.FileCache.open_read"><code class="xref py py-meth docutils literal notranslate"><span class="pre">open_read()</span></code></a>, <a class="reference internal" href="#pysnptools.util.filecache.FileCache.open_write" title="pysnptools.util.filecache.FileCache.open_write"><code class="xref py py-meth docutils literal notranslate"><span class="pre">open_write()</span></code></a>, <a class="reference internal" href="#pysnptools.util.filecache.FileCache.remove" title="pysnptools.util.filecache.FileCache.remove"><code class="xref py py-meth docutils literal notranslate"><span class="pre">remove()</span></code></a>, <a class="reference internal" href="#pysnptools.util.filecache.FileCache.rmtree" title="pysnptools.util.filecache.FileCache.rmtree"><code class="xref py py-meth docutils literal notranslate"><span class="pre">rmtree()</span></code></a>,
<a class="reference internal" href="#pysnptools.util.filecache.FileCache.save" title="pysnptools.util.filecache.FileCache.save"><code class="xref py py-meth docutils literal notranslate"><span class="pre">save()</span></code></a>, and <a class="reference internal" href="#pysnptools.util.filecache.FileCache.walk" title="pysnptools.util.filecache.FileCache.walk"><code class="xref py py-meth docutils literal notranslate"><span class="pre">walk()</span></code></a>. See below for details.</p>
</div></blockquote>
<p>Details of Methods &amp; Properties:</p>
<dl class="py method">
<dt id="pysnptools.util.filecache.FileCache.file_exists">
<code class="sig-name descname">file_exists</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">file_name</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.filecache.FileCache.file_exists" title="Permalink to this definition">¶</a></dt>
<dd><p>Tells if there a file with this name. (A directory with the name doesn’t count.)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>file_name</strong> (<em>string</em>) – The name of the file to look for</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>bool</p>
</dd>
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.util.filecache</span> <span class="k">import</span> <span class="n">LocalCache</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">file_cache</span> <span class="o">=</span> <span class="n">LocalCache</span><span class="p">(</span><span class="s1">&#39;localcache1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">file_cache</span><span class="o">.</span><span class="n">rmtree</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">file_cache</span><span class="o">.</span><span class="n">file_exists</span><span class="p">(</span><span class="s1">&#39;localcache1/file1.txt&#39;</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">file_cache</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;localcache1/file1.txt&#39;</span><span class="p">,</span><span class="s1">&#39;Hello&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">file_cache</span><span class="o">.</span><span class="n">file_exists</span><span class="p">(</span><span class="s1">&#39;localcache1/file1.txt&#39;</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="pysnptools.util.filecache.FileCache.getmtime">
<code class="sig-name descname">getmtime</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">file_name</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.filecache.FileCache.getmtime" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the time that the file was last modified.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>file_name</strong> (<em>string</em>) – The name of the (possibly remote) file of interest</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>number, the number of seconds since the epoch</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pysnptools.util.filecache.FileCache.join">
<code class="sig-name descname">join</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">path</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.filecache.FileCache.join" title="Permalink to this definition">¶</a></dt>
<dd><p>The <a class="reference internal" href="#pysnptools.util.filecache.FileCache" title="pysnptools.util.filecache.FileCache"><code class="xref py py-class docutils literal notranslate"><span class="pre">FileCache</span></code></a> created by appending a path to the current <a class="reference internal" href="#pysnptools.util.filecache.FileCache" title="pysnptools.util.filecache.FileCache"><code class="xref py py-class docutils literal notranslate"><span class="pre">FileCache</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>path</strong> (<em>string</em>) – path to join to current <a class="reference internal" href="#pysnptools.util.filecache.FileCache" title="pysnptools.util.filecache.FileCache"><code class="xref py py-class docutils literal notranslate"><span class="pre">FileCache</span></code></a></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="#pysnptools.util.filecache.FileCache" title="pysnptools.util.filecache.FileCache"><code class="xref py py-class docutils literal notranslate"><span class="pre">FileCache</span></code></a></p>
</dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.util.filecache</span> <span class="k">import</span> <span class="n">LocalCache</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">file_cache</span> <span class="o">=</span> <span class="n">LocalCache</span><span class="p">(</span><span class="s1">&#39;localcache1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">file_cache</span>
<span class="go">LocalCache(&#39;localcache1&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sub</span> <span class="o">=</span> <span class="n">file_cache</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;sub1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sub</span>
<span class="go">LocalCache(&#39;localcache1/sub1&#39;)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="pysnptools.util.filecache.FileCache.load">
<code class="sig-name descname">load</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">file_name</span></em>, <em class="sig-param"><span class="n">updater</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.filecache.FileCache.load" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the contents of a file in storage as a string.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file_name</strong> (<em>string</em>) – The name of the (possibly remote) file to read</p></li>
<li><p><strong>updater</strong> (<em>function</em><em> or </em><em>lambda</em>) – (Default, None). Optional function to which status messages may be written. For example, 
the function created by <a class="reference internal" href="#pysnptools.util.log_in_place" title="pysnptools.util.log_in_place"><code class="xref py py-func docutils literal notranslate"><span class="pre">log_in_place()</span></code></a>.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>string - what was written in the file.</p>
</dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.util.filecache</span> <span class="k">import</span> <span class="n">LocalCache</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">file_cache</span> <span class="o">=</span> <span class="n">LocalCache</span><span class="p">(</span><span class="s1">&#39;localcache1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">file_cache</span><span class="o">.</span><span class="n">rmtree</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">file_cache</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;file1.txt&#39;</span><span class="p">,</span><span class="s1">&#39;Hello&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">file_cache</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;file1.txt&#39;</span><span class="p">)</span>
<span class="go">&#39;Hello&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="pysnptools.util.filecache.FileCache.name">
<em class="property">property </em><code class="sig-name descname">name</code><a class="headerlink" href="#pysnptools.util.filecache.FileCache.name" title="Permalink to this definition">¶</a></dt>
<dd><p>A path-like name for this <cite>FileCache</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>string</p>
</dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.util.filecache</span> <span class="k">import</span> <span class="n">LocalCache</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">file_cache</span> <span class="o">=</span> <span class="n">LocalCache</span><span class="p">(</span><span class="s1">&#39;localcache1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">file_cache</span><span class="o">.</span><span class="n">name</span>
<span class="go">&#39;localcache1&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="pysnptools.util.filecache.FileCache.open_read">
<code class="sig-name descname">open_read</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">file_name</span></em>, <em class="sig-param"><span class="n">updater</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.filecache.FileCache.open_read" title="Permalink to this definition">¶</a></dt>
<dd><p>Used with a ‘with’ statement to produce a local copy of a (possibly remote) file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file_name</strong> (<em>string</em>) – The name of the (possibly remote) file to read</p></li>
<li><p><strong>updater</strong> (<em>function</em><em> or </em><em>lambda</em>) – (Default, None). Optional function to which status messages may be written. For example, 
the function created by <a class="reference internal" href="#pysnptools.util.log_in_place" title="pysnptools.util.log_in_place"><code class="xref py py-func docutils literal notranslate"><span class="pre">log_in_place()</span></code></a>.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>a local filename to read.</p>
</dd>
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.util.filecache</span> <span class="k">import</span> <span class="n">LocalCache</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">file_cache</span> <span class="o">=</span> <span class="n">LocalCache</span><span class="p">(</span><span class="s1">&#39;localcache1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">file_cache</span><span class="o">.</span><span class="n">rmtree</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">file_cache</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;file1.txt&#39;</span><span class="p">,</span><span class="s1">&#39;Hello&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">file_cache</span><span class="o">.</span><span class="n">open_read</span><span class="p">(</span><span class="s1">&#39;file1.txt&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">local_filename</span><span class="p">:</span>
<span class="gp">... </span>    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">local_filename</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fp</span><span class="p">:</span>
<span class="gp">... </span>        <span class="n">line</span> <span class="o">=</span> <span class="n">fp</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">line</span>
<span class="go">&#39;Hello&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="pysnptools.util.filecache.FileCache.open_write">
<code class="sig-name descname">open_write</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">file_name</span></em>, <em class="sig-param"><span class="n">size</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">updater</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.filecache.FileCache.open_write" title="Permalink to this definition">¶</a></dt>
<dd><p>Used with a ‘with’ statement to produce a local file name that will be copied to remote storage
when the ‘with’ statement is exited.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file_name</strong> (<em>string</em>) – The name of the (possibly remote) file to which to write.</p></li>
<li><p><strong>size</strong> (<em>number</em>) – (default 0) if given, an error will be thrown immediately if local storage doesn’t
have room for that many bytes.</p></li>
<li><p><strong>updater</strong> (<em>function</em><em> or </em><em>lambda</em>) – (Default, None). Optional function to which status messages may be written. For example, 
the function created by <a class="reference internal" href="#pysnptools.util.log_in_place" title="pysnptools.util.log_in_place"><code class="xref py py-func docutils literal notranslate"><span class="pre">log_in_place()</span></code></a>.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>a local filename to read.</p>
</dd>
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.util.filecache</span> <span class="k">import</span> <span class="n">LocalCache</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">file_cache</span> <span class="o">=</span> <span class="n">LocalCache</span><span class="p">(</span><span class="s1">&#39;localcache1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">file_cache</span><span class="o">.</span><span class="n">rmtree</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">file_cache</span><span class="o">.</span><span class="n">open_write</span><span class="p">(</span><span class="s1">&#39;file1.txt&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">local_filename</span><span class="p">:</span>
<span class="gp">... </span>    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">local_filename</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fp</span><span class="p">:</span>
<span class="gp">... </span>        <span class="n">_</span><span class="o">=</span> <span class="n">fp</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;Hello&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">file_cache</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;file1.txt&#39;</span><span class="p">)</span>
<span class="go">&#39;Hello&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="pysnptools.util.filecache.FileCache.remove">
<code class="sig-name descname">remove</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">file_name</span></em>, <em class="sig-param"><span class="n">updater</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.filecache.FileCache.remove" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove a file from storage. It is an error to remove a directory this way.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file_name</strong> (<em>string</em>) – The name of the (possibly remote) file to remove.</p></li>
<li><p><strong>updater</strong> (<em>function</em><em> or </em><em>lambda</em>) – (Default, None). Optional function to which status messages may be written. For example, 
the function created by <a class="reference internal" href="#pysnptools.util.log_in_place" title="pysnptools.util.log_in_place"><code class="xref py py-func docutils literal notranslate"><span class="pre">log_in_place()</span></code></a>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pysnptools.util.filecache.FileCache.rmtree">
<code class="sig-name descname">rmtree</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">path</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">updater</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.filecache.FileCache.rmtree" title="Permalink to this definition">¶</a></dt>
<dd><p>Delete all files in this <a class="reference internal" href="#pysnptools.util.filecache.FileCache" title="pysnptools.util.filecache.FileCache"><code class="xref py py-class docutils literal notranslate"><span class="pre">FileCache</span></code></a>. It is OK if there are no files.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path</strong> (<em>string</em>) – (Default, None, the current <a class="reference internal" href="#pysnptools.util.filecache.FileCache" title="pysnptools.util.filecache.FileCache"><code class="xref py py-class docutils literal notranslate"><span class="pre">FileCache</span></code></a>). Optional a path (subdirectory, not file) to start in.</p></li>
<li><p><strong>updater</strong> (<em>function</em><em> or </em><em>lambda</em>) – (Default, None). Optional function to which status messages may be written. For example, 
the function created by <a class="reference internal" href="#pysnptools.util.log_in_place" title="pysnptools.util.log_in_place"><code class="xref py py-func docutils literal notranslate"><span class="pre">log_in_place()</span></code></a>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pysnptools.util.filecache.FileCache.save">
<code class="sig-name descname">save</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">file_name</span></em>, <em class="sig-param"><span class="n">contents</span></em>, <em class="sig-param"><span class="n">size</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">updater</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.filecache.FileCache.save" title="Permalink to this definition">¶</a></dt>
<dd><p>Write a string to a file in storage.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file_name</strong> (<em>string</em>) – The name of the (possibly remote) file to which to write.</p></li>
<li><p><strong>contents</strong> (<em>string</em>) – What to write to the file.</p></li>
<li><p><strong>size</strong> (<em>number</em>) – (default 0) if given, an error will be thrown immediately if local storage doesn’t
have room for that many bytes.</p></li>
<li><p><strong>updater</strong> (<em>function</em><em> or </em><em>lambda</em>) – (Default, None). Optional function to which status messages may be written. For example, 
the function created by <a class="reference internal" href="#pysnptools.util.log_in_place" title="pysnptools.util.log_in_place"><code class="xref py py-func docutils literal notranslate"><span class="pre">log_in_place()</span></code></a>.</p></li>
</ul>
</dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.util.filecache</span> <span class="k">import</span> <span class="n">LocalCache</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">file_cache</span> <span class="o">=</span> <span class="n">LocalCache</span><span class="p">(</span><span class="s1">&#39;localcache1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">file_cache</span><span class="o">.</span><span class="n">rmtree</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">file_cache</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;file1.txt&#39;</span><span class="p">,</span><span class="s1">&#39;Hello&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">file_cache</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;file1.txt&#39;</span><span class="p">)</span>
<span class="go">&#39;Hello&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="pysnptools.util.filecache.FileCache.walk">
<code class="sig-name descname">walk</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">path</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.filecache.FileCache.walk" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates the relative paths of the files in the <a class="reference internal" href="#pysnptools.util.filecache.FileCache" title="pysnptools.util.filecache.FileCache"><code class="xref py py-class docutils literal notranslate"><span class="pre">FileCache</span></code></a>. It is OK if there are no files.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>path</strong> (<em>string</em>) – (Default, None, the current <a class="reference internal" href="#pysnptools.util.filecache.FileCache" title="pysnptools.util.filecache.FileCache"><code class="xref py py-class docutils literal notranslate"><span class="pre">FileCache</span></code></a>). Optional path (subdirectory, not file) to start in.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>a generator of strings</p>
</dd>
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.util.filecache</span> <span class="k">import</span> <span class="n">LocalCache</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">file_cache</span> <span class="o">=</span> <span class="n">LocalCache</span><span class="p">(</span><span class="s1">&#39;localcache1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">file_cache</span><span class="o">.</span><span class="n">rmtree</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">file_cache</span><span class="o">.</span><span class="n">walk</span><span class="p">())</span>
<span class="go">[]</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">file_cache</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;file1.txt&#39;</span><span class="p">,</span><span class="s1">&#39;Hello&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">file_cache</span><span class="o">.</span><span class="n">walk</span><span class="p">())</span>
<span class="go">[&#39;file1.txt&#39;]</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">file_cache</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="s1">&#39;no_such_sub_path&#39;</span><span class="p">))</span>
<span class="go">[]</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="util-filecache-localcache">
<h3><code class="xref py py-class docutils literal notranslate"><span class="pre">util.filecache.LocalCache</span></code><a class="headerlink" href="#util-filecache-localcache" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt id="pysnptools.util.filecache.LocalCache">
<em class="property">class </em><code class="sig-prename descclassname">pysnptools.util.filecache.</code><code class="sig-name descname">LocalCache</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">directory</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.filecache.LocalCache" title="Permalink to this definition">¶</a></dt>
<dd><p>A <a class="reference internal" href="#pysnptools.util.filecache.FileCache" title="pysnptools.util.filecache.FileCache"><code class="xref py py-class docutils literal notranslate"><span class="pre">FileCache</span></code></a> for working with files locally.</p>
<p>See <a class="reference internal" href="#pysnptools.util.filecache.FileCache" title="pysnptools.util.filecache.FileCache"><code class="xref py py-class docutils literal notranslate"><span class="pre">FileCache</span></code></a> for general examples of using FileCache.</p>
<p>This is the simplest <a class="reference internal" href="#pysnptools.util.filecache.FileCache" title="pysnptools.util.filecache.FileCache"><code class="xref py py-class docutils literal notranslate"><span class="pre">FileCache</span></code></a> in that it stores everything on a local disk rather than storing things remotely.</p>
<dl>
<dt><strong>Constructor:</strong></dt><dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>directory</strong> (<em>string</em>) – The directory under which files should be written and read.</p></li>
</ul>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.util.filecache</span> <span class="k">import</span> <span class="n">LocalCache</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">file_cache</span> <span class="o">=</span> <span class="n">LocalCache</span><span class="p">(</span><span class="s1">&#39;localcache1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">file_cache</span><span class="o">.</span><span class="n">rmtree</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">file_cache</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;sub1/file1.txt&#39;</span><span class="p">,</span><span class="s1">&#39;Hello&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">file_cache</span><span class="o">.</span><span class="n">file_exists</span><span class="p">(</span><span class="s1">&#39;sub1/file1.txt&#39;</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd>
</dl>
<dl class="py method">
<dt id="pysnptools.util.filecache.LocalCache.name">
<em class="property">property </em><code class="sig-name descname">name</code><a class="headerlink" href="#pysnptools.util.filecache.LocalCache.name" title="Permalink to this definition">¶</a></dt>
<dd><p>A path-like name for this <cite>LocalCache</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>string</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="util-filecache-peertopeer">
<h3><code class="xref py py-class docutils literal notranslate"><span class="pre">util.filecache.PeerToPeer</span></code><a class="headerlink" href="#util-filecache-peertopeer" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt id="pysnptools.util.filecache.PeerToPeer">
<em class="property">class </em><code class="sig-prename descclassname">pysnptools.util.filecache.</code><code class="sig-name descname">PeerToPeer</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">common_directory</span></em>, <em class="sig-param"><span class="n">id_and_path_function</span></em>, <em class="sig-param"><span class="n">leave_space</span><span class="o">=</span><span class="default_value">0</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.filecache.PeerToPeer" title="Permalink to this definition">¶</a></dt>
<dd><p>A <a class="reference internal" href="#pysnptools.util.filecache.FileCache" title="pysnptools.util.filecache.FileCache"><code class="xref py py-class docutils literal notranslate"><span class="pre">FileCache</span></code></a> that allows multiple machines (or processes on one machine) to share files in a peer-to-peer fashion.</p>
<p>See <a class="reference internal" href="#pysnptools.util.filecache.FileCache" title="pysnptools.util.filecache.FileCache"><code class="xref py py-class docutils literal notranslate"><span class="pre">FileCache</span></code></a> for general examples of using FileCache.</p>
<p>This is useful for a cluster with multiple machines with persistent storage and a fast network. Every time a machine writes a file,
the file stays on that machine, but information about the file’s name and location is saved to a common directory. When a new
machine needs the file, it looks to the common directory for a location and then copies from that location. That second location
is also saved to the common directory. Later machines that need the file will randomly pick among the available locations. When a file is removed, it
is only removed from the common directory; clean up of local copies happens later when space is needed for other reads.</p>
<dl>
<dt><strong>Constructor:</strong></dt><dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>common_directory</strong> (<a class="reference internal" href="#pysnptools.util.filecache.FileCache" title="pysnptools.util.filecache.FileCache"><code class="xref py py-class docutils literal notranslate"><span class="pre">FileCache</span></code></a> or <em>string</em>) – The path or <a class="reference internal" href="#pysnptools.util.filecache.FileCache" title="pysnptools.util.filecache.FileCache"><code class="xref py py-class docutils literal notranslate"><span class="pre">FileCache</span></code></a> where
each file’s name and locations (but not contents) are stored. This path must be read/writable by every machine in the cluster.</p></li>
<li><p><strong>id_and_path_function</strong> (<em>function</em>) – A function (or lambda) that deterministically returns two values: 1. an id unique to each machine
(or process) and 2. a file path to this machine’s local storage that any machine
in the cluster can read.</p></li>
<li><p><strong>leave_space</strong> (<em>number</em>) – (Default “0”) How much free space must be left on local drive after downloads and writes.</p></li>
</ul>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1">#Suppose that every machine can access a shared &#39;peertopeer1&#39; and that &#39;peertopeer1/IPADDRESS&#39; is local to each machine.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.util.filecache</span> <span class="k">import</span> <span class="n">PeerToPeer</span><span class="p">,</span> <span class="n">ip_address</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">id_and_path_function</span><span class="p">():</span>
<span class="gp">... </span>    <span class="n">ip</span> <span class="o">=</span> <span class="n">ip_address</span><span class="p">()</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">ip</span><span class="p">,</span> <span class="s1">&#39;peertopeer1/</span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ip</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">file_cache</span> <span class="o">=</span> <span class="n">PeerToPeer</span><span class="p">(</span><span class="n">common_directory</span><span class="o">=</span><span class="s1">&#39;peertopeer1/common&#39;</span><span class="p">,</span><span class="n">id_and_path_function</span><span class="o">=</span><span class="n">id_and_path_function</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">file_cache</span><span class="o">.</span><span class="n">rmtree</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">file_cache</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;sub1/file1.txt&#39;</span><span class="p">,</span><span class="s1">&#39;Hello&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">file_cache</span><span class="o">.</span><span class="n">file_exists</span><span class="p">(</span><span class="s1">&#39;sub1/file1.txt&#39;</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd>
</dl>
<dl class="py method">
<dt id="pysnptools.util.filecache.PeerToPeer.name">
<em class="property">property </em><code class="sig-name descname">name</code><a class="headerlink" href="#pysnptools.util.filecache.PeerToPeer.name" title="Permalink to this definition">¶</a></dt>
<dd><p>A path-like name for this <cite>PeerToPeer</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>string</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="util-filecache-hashdown">
<h3><code class="xref py py-class docutils literal notranslate"><span class="pre">util.filecache.Hashdown</span></code><a class="headerlink" href="#util-filecache-hashdown" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt id="pysnptools.util.filecache.Hashdown">
<em class="property">class </em><code class="sig-prename descclassname">pysnptools.util.filecache.</code><code class="sig-name descname">Hashdown</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">url</span></em>, <em class="sig-param"><span class="n">file_to_hash</span><span class="o">=</span><span class="default_value">{}</span></em>, <em class="sig-param"><span class="n">directory</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">allow_unknown_files</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">trust_local_files</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">_relative_directory</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.filecache.Hashdown" title="Permalink to this definition">¶</a></dt>
<dd><p>A <a class="reference internal" href="#pysnptools.util.filecache.FileCache" title="pysnptools.util.filecache.FileCache"><code class="xref py py-class docutils literal notranslate"><span class="pre">FileCache</span></code></a> for downloading files with known MD5 hashes from a URL. Unloading is not supported.</p>
<p>See <a class="reference internal" href="#pysnptools.util.filecache.FileCache" title="pysnptools.util.filecache.FileCache"><code class="xref py py-class docutils literal notranslate"><span class="pre">FileCache</span></code></a> for general examples of using FileCache.</p>
<dl>
<dt><strong>Constructor:</strong></dt><dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>url</strong> (<em>string</em>) – The URL from which to download any needed files.</p></li>
<li><p><strong>file_to_hash</strong> (<em>dictionary</em>) – A dictionary from file names to MD5 hashes.</p></li>
<li><dl class="simple">
<dt><strong>directory</strong> (optional, <em>string</em>) – Local location for files. If not given will be under the system temp directory</dt><dd><p>(typically controlled with the TEMP environment variable).</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><strong>allow_unknown_files</strong> (optional, <em>bool</em>) – By default, all requested files must be in the dictionary. If True,</dt><dd><p>other files can be requested. If found under the URL, they will be downloaded and an entry will be added
to the dictionary.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><strong>trust_local_files</strong> (optional, bool) – By default, when <strong>allow_unknown_files</strong> is True, unknown files</dt><dd><p>will be download. If <strong>trust_local_files</strong> is also True, then any local files in <strong>directory</strong> will
be assumed to have the correct hash.</p>
</dd>
</dl>
</li>
<li><p><strong>_relative_directory</strong> (<em>string</em>) – Used internally</p></li>
</ul>
</dd>
<dt class="field-even">Example</dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.util.filecache</span> <span class="k">import</span> <span class="n">Hashdown</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">file_to_hash</span><span class="o">=</span> <span class="p">{</span><span class="s1">&#39;pysnptools/examples/toydata.5chrom.bed&#39;</span><span class="p">:</span> <span class="s1">&#39;766f55aa716bc7bc97cad4de41a50ec3&#39;</span><span class="p">,</span>
<span class="gp">... </span>               <span class="s1">&#39;pysnptools/examples/toydata.5chrom.bim&#39;</span><span class="p">:</span> <span class="s1">&#39;6a07f96e521f9a86df7bfd7814eebcd6&#39;</span><span class="p">,</span>
<span class="gp">... </span>               <span class="s1">&#39;pysnptools/examples/toydata.5chrom.fam&#39;</span><span class="p">:</span> <span class="s1">&#39;f4eb01f67e0738d4865fad2014af8537&#39;</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hashdown</span> <span class="o">=</span> <span class="n">Hashdown</span><span class="p">(</span><span class="s1">&#39;https://github.com/fastlmm/PySnpTools/raw/cf248cbf762516540470d693532590a77c76fba2&#39;</span><span class="p">,</span>
<span class="gp">... </span>                     <span class="n">file_to_hash</span><span class="o">=</span><span class="n">file_to_hash</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hashdown</span><span class="o">.</span><span class="n">file_exists</span><span class="p">(</span><span class="s1">&#39;pysnptools/examples/toydata.5chrom.bed&#39;</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hashdown</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;pysnptools/examples/toydata.5chrom.fam&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">&#39;per0 per0 0 0 2 0.408848&#39;</span>
</pre></div>
</div>
</dd>
</dl>
<dl class="py method">
<dt id="pysnptools.util.filecache.Hashdown.load_hashdown">
<em class="property">static </em><code class="sig-name descname">load_hashdown</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span></em>, <em class="sig-param"><span class="n">directory</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">allow_unknown_files</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">trust_local_files</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.filecache.Hashdown.load_hashdown" title="Permalink to this definition">¶</a></dt>
<dd><p>Load a Hashdown object from a json file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> – name of file to load from.</p></li>
<li><p><strong>directory</strong> – Local location for files. If not given will be under the system temp directory
(typically controlled with the TEMP environment variable).</p></li>
<li><p><strong>allow_unknown_files</strong> – By default, all requested files must be in the dictionary. If True,
other files can be requested. If found under the URL, they will be downloaded and an entry will be added
to the dictionary.</p></li>
<li><p><strong>trust_local_files</strong> – By default, when <strong>allow_unknown_files</strong> is True, unknown files
will be download. If <strong>trust_local_files</strong> is also True, then any local files in <strong>directory</strong> will
be assumed to have the correct hash.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="#pysnptools.util.filecache.Hashdown" title="pysnptools.util.filecache.Hashdown"><code class="xref py py-class docutils literal notranslate"><span class="pre">Hashdown</span></code></a></p>
</dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.util.filecache</span> <span class="k">import</span> <span class="n">Hashdown</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">file_to_hash</span><span class="o">=</span> <span class="p">{</span><span class="s1">&#39;pysnptools/examples/toydata.5chrom.bed&#39;</span><span class="p">:</span> <span class="s1">&#39;766f55aa716bc7bc97cad4de41a50ec3&#39;</span><span class="p">,</span>
<span class="gp">... </span>               <span class="s1">&#39;pysnptools/examples/toydata.5chrom.bim&#39;</span><span class="p">:</span> <span class="s1">&#39;6a07f96e521f9a86df7bfd7814eebcd6&#39;</span><span class="p">,</span>
<span class="gp">... </span>               <span class="s1">&#39;pysnptools/examples/toydata.5chrom.fam&#39;</span><span class="p">:</span> <span class="s1">&#39;f4eb01f67e0738d4865fad2014af8537&#39;</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hashdown1</span> <span class="o">=</span> <span class="n">Hashdown</span><span class="p">(</span><span class="s1">&#39;https://github.com/fastlmm/PySnpTools/raw/cf248cbf762516540470d693532590a77c76fba2&#39;</span><span class="p">,</span>
<span class="gp">... </span>                     <span class="n">file_to_hash</span><span class="o">=</span><span class="n">file_to_hash</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hashdown1</span><span class="o">.</span><span class="n">save_hashdown</span><span class="p">(</span><span class="s1">&#39;tempdir/demo.hashdown.json&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hashdown2</span> <span class="o">=</span> <span class="n">Hashdown</span><span class="o">.</span><span class="n">load_hashdown</span><span class="p">(</span><span class="s1">&#39;tempdir/demo.hashdown.json&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hashdown2</span><span class="o">.</span><span class="n">file_exists</span><span class="p">(</span><span class="s1">&#39;pysnptools/examples/toydata.5chrom.bed&#39;</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hashdown2</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;pysnptools/examples/toydata.5chrom.fam&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">&#39;per0 per0 0 0 2 0.408848&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="pysnptools.util.filecache.Hashdown.name">
<em class="property">property </em><code class="sig-name descname">name</code><a class="headerlink" href="#pysnptools.util.filecache.Hashdown.name" title="Permalink to this definition">¶</a></dt>
<dd><p>A path-like name for this <cite>Hashdown</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>string</p>
</dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.util.filecache</span> <span class="k">import</span> <span class="n">Hashdown</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">file_to_hash</span><span class="o">=</span> <span class="p">{</span><span class="s1">&#39;pysnptools/examples/toydata.5chrom.bed&#39;</span><span class="p">:</span> <span class="s1">&#39;766f55aa716bc7bc97cad4de41a50ec3&#39;</span><span class="p">,</span>
<span class="gp">... </span>               <span class="s1">&#39;pysnptools/examples/toydata.5chrom.bim&#39;</span><span class="p">:</span> <span class="s1">&#39;6a07f96e521f9a86df7bfd7814eebcd6&#39;</span><span class="p">,</span>
<span class="gp">... </span>               <span class="s1">&#39;pysnptools/examples/toydata.5chrom.fam&#39;</span><span class="p">:</span> <span class="s1">&#39;f4eb01f67e0738d4865fad2014af8537&#39;</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hashdown</span> <span class="o">=</span> <span class="n">Hashdown</span><span class="p">(</span><span class="s1">&#39;https://github.com/fastlmm/PySnpTools/raw/cf248cbf762516540470d693532590a77c76fba2&#39;</span><span class="p">,</span>
<span class="gp">... </span>                     <span class="n">file_to_hash</span><span class="o">=</span><span class="n">file_to_hash</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hashdown</span><span class="o">.</span><span class="n">name</span>
<span class="go">&#39;hashdown/9ac30da2bf589db947e91744dff0ec24&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hashdown</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;pysnptools&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">name</span>
<span class="go">&#39;hashdown/9ac30da2bf589db947e91744dff0ec24/pysnptools&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="pysnptools.util.filecache.Hashdown.save_hashdown">
<code class="sig-name descname">save_hashdown</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.filecache.Hashdown.save_hashdown" title="Permalink to this definition">¶</a></dt>
<dd><p>Save a Hashdown object to a json file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>filename</strong> – name of file to save to.</p>
</dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pysnptools.util.filecache</span> <span class="k">import</span> <span class="n">Hashdown</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">file_to_hash</span><span class="o">=</span> <span class="p">{</span><span class="s1">&#39;pysnptools/examples/toydata.5chrom.bed&#39;</span><span class="p">:</span> <span class="s1">&#39;766f55aa716bc7bc97cad4de41a50ec3&#39;</span><span class="p">,</span>
<span class="gp">... </span>               <span class="s1">&#39;pysnptools/examples/toydata.5chrom.bim&#39;</span><span class="p">:</span> <span class="s1">&#39;6a07f96e521f9a86df7bfd7814eebcd6&#39;</span><span class="p">,</span>
<span class="gp">... </span>               <span class="s1">&#39;pysnptools/examples/toydata.5chrom.fam&#39;</span><span class="p">:</span> <span class="s1">&#39;f4eb01f67e0738d4865fad2014af8537&#39;</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hashdown1</span> <span class="o">=</span> <span class="n">Hashdown</span><span class="p">(</span><span class="s1">&#39;https://github.com/fastlmm/PySnpTools/raw/cf248cbf762516540470d693532590a77c76fba2&#39;</span><span class="p">,</span>
<span class="gp">... </span>                     <span class="n">file_to_hash</span><span class="o">=</span><span class="n">file_to_hash</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hashdown1</span><span class="o">.</span><span class="n">save_hashdown</span><span class="p">(</span><span class="s1">&#39;tempdir/demo.hashdown.json&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hashdown2</span> <span class="o">=</span> <span class="n">Hashdown</span><span class="o">.</span><span class="n">load_hashdown</span><span class="p">(</span><span class="s1">&#39;tempdir/demo.hashdown.json&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hashdown2</span><span class="o">.</span><span class="n">file_exists</span><span class="p">(</span><span class="s1">&#39;pysnptools/examples/toydata.5chrom.bed&#39;</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hashdown2</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;pysnptools/examples/toydata.5chrom.fam&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">&#39;per0 per0 0 0 2 0.408848&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="pysnptools.util.filecache.Hashdown.scan_local">
<em class="property">static </em><code class="sig-name descname">scan_local</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">local_directory</span></em>, <em class="sig-param"><span class="n">url</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">logging_level</span><span class="o">=</span><span class="default_value">30</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pysnptools.util.filecache.Hashdown.scan_local" title="Permalink to this definition">¶</a></dt>
<dd><p>Bootstrap a Hashdown by recursively walking a local directory and finding the local MD5 hashes.
(A local hash might be wrong if the files are out of date or have OS-dependent line endings.)
Typically, you’ll then want to save the result to a JSON file and then edit that JSON file
manually to remove uninteresting files.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>local_directory</strong> – Local directory to recursively walk</p></li>
<li><p><strong>url</strong> – URL to give to the Hashdown. (It will not be checked.)</p></li>
<li><p><strong>logging_level</strong> – Logging level for printing progress of the walk. Default
is logging.WARNING)</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="#pysnptools.util.filecache.Hashdown" title="pysnptools.util.filecache.Hashdown"><code class="xref py py-class docutils literal notranslate"><span class="pre">Hashdown</span></code></a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
</div>
<div class="section" id="indices-and-tables">
<h2>Indices and Tables<a class="headerlink" href="#indices-and-tables" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference internal" href="genindex.html"><span class="std std-ref">Index</span></a></p></li>
<li><p><a class="reference internal" href="py-modindex.html"><span class="std std-ref">Module Index</span></a></p></li>
<li><p><a class="reference internal" href="search.html"><span class="std std-ref">Search Page</span></a></p></li>
</ul>
</div></blockquote>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="#">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pysnptools</span></code> Documentation</a><ul>
<li><a class="reference internal" href="#module-pysnptools.snpreader"><code class="xref py py-mod docutils literal notranslate"><span class="pre">snpreader</span></code> Module</a><ul>
<li><a class="reference internal" href="#snpreader-snpreader"><code class="xref py py-class docutils literal notranslate"><span class="pre">snpreader.SnpReader</span></code></a></li>
<li><a class="reference internal" href="#snpreader-bed"><code class="xref py py-class docutils literal notranslate"><span class="pre">snpreader.Bed</span></code></a></li>
<li><a class="reference internal" href="#snpreader-snpdata"><code class="xref py py-class docutils literal notranslate"><span class="pre">snpreader.SnpData</span></code></a></li>
<li><a class="reference internal" href="#snpreader-pheno"><code class="xref py py-class docutils literal notranslate"><span class="pre">snpreader.Pheno</span></code></a></li>
<li><a class="reference internal" href="#snpreader-ped"><code class="xref py py-class docutils literal notranslate"><span class="pre">snpreader.Ped</span></code></a></li>
<li><a class="reference internal" href="#snpreader-dat"><code class="xref py py-class docutils literal notranslate"><span class="pre">snpreader.Dat</span></code></a></li>
<li><a class="reference internal" href="#snpreader-dense"><code class="xref py py-class docutils literal notranslate"><span class="pre">snpreader.Dense</span></code></a></li>
<li><a class="reference internal" href="#snpreader-snphdf5"><code class="xref py py-class docutils literal notranslate"><span class="pre">snpreader.SnpHdf5</span></code></a></li>
<li><a class="reference internal" href="#snpreader-snpnpz"><code class="xref py py-class docutils literal notranslate"><span class="pre">snpreader.SnpNpz</span></code></a></li>
<li><a class="reference internal" href="#snpreader-snpmemmap"><code class="xref py py-class docutils literal notranslate"><span class="pre">snpreader.SnpMemMap</span></code></a></li>
<li><a class="reference internal" href="#snpreader-snpgen"><code class="xref py py-class docutils literal notranslate"><span class="pre">snpreader.SnpGen</span></code></a></li>
<li><a class="reference internal" href="#snpreader-distributedbed"><code class="xref py py-class docutils literal notranslate"><span class="pre">snpreader.DistributedBed</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-pysnptools.kernelreader"><code class="xref py py-mod docutils literal notranslate"><span class="pre">kernelreader</span></code> Module</a><ul>
<li><a class="reference internal" href="#kernelreader-kernelreader"><code class="xref py py-class docutils literal notranslate"><span class="pre">kernelreader.KernelReader</span></code></a></li>
<li><a class="reference internal" href="#kernelreader-kerneldata"><code class="xref py py-class docutils literal notranslate"><span class="pre">kernelreader.KernelData</span></code></a></li>
<li><a class="reference internal" href="#kernelreader-kernelnpz"><code class="xref py py-class docutils literal notranslate"><span class="pre">kernelreader.KernelNpz</span></code></a></li>
<li><a class="reference internal" href="#kernelreader-kernelhdf5"><code class="xref py py-class docutils literal notranslate"><span class="pre">kernelreader.KernelHdf5</span></code></a></li>
<li><a class="reference internal" href="#kernelreader-identity"><code class="xref py py-class docutils literal notranslate"><span class="pre">kernelreader.Identity</span></code></a></li>
<li><a class="reference internal" href="#kernelreader-snpkernel"><code class="xref py py-class docutils literal notranslate"><span class="pre">kernelreader.SnpKernel</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-pysnptools.standardizer"><code class="xref py py-mod docutils literal notranslate"><span class="pre">standardizer</span></code> Module</a><ul>
<li><a class="reference internal" href="#standardizer-standardizer"><code class="xref py py-class docutils literal notranslate"><span class="pre">standardizer.Standardizer</span></code></a></li>
<li><a class="reference internal" href="#standardizer-unit"><code class="xref py py-class docutils literal notranslate"><span class="pre">standardizer.Unit</span></code></a></li>
<li><a class="reference internal" href="#standardizer-beta"><code class="xref py py-class docutils literal notranslate"><span class="pre">standardizer.Beta</span></code></a></li>
<li><a class="reference internal" href="#standardizer-identity"><code class="xref py py-class docutils literal notranslate"><span class="pre">standardizer.Identity</span></code></a></li>
<li><a class="reference internal" href="#standardizer-diagkton"><code class="xref py py-class docutils literal notranslate"><span class="pre">standardizer.DiagKtoN</span></code></a></li>
<li><a class="reference internal" href="#standardizer-unittrained"><code class="xref py py-class docutils literal notranslate"><span class="pre">standardizer.UnitTrained</span></code></a></li>
<li><a class="reference internal" href="#standardizer-diagktontrained"><code class="xref py py-class docutils literal notranslate"><span class="pre">standardizer.DiagKtoNTrained</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#kernelstandardizer-module"><code class="xref py py-mod docutils literal notranslate"><span class="pre">kernelstandardizer</span></code> Module</a><ul>
<li><a class="reference internal" href="#kernelstandardizer-kernelstandardizer"><code class="xref py py-class docutils literal notranslate"><span class="pre">kernelstandardizer.KernelStandardizer</span></code></a></li>
<li><a class="reference internal" href="#kernelstandardizer-diagkton"><code class="xref py py-class docutils literal notranslate"><span class="pre">kernelstandardizer.DiagKtoN</span></code></a></li>
<li><a class="reference internal" href="#kernelstandardizer-diagktontrained"><code class="xref py py-class docutils literal notranslate"><span class="pre">kernelstandardizer.DiagKtoNTrained</span></code></a></li>
<li><a class="reference internal" href="#kernelstandardizer-identity"><code class="xref py py-class docutils literal notranslate"><span class="pre">kernelstandardizer.Identity</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-pysnptools.pstreader"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pstreader</span></code> Module</a><ul>
<li><a class="reference internal" href="#pstreader-pstreader"><code class="xref py py-class docutils literal notranslate"><span class="pre">pstreader.PstReader</span></code></a></li>
<li><a class="reference internal" href="#pstreader-pstdata"><code class="xref py py-class docutils literal notranslate"><span class="pre">pstreader.PstData</span></code></a></li>
<li><a class="reference internal" href="#pstreader-psthdf5"><code class="xref py py-class docutils literal notranslate"><span class="pre">pstreader.PstHdf5</span></code></a></li>
<li><a class="reference internal" href="#pstreader-pstnpz"><code class="xref py py-class docutils literal notranslate"><span class="pre">pstreader.PstNpz</span></code></a></li>
<li><a class="reference internal" href="#pstreader-pstmemmap"><code class="xref py py-class docutils literal notranslate"><span class="pre">pstreader.PstMemMap</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#util-module"><code class="xref py py-mod docutils literal notranslate"><span class="pre">util</span></code> Module</a><ul>
<li><a class="reference internal" href="#module-pysnptools.util"><code class="xref py py-mod docutils literal notranslate"><span class="pre">util</span></code></a></li>
<li><a class="reference internal" href="#util-intrangeset"><code class="xref py py-class docutils literal notranslate"><span class="pre">util.IntRangeSet</span></code></a></li>
<li><a class="reference internal" href="#module-pysnptools.util.pheno"><code class="xref py py-mod docutils literal notranslate"><span class="pre">util.pheno</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-pysnptools.util.mapreduce1"><code class="xref py py-mod docutils literal notranslate"><span class="pre">util.mapreduce1</span></code> Module</a><ul>
<li><a class="reference internal" href="#util-mapreduce1"><code class="xref py py-mod docutils literal notranslate"><span class="pre">util.mapreduce1</span></code></a></li>
<li><a class="reference internal" href="#util-mapreduce1-runner-runner"><code class="xref py py-class docutils literal notranslate"><span class="pre">util.mapreduce1.runner.Runner</span></code></a></li>
<li><a class="reference internal" href="#util-mapreduce1-runner-local"><code class="xref py py-class docutils literal notranslate"><span class="pre">util.mapreduce1.runner.Local</span></code></a></li>
<li><a class="reference internal" href="#util-mapreduce1-runner-localmultiproc"><code class="xref py py-class docutils literal notranslate"><span class="pre">util.mapreduce1.runner.LocalMultiProc</span></code></a></li>
<li><a class="reference internal" href="#util-mapreduce1-runner-localmultithread"><code class="xref py py-class docutils literal notranslate"><span class="pre">util.mapreduce1.runner.LocalMultiThread</span></code></a></li>
<li><a class="reference internal" href="#util-mapreduce1-runner-localinparts"><code class="xref py py-class docutils literal notranslate"><span class="pre">util.mapreduce1.runner.LocalInParts</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-pysnptools.util.filecache"><code class="xref py py-mod docutils literal notranslate"><span class="pre">util.filecache</span></code> Module</a><ul>
<li><a class="reference internal" href="#util-filecache-filecache"><code class="xref py py-class docutils literal notranslate"><span class="pre">util.filecache.FileCache</span></code></a></li>
<li><a class="reference internal" href="#util-filecache-localcache"><code class="xref py py-class docutils literal notranslate"><span class="pre">util.filecache.LocalCache</span></code></a></li>
<li><a class="reference internal" href="#util-filecache-peertopeer"><code class="xref py py-class docutils literal notranslate"><span class="pre">util.filecache.PeerToPeer</span></code></a></li>
<li><a class="reference internal" href="#util-filecache-hashdown"><code class="xref py py-class docutils literal notranslate"><span class="pre">util.filecache.Hashdown</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#indices-and-tables">Indices and Tables</a></li>
</ul>
</li>
</ul>

  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/index.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="#">pysnptools 0.0.2 documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 20198.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 3.0.3.
    </div>
  </body>
</html>